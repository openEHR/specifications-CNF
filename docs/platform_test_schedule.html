<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="description" content="openEHR Platform Conformance Test Schedule">
<meta name="keywords" content="conformance">
<title>openEHR Platform Conformance Test Schedule</title>
<link rel="stylesheet" href="https://specifications.openehr.org/styles/openehr.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#_openehr_platform_conformance_test_schedule">openEHR Platform Conformance Test Schedule</a>
<ul class="sectlevel1">
<li><a href="#_amendment_record">Amendment Record</a></li>
<li><a href="#_acknowledgements">Acknowledgements</a>
<ul class="sectlevel2">
<li><a href="#_principal_authors">Principal Authors</a></li>
<li><a href="#_trademarks">Trademarks</a></li>
</ul>
</li>
<li><a href="#_preface">1. Preface</a>
<ul class="sectlevel2">
<li><a href="#_purpose">1.1. Purpose</a></li>
<li><a href="#_related_documents">1.2. Related Documents</a></li>
<li><a href="#_status">1.3. Status</a></li>
<li><a href="#_feedback">1.4. Feedback</a></li>
</ul>
</li>
<li><a href="#_glossary_of_terms_and_acronyms">2. Glossary of Terms and Acronyms</a></li>
<li><a href="#_overview">3. Overview</a>
<ul class="sectlevel2">
<li><a href="#_scope">3.1. Scope</a></li>
</ul>
</li>
<li><a href="#_conformance_schedule">4. Conformance Schedule</a>
<ul class="sectlevel2">
<li><a href="#_overview_2">4.1. Overview</a></li>
</ul>
</li>
<li><a href="#_func_conf_def_component">5. Functional Conformance: Definitions Component</a>
<ul class="sectlevel2">
<li><a href="#_normative_reference">5.1. Normative Reference</a></li>
<li><a href="#_test_environment">5.2. Test Environment</a></li>
<li><a href="#_opt_1_42_test_cases">5.3. OPT 1.4/2 Test cases</a>
<ul class="sectlevel3">
<li><a href="#_conformance_point_i_definition_adl14_validate_opt">5.3.1. Conformance Point: I_DEFINITION_ADL14.validate_opt()</a>
<ul class="sectlevel4">
<li><a href="#_test_data_sets">5.3.1.1. Test Data Sets</a></li>
<li><a href="#_tc_i_definition_adl14_validate_opt_valid_opt">5.3.1.2. TC I_DEFINITION_ADL14.validate_opt-valid_opt</a></li>
<li><a href="#_tc_i_definition_adl14_validate_opt_invalid_opt">5.3.1.3. TC I_DEFINITION_ADL14.validate_opt-invalid_opt</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_definition_adl14_upload_opt">5.3.2. Conformance Point: I_DEFINITION_ADL14.upload_opt()</a>
<ul class="sectlevel4">
<li><a href="#_data_set">5.3.2.1. Data set</a></li>
<li><a href="#_tc_i_definition_adl14_upload_opt_valid_opt">5.3.2.2. TC I_DEFINITION_ADL14.upload_opt-valid_opt</a></li>
<li><a href="#_tc_i_definition_adl14_upload_opt_invalid_opt">5.3.2.3. TC I_DEFINITION_ADL14.upload_opt-invalid_opt</a></li>
<li><a href="#_tc_i_definition_adl14_upload_opt_valid_opt_twice_conflict">5.3.2.4. TC I_DEFINITION_ADL14.upload_opt-valid_opt_twice_conflict</a></li>
<li><a href="#_tc_i_definition_adl14_upload_opt_valid_opt_twice_no_conflict">5.3.2.5. TC I_DEFINITION_ADL14.upload_opt-valid_opt_twice_no_conflict</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_definition_adl14_get_opt">5.3.3. Conformance Point: I_DEFINITION_ADL14.get_opt()</a>
<ul class="sectlevel4">
<li><a href="#_data_sets">5.3.3.1. Data sets</a></li>
<li><a href="#_tc_i_definition_adl14_get_opt_get_single">5.3.3.2. TC I_DEFINITION_ADL14.get_opt-get_single</a></li>
<li><a href="#_tc_i_definition_adl14_get_opt_retrieve_fail">5.3.3.3. TC I_DEFINITION_ADL14.get_opt-retrieve_fail</a></li>
<li><a href="#_tc_i_definition_adl14_get_opt_retrieve_latest_version">5.3.3.4. TC I_DEFINITION_ADL14.get_opt-retrieve_latest_version</a></li>
<li><a href="#_tc_i_definition_adl14_get_opt_retrieve_specific_version">5.3.3.5. TC I_DEFINITION_ADL14.get_opt-retrieve_specific_version</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_definition_adl14_get_opts">5.3.4. Conformance Point: I_DEFINITION_ADL14.get_opts()</a>
<ul class="sectlevel4">
<li><a href="#_data_sets_2">5.3.4.1. Data sets</a></li>
<li><a href="#_tc_i_definition_adl14_get_opts_retrieve_all">5.3.4.2. TC I_DEFINITION_ADL14.get_opts-retrieve_all</a></li>
<li><a href="#_tc_i_definition_adl14_get_opts_retrieve_all_no_opts">5.3.4.3. TC I_DEFINITION_ADL14.get_opts-retrieve_all_no_opts</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_definition_adl14_delete_opt">5.3.5. Conformance Point: I_DEFINITION_ADL14.delete_opt()</a>
<ul class="sectlevel4">
<li><a href="#_data_sets_3">5.3.5.1. Data sets</a></li>
<li><a href="#_tc_i_definition_adl14_delete_opt_delete_existing">5.3.5.2. TC I_DEFINITION_ADL14.delete_opt-delete_existing</a></li>
<li><a href="#_tc_i_definition_adl14_delete_opt_delete_latest_version">5.3.5.3. TC I_DEFINITION_ADL14.delete_opt-delete_latest_version</a></li>
<li><a href="#_tc_i_definition_adl14_delete_opt_delete_specific_version">5.3.5.4. TC I_DEFINITION_ADL14.delete_opt-delete_specific_version</a></li>
<li><a href="#_tc_i_definition_adl14_delete_opt_delete_non_existing">5.3.5.5. TC I_DEFINITION_ADL14.delete_opt-delete_non_existing</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_func_conf_ehr_component">6. Functional Conformance: EHR Component</a>
<ul class="sectlevel2">
<li><a href="#_normative_reference_2">6.1. Normative Reference</a></li>
<li><a href="#_test_environment_2">6.2. Test Environment</a></li>
<li><a href="#_test_data_sets_2">6.3. Test Data Sets</a></li>
<li><a href="#_test_cases">6.4. Test Cases</a>
<ul class="sectlevel3">
<li><a href="#_conformance_point_i_ehr_service_has_ehr">6.4.1. Conformance point: I_EHR_SERVICE.has_ehr()</a>
<ul class="sectlevel4">
<li><a href="#_tc_ehr_has_ehr_existing_ehr_id">6.4.1.1. TC EHR.has_ehr-existing_ehr_id</a></li>
<li><a href="#_tc_ehr_has_ehr_existing_subject_id">6.4.1.2. TC EHR.has_ehr-existing_subject_id</a></li>
<li><a href="#_tc_ehr_has_ehr_non_existing_ehr_id">6.4.1.3. TC EHR.has_ehr-non_existing_ehr_id</a></li>
<li><a href="#_tc_ehr_has_ehr_non_existing_subject_id">6.4.1.4. TC EHR.has_ehr-non_existing_subject_id</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_ehr_service_create_ehr">6.4.2. Conformance point: I_EHR_SERVICE.create_ehr()</a>
<ul class="sectlevel4">
<li><a href="#_tc_ehr_create_ehr_main">6.4.2.1. TC EHR.create_ehr-main</a></li>
<li><a href="#_tc_ehr_create_ehr_same_ehr_twice">6.4.2.2. TC EHR.create_ehr-same_ehr_twice</a></li>
<li><a href="#_tc_ehr_create_ehr_two_ehrs_same_patient">6.4.2.3. TC EHR.create_ehr-two_ehrs_same_patient</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_ehr_service_get_ehr">6.4.3. Conformance point: I_EHR_SERVICE.get_ehr()</a>
<ul class="sectlevel4">
<li><a href="#_tc_ehr_get_ehr_existing_ehr_by_ehr_id">6.4.3.1. TC EHR.get_ehr-existing_ehr_by_ehr_id</a></li>
<li><a href="#_tc_ehr_get_ehr_existing_ehr_by_subject_id">6.4.3.2. TC EHR.get_ehr-existing_ehr_by_subject_id</a></li>
<li><a href="#_tc_ehr_get_ehr_get_ehr_by_invalid_ehr_id">6.4.3.3. TC EHR.get_ehr-get_ehr_by_invalid_ehr_id</a></li>
<li><a href="#_tc_ehr_get_ehr_get_ehr_by_invalid_subject_id">6.4.3.4. TC EHR.get_ehr-get_ehr_by_invalid_subject_id</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ehr_status_test_cases">6.5. EHR_STATUS Test Cases</a>
<ul class="sectlevel3">
<li><a href="#_conformance_point_i_ehr_status_get_ehr_status">6.5.1. Conformance Point: I_EHR_STATUS.get_ehr_status()</a>
<ul class="sectlevel4">
<li><a href="#_tc_ehr_status_get_ehr_status_get_by_ehr_id">6.5.1.1. TC EHR_STATUS.get_ehr_status-get_by_ehr_id</a></li>
<li><a href="#_tc_ehr_status_get_ehr_status_get_by_invalid_ehr_id">6.5.1.2. TC EHR_STATUS.get_ehr_status-get_by_invalid_ehr_id</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_ehr_status_set_ehr_queryable">6.5.2. Conformance Point: I_EHR_STATUS.set_ehr_queryable()</a>
<ul class="sectlevel4">
<li><a href="#_tc_ehr_status_set_ehr_queryable_existing_ehr">6.5.2.1. TC EHR_STATUS.set_ehr_queryable-existing_ehr</a></li>
<li><a href="#_tc_ehr_status_set_ehr_queryable_non_existing_ehr">6.5.2.2. TC EHR_STATUS.set_ehr_queryable-non_existing_ehr</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_ehr_status_set_ehr_modifiable">6.5.3. Conformance Point: I_EHR_STATUS.set_ehr_modifiable()</a>
<ul class="sectlevel4">
<li><a href="#_tc_ehr_status_set_ehr_modifiable_existing_ehr">6.5.3.1. TC EHR_STATUS.set_ehr_modifiable-existing_ehr</a></li>
<li><a href="#_tc_ehr_status_set_ehr_modifiable_non_existing_ehr">6.5.3.2. TC EHR_STATUS.set_ehr_modifiable-non_existing_ehr</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_ehr_status_clear_ehr_queryable">6.5.4. Conformance Point: I_EHR_STATUS.clear_ehr_queryable()</a>
<ul class="sectlevel4">
<li><a href="#_tc_ehr_status_clear_ehr_queryable_existing_ehr">6.5.4.1. TC EHR_STATUS.clear_ehr_queryable-existing_ehr</a></li>
<li><a href="#_tc_ehr_status_clear_ehr_queryable_non_existing_ehr">6.5.4.2. TC EHR_STATUS.clear_ehr_queryable-non_existing_ehr</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_ehr_status_clear_ehr_modifiable">6.5.5. Conformance Point: I_EHR_STATUS.clear_ehr_modifiable()</a>
<ul class="sectlevel4">
<li><a href="#_tc_ehr_status_clear_ehr_modifiable_existing_ehr">6.5.5.1. TC EHR_STATUS.clear_ehr_modifiable-existing_ehr</a></li>
<li><a href="#_tc_ehr_status_clear_ehr_modifiable_non_existing_ehr">6.5.5.2. TC EHR_STATUS.clear_ehr_modifiable-non_existing_ehr</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_functional_conformance_ehr_composition_component">7. Functional Conformance: EHR / COMPOSITION Component</a>
<ul class="sectlevel2">
<li><a href="#_normative_reference_3">7.1. Normative Reference</a></li>
<li><a href="#_dependencies">7.2. Dependencies</a></li>
<li><a href="#_test_environment_3">7.3. Test Environment</a></li>
<li><a href="#_test_cases_2">7.4. Test Cases</a>
<ul class="sectlevel3">
<li><a href="#_conformance_point_i_ehr_composition_has_composition">7.4.1. Conformance point: I_EHR_COMPOSITION.has_composition()</a>
<ul class="sectlevel4">
<li><a href="#_tc_ehr_composition_has_composition">7.4.1.1. TC EHR_COMPOSITION.has_composition</a></li>
<li><a href="#_tc_ehr_composition_has_composition_bad_composition">7.4.1.2. TC EHR_COMPOSITION.has_composition_bad_composition</a></li>
<li><a href="#_tc_ehr_composition_has_composition_bad_ehr">7.4.1.3. TC EHR_COMPOSITION.has_composition_bad_ehr</a></li>
</ul>
</li>
<li><a href="#_get_composition_latest">7.4.2. Get COMPOSITION latest</a>
<ul class="sectlevel4">
<li><a href="#_tc_ehr_composition_get_composition_latest">7.4.2.1. TC EHR_COMPOSITION.get_composition_latest</a></li>
<li><a href="#_tc_ehr_composition_get_composition_latest_bad_composition">7.4.2.2. TC EHR_COMPOSITION.get_composition_latest_bad_composition</a></li>
<li><a href="#_tc_ehr_composition_get_composition_latest_bad_ehr">7.4.2.3. TC EHR_COMPOSITION.get_composition_latest_bad_ehr</a></li>
</ul>
</li>
<li><a href="#_get_composition_at_time">7.4.3. Get COMPOSITION at time</a>
<ul class="sectlevel4">
<li><a href="#_tc_ehr_composition_get_composition_at_time">7.4.3.1. TC EHR_COMPOSITION.get_composition_at_time</a></li>
<li><a href="#_tc_ehr_composition_get_composition_at_time_no_time_arg">7.4.3.2. TC EHR_COMPOSITION.get_composition_at_time_no_time_arg</a></li>
<li><a href="#_tc_ehr_composition_get_composition_at_time_bad_composition">7.4.3.3. TC EHR_COMPOSITION.get_composition_at_time_bad_composition</a></li>
<li><a href="#_tc_ehr_composition_get_composition_at_time_bad_ehr">7.4.3.4. TC EHR_COMPOSITION.get_composition_at_time_bad_ehr</a></li>
<li><a href="#_tc_ehr_composition_get_composition_at_times">7.4.3.5. TC EHR_COMPOSITION.get_composition_at_times</a></li>
</ul>
</li>
<li><a href="#_get_composition_at_version">7.4.4. Get COMPOSITION at version</a>
<ul class="sectlevel4">
<li><a href="#_tc_ehr_composition_get_composition_version">7.4.4.1. TC EHR_COMPOSITION.get_composition_version</a></li>
<li><a href="#_tc_ehr_composition_get_composition_version_bad_version">7.4.4.2. TC EHR_COMPOSITION.get_composition_version_bad_version</a></li>
<li><a href="#_tc_ehr_composition_get_composition_version_bad_ehr">7.4.4.3. TC EHR_COMPOSITION.get_composition_version_bad_ehr</a></li>
<li><a href="#_tc_ehr_composition_get_composition_versions">7.4.4.4. TC EHR_COMPOSITION.get_composition_versions</a></li>
</ul>
</li>
<li><a href="#_get_versioned_composition">7.4.5. Get VERSIONED COMPOSITION</a>
<ul class="sectlevel4">
<li><a href="#_tc_ehr_composition_get_versioned_composition">7.4.5.1. TC EHR_COMPOSITION.get_versioned_composition</a></li>
<li><a href="#_tc_ehr_composition_get_non_existent_versioned_composition">7.4.5.2. TC EHR_COMPOSITION.get_non_existent_versioned_composition</a></li>
<li><a href="#_tc_ehr_composition_get_versioned_composition_bad_ehr">7.4.5.3. TC EHR_COMPOSITION.get_versioned_composition_bad_ehr</a></li>
</ul>
</li>
<li><a href="#_create_composition">7.4.6. Create COMPOSITION</a>
<ul class="sectlevel4">
<li><a href="#_tc_ehr_composition_create_event_composition">7.4.6.1. TC EHR_COMPOSITION.create_event_composition</a></li>
<li><a href="#_tc_ehr_composition_create_persistent_composition">7.4.6.2. TC EHR_COMPOSITION.create_persistent_composition</a></li>
<li><a href="#_tc_ehr_composition_create_persistent_composition_same_opt_twice">7.4.6.3. TC EHR_COMPOSITION.create_persistent_composition_same_opt_twice</a></li>
<li><a href="#_tc_ehr_composition_create_invalid_event_composition">7.4.6.4. TC EHR_COMPOSITION.create_invalid_event_composition</a></li>
<li><a href="#_tc_ehr_composition_create_invalid_persistent_composition">7.4.6.5. TC EHR_COMPOSITION.create_invalid_persistent_composition</a></li>
<li><a href="#_tc_ehr_composition_create_event_composition_bad_opt">7.4.6.6. TC EHR_COMPOSITION.create_event_composition_bad_opt</a></li>
<li><a href="#_tc_ehr_composition_create_event_composition_bad_ehr">7.4.6.7. TC EHR_COMPOSITION.create_event_composition_bad_ehr</a></li>
</ul>
</li>
<li><a href="#_update_composition">7.4.7. Update COMPOSITION</a>
<ul class="sectlevel4">
<li><a href="#_tc_ehr_composition_update_event_composition">7.4.7.1. TC EHR_COMPOSITION.update_event_composition</a></li>
<li><a href="#_tc_ehr_composition_update_persistent_composition">7.4.7.2. TC EHR_COMPOSITION.update_persistent_composition</a></li>
<li><a href="#_tc_ehr_composition_update_non_existent_composition">7.4.7.3. TC EHR_COMPOSITION.update_non_existent_composition</a></li>
<li><a href="#_tc_ehr_composition_update_composition_wrong_template">7.4.7.4. TC EHR_COMPOSITION.update_composition_wrong_template</a></li>
</ul>
</li>
<li><a href="#_delete_composition">7.4.8. Delete COMPOSITION</a>
<ul class="sectlevel4">
<li><a href="#_tc_ehr_composition_delete_event_composition">7.4.8.1. TC EHR_COMPOSITION.delete_event_composition</a></li>
<li><a href="#_tc_ehr_composition_delete_persistent_composition">7.4.8.2. TC EHR_COMPOSITION.delete_persistent_composition</a></li>
<li><a href="#_tc_ehr_composition_delete_non_existent_composition">7.4.8.3. TC EHR_COMPOSITION.delete_non_existent_composition</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_functional_conformance_ehr_contribution_component">8. Functional Conformance: EHR / CONTRIBUTION Component</a>
<ul class="sectlevel2">
<li><a href="#_normative_reference_4">8.1. Normative Reference</a></li>
<li><a href="#_dependencies_2">8.2. Dependencies</a></li>
<li><a href="#_test_environment_4">8.3. Test Environment</a></li>
<li><a href="#_test_data_sets_3">8.4. Test Data Sets</a>
<ul class="sectlevel3">
<li><a href="#_general_contribution_commit_data_sets">8.4.1. General CONTRIBUTION Commit Data Sets</a></li>
<li><a href="#_composition_contribution_commit_data_sets">8.4.2. COMPOSITION CONTRIBUTION Commit Data Sets</a>
<ul class="sectlevel4">
<li><a href="#_data_set_considerations">8.4.2.1. Data Set Considerations</a></li>
<li><a href="#_combinations_of_data_sets">8.4.2.2. Combinations of data sets</a></li>
</ul>
</li>
<li><a href="#_ehr_status_contribution_commit_data_sets">8.4.3. EHR_STATUS CONTRIBUTION Commit Data Sets</a>
<ul class="sectlevel4">
<li><a href="#_combinations_for_data_sets">8.4.3.1. Combinations for data sets</a></li>
</ul>
</li>
<li><a href="#_folder_contribution_commit_data_sets">8.4.4. FOLDER CONTRIBUTION Commit Data Sets</a>
<ul class="sectlevel4">
<li><a href="#_data_set_combinations">8.4.4.1. Data Set Combinations</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_test_cases_3">8.5. Test Cases</a>
<ul class="sectlevel3">
<li><a href="#_conformance_point_i_ehr_contribution_commit_contribution">8.5.1. Conformance point: I_EHR_CONTRIBUTION.commit_contribution()</a>
<ul class="sectlevel4">
<li><a href="#_tc_i_ehr_contribution_commit_contribution_valid_composition">8.5.1.1. TC I_EHR_CONTRIBUTION.commit_contribution-valid_composition</a></li>
<li><a href="#_tc_i_ehr_contribution_commit_contribution_invalid_composition">8.5.1.2. TC I_EHR_CONTRIBUTION.commit_contribution-invalid_composition</a></li>
<li><a href="#_tc_i_ehr_contribution_commit_contribution_empty">8.5.1.3. TC I_EHR_CONTRIBUTION.commit_contribution-empty</a></li>
<li><a href="#_tc_i_ehr_contribution_commit_contribution_valid_invalid_compositions">8.5.1.4. TC I_EHR_CONTRIBUTION.commit_contribution-valid_invalid_compositions</a></li>
<li><a href="#_tc_i_ehr_contribution_commit_contribution_event_composition">8.5.1.5. TC I_EHR_CONTRIBUTION.commit_contribution-event_composition</a></li>
<li><a href="#_tc_i_ehr_contribution_commit_contribution_persistent_composition">8.5.1.6. TC I_EHR_CONTRIBUTION.commit_contribution-persistent_composition</a></li>
<li><a href="#_tc_i_ehr_contribution_commit_contribution_delete_composition">8.5.1.7. TC I_EHR_CONTRIBUTION.commit_contribution-delete_composition</a></li>
<li><a href="#_tc_i_ehr_contribution_commit_contribution_two_commits_second_invalid">8.5.1.8. TC I_EHR_CONTRIBUTION.commit_contribution-two_commits_second_invalid</a></li>
<li><a href="#_tc_i_ehr_contribution_commit_contribution_two_commits_second_creation">8.5.1.9. TC I_EHR_CONTRIBUTION.commit_contribution-two_commits_second_creation</a></li>
<li><a href="#_tc_i_ehr_contribution_commit_contribution_non_exiting_opt">8.5.1.10. TC I_EHR_CONTRIBUTION.commit_contribution-non_exiting_opt</a></li>
<li><a href="#_tc_i_ehr_contribution_commit_contribution_minimal_ehr_status">8.5.1.11. TC I_EHR_CONTRIBUTION.commit_contribution-minimal_ehr_status</a></li>
<li><a href="#_tc_i_ehr_contribution_commit_contribution_full_ehr_status">8.5.1.12. TC I_EHR_CONTRIBUTION.commit_contribution-full_ehr_status</a></li>
<li><a href="#_tc_i_ehr_contribution_commit_contribution_ehr_status_invalid_change_type">8.5.1.13. TC I_EHR_CONTRIBUTION.commit_contribution-ehr_status_invalid_change_type</a></li>
<li><a href="#_tc_i_ehr_contribution_commit_contribution_invalid_ehr_status">8.5.1.14. TC I_EHR_CONTRIBUTION.commit_contribution-invalid_ehr_status</a></li>
<li><a href="#_tc_i_ehr_contribution_commit_contribution_valid_directory">8.5.1.15. TC I_EHR_CONTRIBUTION.commit_contribution-valid_directory</a></li>
<li><a href="#_tc_i_ehr_contribution_commit_contribution_fail_create_existing_directory">8.5.1.16. TC I_EHR_CONTRIBUTION.commit_contribution-fail_create_existing_directory</a></li>
<li><a href="#_tc_i_ehr_contribution_commit_contribution_fail_modify_non_existing_directory">8.5.1.17. TC I_EHR_CONTRIBUTION.commit_contribution-fail_modify_non_existing_directory</a></li>
<li><a href="#_tc_i_ehr_contribution_commit_contribution_update_existing_directory">8.5.1.18. TC I_EHR_CONTRIBUTION.commit_contribution-update_existing_directory</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_ehr_contribution_list_contributions">8.5.2. Conformance point: I_EHR_CONTRIBUTION.list_contributions()</a>
<ul class="sectlevel4">
<li><a href="#_tc_i_ehr_contribution_list_contributions_post_commit">8.5.2.1. TC I_EHR_CONTRIBUTION.list_contributions-post_commit</a></li>
<li><a href="#_tc_i_ehr_contribution_list_contributions_post_commit_2">8.5.2.2. TC I_EHR_CONTRIBUTION.list_contributions-post_commit</a></li>
<li><a href="#_tc_i_ehr_contribution_list_contributions_non_existing_ehr">8.5.2.3. TC I_EHR_CONTRIBUTION.list_contributions-non_existing_ehr</a></li>
<li><a href="#_tc_i_ehr_contribution_list_contributions_ehr_containing_ehr_status">8.5.2.4. TC I_EHR_CONTRIBUTION.list_contributions-ehr_containing_ehr_status</a></li>
<li><a href="#_tc_i_ehr_contribution_list_contributions_ehr_containing_directory">8.5.2.5. TC I_EHR_CONTRIBUTION.list_contributions-ehr_containing_directory</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_ehr_contribution_has_contribution">8.5.3. Conformance point: I_EHR_CONTRIBUTION.has_contribution()</a>
<ul class="sectlevel4">
<li><a href="#_tc_i_ehr_contribution_has_contribution_existing">8.5.3.1. TC I_EHR_CONTRIBUTION.has_contribution-existing</a></li>
<li><a href="#_tc_i_ehr_contribution_has_contribution_empty_ehr">8.5.3.2. TC I_EHR_CONTRIBUTION.has_contribution-empty_ehr</a></li>
<li><a href="#_tc_i_ehr_contribution_has_contribution_non_existing_ehr">8.5.3.3. TC I_EHR_CONTRIBUTION.has_contribution-non_existing_ehr</a></li>
<li><a href="#_tc_i_ehr_contribution_has_contribution_non_existing_contribution">8.5.3.4. TC I_EHR_CONTRIBUTION.has_contribution-non_existing_contribution</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_ehr_contribution_get_contribution">8.5.4. Conformance point: I_EHR_CONTRIBUTION.get_contribution()</a>
<ul class="sectlevel4">
<li><a href="#_tc_i_ehr_contribution_get_contribution_existing_contribution">8.5.4.1. TC I_EHR_CONTRIBUTION.get_contribution-existing_contribution</a></li>
<li><a href="#_tc_i_ehr_contribution_get_contribution_empty_ehr">8.5.4.2. TC I_EHR_CONTRIBUTION.get_contribution-empty_ehr</a></li>
<li><a href="#_tc_i_ehr_contribution_get_contribution_non_existing_ehr">8.5.4.3. TC I_EHR_CONTRIBUTION.get_contribution-non_existing_ehr</a></li>
<li><a href="#_tc_i_ehr_contribution_get_contribution_non_existing_contribution">8.5.4.4. TC I_EHR_CONTRIBUTION.get_contribution-non_existing_contribution</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_functional_conformance_ehr_directory_component">9. Functional Conformance: EHR / DIRECTORY Component</a>
<ul class="sectlevel2">
<li><a href="#_normative_reference_5">9.1. Normative Reference</a></li>
<li><a href="#_dependencies_3">9.2. Dependencies</a></li>
<li><a href="#_test_environment_5">9.3. Test Environment</a></li>
<li><a href="#_test_data_sets_4">9.4. Test Data Sets</a>
<ul class="sectlevel3">
<li><a href="#_tests_of_ehr_directory">9.4.1. Tests of EHR.directory</a></li>
<li><a href="#_tests_of_reference_folder_structure">9.4.2. Tests of Reference FOLDER structure</a></li>
</ul>
</li>
<li><a href="#_test_cases_4">9.5. Test Cases</a>
<ul class="sectlevel3">
<li><a href="#_conformance_point_i_ehr_directory_has_directory">9.5.1. Conformance point: I_EHR_DIRECTORY.has_directory()</a>
<ul class="sectlevel4">
<li><a href="#_tc_i_ehr_directory_has_directory_empty_ehr">9.5.1.1. TC I_EHR_DIRECTORY.has_directory-empty_ehr</a></li>
<li><a href="#_tc_i_ehr_directory_has_directory_ehr_with_directory">9.5.1.2. TC I_EHR_DIRECTORY.has_directory-ehr_with_directory</a></li>
<li><a href="#_tc_i_ehr_directory_has_directory_bad_ehr">9.5.1.3. TC I_EHR_DIRECTORY.has_directory-bad_ehr</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_ehr_directory_has_path">9.5.2. Conformance point: I_EHR_DIRECTORY.has_path()</a>
<ul class="sectlevel4">
<li><a href="#_tc_i_ehr_directory_has_path_empty_ehr">9.5.2.1. TC I_EHR_DIRECTORY.has_path-empty_ehr</a></li>
<li><a href="#_tc_i_ehr_directory_has_path_ehr_root_directory">9.5.2.2. TC I_EHR_DIRECTORY.has_path-ehr_root_directory</a></li>
<li><a href="#_tc_i_ehr_directory_has_path_folder_structure">9.5.2.3. TC I_EHR_DIRECTORY.has_path-folder_structure</a></li>
<li><a href="#_tc_i_ehr_directory_has_path_bad_ehr">9.5.2.4. TC I_EHR_DIRECTORY.has_path-bad_ehr</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_ehr_directory_create_directory">9.5.3. Conformance point: I_EHR_DIRECTORY.create_directory()</a>
<ul class="sectlevel4">
<li><a href="#_tc_i_ehr_directory_create_directory_empty_ehr">9.5.3.1. TC I_EHR_DIRECTORY.create_directory-empty_ehr</a></li>
<li><a href="#_tc_i_ehr_directory_create_directory_ehr_with_directory">9.5.3.2. TC I_EHR_DIRECTORY.create_directory-ehr_with_directory</a></li>
<li><a href="#_tc_i_ehr_directory_create_directory_bad_ehr">9.5.3.3. TC I_EHR_DIRECTORY.create_directory-bad_ehr</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_ehr_directory_get_directory">9.5.4. Conformance point: I_EHR_DIRECTORY.get_directory()</a>
<ul class="sectlevel4">
<li><a href="#_tc_i_ehr_directory_get_directory_empty_ehr">9.5.4.1. TC I_EHR_DIRECTORY.get_directory-empty_ehr</a></li>
<li><a href="#_tc_i_ehr_directory_get_directory_ehr_root_directory">9.5.4.2. TC I_EHR_DIRECTORY.get_directory-ehr_root_directory</a></li>
<li><a href="#_tc_i_ehr_directory_get_directory_directory_with_structure">9.5.4.3. TC I_EHR_DIRECTORY.get_directory-directory_with_structure</a></li>
<li><a href="#_tc_i_ehr_directory_get_directory_directory_with_structure_2">9.5.4.4. TC I_EHR_DIRECTORY.get_directory-directory_with_structure</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_ehr_directory_get_directory_at_time">9.5.5. Conformance point: I_EHR_DIRECTORY.get_directory_at_time()</a>
<ul class="sectlevel4">
<li><a href="#_tc_i_ehr_directory_get_directory_at_time_empty_ehr">9.5.5.1. TC I_EHR_DIRECTORY.get_directory_at_time-empty_ehr</a></li>
<li><a href="#_tc_i_ehr_directory_get_directory_at_time_empty_ehr_empty_time">9.5.5.2. TC I_EHR_DIRECTORY.get_directory_at_time-empty_ehr_empty_time</a></li>
<li><a href="#_tc_i_ehr_directory_get_directory_at_time_ehr_with_directory">9.5.5.3. TC I_EHR_DIRECTORY.get_directory_at_time-ehr_with_directory</a></li>
<li><a href="#_tc_i_ehr_directory_get_directory_at_time_ehr_with_directory_empty_time">9.5.5.4. TC I_EHR_DIRECTORY.get_directory_at_time-ehr_with_directory_empty_time</a></li>
<li><a href="#_tc_i_ehr_directory_get_directory_at_time_ehr_with_directory_versions">9.5.5.5. TC I_EHR_DIRECTORY.get_directory_at_time-ehr_with_directory_versions</a></li>
<li><a href="#_tc_i_ehr_directory_get_directory_at_time_ehr_with_directory_versions_empty_time">9.5.5.6. TC I_EHR_DIRECTORY.get_directory_at_time-ehr_with_directory_versions_empty_time</a></li>
<li><a href="#_tc_i_ehr_directory_get_directory_at_time_bad_ehr">9.5.5.7. TC I_EHR_DIRECTORY.get_directory_at_time-bad_ehr</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_ehr_directory_update_directory">9.5.6. Conformance point: I_EHR_DIRECTORY.update_directory()</a>
<ul class="sectlevel4">
<li><a href="#_tc_i_ehr_directory_update_directory_ehr_with_directory">9.5.6.1. TC I_EHR_DIRECTORY.update_directory-ehr_with_directory</a></li>
<li><a href="#_tc_i_ehr_directory_update_directory_empty_ehr">9.5.6.2. TC I_EHR_DIRECTORY.update_directory-empty_ehr</a></li>
<li><a href="#_tc_i_ehr_directory_update_directory_bad_ehr">9.5.6.3. TC I_EHR_DIRECTORY.update_directory-bad_ehr</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_ehr_directory_delete_directory">9.5.7. Conformance point: I_EHR_DIRECTORY.delete_directory()</a>
<ul class="sectlevel4">
<li><a href="#_tc_i_ehr_directory_delete_directory_empty_ehr">9.5.7.1. TC I_EHR_DIRECTORY.delete_directory-empty_ehr</a></li>
<li><a href="#_tc_i_ehr_directory_delete_directory_ehr_with_directory">9.5.7.2. TC I_EHR_DIRECTORY.delete_directory-ehr_with_directory</a></li>
<li><a href="#_tc_i_ehr_directory_delete_directory_bad_ehr">9.5.7.3. TC I_EHR_DIRECTORY.delete_directory-bad_ehr</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_ehr_directory_has_directory_version">9.5.8. Conformance point: I_EHR_DIRECTORY.has_directory_version()</a>
<ul class="sectlevel4">
<li><a href="#_tc_i_ehr_directory_has_directory_version_empty_ehr">9.5.8.1. TC I_EHR_DIRECTORY.has_directory_version-empty_ehr</a></li>
<li><a href="#_tc_i_ehr_directory_has_directory_version_directory_with_two_versions">9.5.8.2. TC I_EHR_DIRECTORY.has_directory_version-directory_with_two_versions</a></li>
<li><a href="#_tc_i_ehr_directory_has_directory_version_bad_ehr">9.5.8.3. TC I_EHR_DIRECTORY.has_directory_version-bad_ehr</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_ehr_directory_get_directory_at_version">9.5.9. Conformance point: I_EHR_DIRECTORY.get_directory_at_version()</a>
<ul class="sectlevel4">
<li><a href="#_tc_i_ehr_directory_get_directory_at_version_empty_ehr">9.5.9.1. TC I_EHR_DIRECTORY.get_directory_at_version-empty_ehr</a></li>
<li><a href="#_tc_i_ehr_directory_get_directory_at_version_directory_with_two_versions">9.5.9.2. TC I_EHR_DIRECTORY.get_directory_at_version-directory_with_two_versions</a></li>
<li><a href="#_tc_i_ehr_directory_get_directory_at_version_bad_ehr">9.5.9.3. TC I_EHR_DIRECTORY.get_directory_at_version-bad_ehr</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_ehr_directory_get_versioned_directory">9.5.10. Conformance point: I_EHR_DIRECTORY.get_versioned_directory()</a>
<ul class="sectlevel4">
<li><a href="#_tc_i_ehr_directory_get_versioned_directory_empty_ehr">9.5.10.1. TC I_EHR_DIRECTORY.get_versioned_directory-empty_ehr</a></li>
<li><a href="#_tc_i_ehr_directory_get_versioned_directory_directory_with_two_versions">9.5.10.2. TC I_EHR_DIRECTORY.get_versioned_directory-directory_with_two_versions</a></li>
<li><a href="#_tc_i_ehr_directory_get_versioned_directory_bad_ehr">9.5.10.3. TC I_EHR_DIRECTORY.get_versioned_directory-bad_ehr</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_functional_conformance_demographic_component">10. Functional Conformance: Demographic Component</a>
<ul class="sectlevel2">
<li><a href="#_normative_reference_6">10.1. Normative Reference</a></li>
<li><a href="#_dependencies_4">10.2. Dependencies</a></li>
<li><a href="#_test_environment_6">10.3. Test Environment</a></li>
<li><a href="#_test_data_sets_5">10.4. Test Data Sets</a></li>
<li><a href="#_test_cases_5">10.5. Test Cases</a>
<ul class="sectlevel3">
<li><a href="#_conformance_point_i_demographic_service_create_party">10.5.1. Conformance point: I_DEMOGRAPHIC_SERVICE.create_party()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa">10.5.1.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb">10.5.1.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_demographic_service_get_party">10.5.2. Conformance point: I_DEMOGRAPHIC_SERVICE.get_party()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_2">10.5.2.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_2">10.5.2.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_demographic_service_get_party_at_time">10.5.3. Conformance point: I_DEMOGRAPHIC_SERVICE.get_party_at_time()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_3">10.5.3.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_3">10.5.3.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_demographic_service_update_party">10.5.4. Conformance point: I_DEMOGRAPHIC_SERVICE.update_party()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_4">10.5.4.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_4">10.5.4.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_demographic_service_delete_party">10.5.5. Conformance point: I_DEMOGRAPHIC_SERVICE.delete_party()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_5">10.5.5.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_5">10.5.5.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_demographic_service_get_party_at_version">10.5.6. Conformance point: I_DEMOGRAPHIC_SERVICE.get_party_at_version()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_6">10.5.6.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_6">10.5.6.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_demographic_service_create_party_relationship">10.5.7. Conformance point: I_DEMOGRAPHIC_SERVICE.create_party_relationship()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_7">10.5.7.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_7">10.5.7.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_demographic_service_get_party_relationship">10.5.8. Conformance point: I_DEMOGRAPHIC_SERVICE.get_party_relationship()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_8">10.5.8.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_8">10.5.8.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_demographic_service_get_party_relationship_at_time">10.5.9. Conformance point: I_DEMOGRAPHIC_SERVICE.get_party_relationship_at_time()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_9">10.5.9.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_9">10.5.9.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_demographic_service_update_party_relationship">10.5.10. Conformance point: I_DEMOGRAPHIC_SERVICE.update_party_relationship()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_10">10.5.10.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_10">10.5.10.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_demographic_service_delete_party_relationship">10.5.11. Conformance point: I_DEMOGRAPHIC_SERVICE.delete_party_relationship()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_11">10.5.11.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_11">10.5.11.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_demographic_service_get_party_relationship_at_version">10.5.12. Conformance point: I_DEMOGRAPHIC_SERVICE.get_party_relationship_at_version()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_12">10.5.12.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_12">10.5.12.2. TC bbbb</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_functional_conformance_querying_component">11. Functional Conformance: Querying Component</a>
<ul class="sectlevel2">
<li><a href="#_normative_reference_7">11.1. Normative Reference</a></li>
<li><a href="#_dependencies_5">11.2. Dependencies</a></li>
<li><a href="#_test_environment_7">11.3. Test Environment</a></li>
<li><a href="#_test_data_sets_6">11.4. Test Data Sets</a></li>
<li><a href="#_test_cases_6">11.5. Test Cases</a>
<ul class="sectlevel3">
<li><a href="#_conformance_point_i_query_service_execute_stored_query">11.5.1. Conformance point: I_QUERY_SERVICE.execute_stored_query()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_13">11.5.1.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_13">11.5.1.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_query_service_execute_ad_hoc_query">11.5.2. Conformance point: I_QUERY_SERVICE.execute_ad_hoc_query()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_14">11.5.2.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_14">11.5.2.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_query_service_execute_stored_query_2">11.5.3. Conformance point: I_QUERY_SERVICE.execute_stored_query()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_15">11.5.3.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_15">11.5.3.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_query_service_execute_stored_query_3">11.5.4. Conformance point: I_QUERY_SERVICE.execute_stored_query()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_16">11.5.4.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_16">11.5.4.2. TC bbbb</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_functional_conformance_admin_product_component">12. Functional Conformance: Admin Product Component</a>
<ul class="sectlevel2">
<li><a href="#_normative_reference_8">12.1. Normative Reference</a></li>
<li><a href="#_dependencies_6">12.2. Dependencies</a></li>
<li><a href="#_test_environment_8">12.3. Test Environment</a></li>
<li><a href="#_test_data_sets_7">12.4. Test Data Sets</a></li>
<li><a href="#_test_cases_7">12.5. Test Cases</a>
<ul class="sectlevel3">
<li><a href="#_conformance_point_i_admin_service_list_contributions">12.5.1. Conformance point: I_ADMIN_SERVICE.list_contributions()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_17">12.5.1.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_17">12.5.1.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_admin_service_contribution_count">12.5.2. Conformance point: I_ADMIN_SERVICE.contribution_count()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_18">12.5.2.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_18">12.5.2.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_admin_service_versioned_composition_count">12.5.3. Conformance point: I_ADMIN_SERVICE.versioned_composition_count()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_19">12.5.3.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_19">12.5.3.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_admin_service_composition_version_count">12.5.4. Conformance point: I_ADMIN_SERVICE.composition_version_count()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_20">12.5.4.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_20">12.5.4.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_admin_service_physical_ehr_delete">12.5.5. Conformance point: I_ADMIN_SERVICE.physical_ehr_delete()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_21">12.5.5.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_21">12.5.5.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_admin_service_physical_party_delete">12.5.6. Conformance point: I_ADMIN_SERVICE.physical_party_delete()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_22">12.5.6.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_22">12.5.6.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_admin_dump_load_export_ehrs">12.5.7. Conformance point: I_ADMIN_DUMP_LOAD.export_ehrs()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_23">12.5.7.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_23">12.5.7.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_admin_archive_archive_ehrs">12.5.8. Conformance point: I_ADMIN_ARCHIVE.archive_ehrs()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_24">12.5.8.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_24">12.5.8.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_admin_archive_archive_parties">12.5.9. Conformance point: I_ADMIN_ARCHIVE.archive_parties()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_25">12.5.9.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_25">12.5.9.2. TC bbbb</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_functional_conformance_messaging_component">13. Functional Conformance: Messaging Component</a>
<ul class="sectlevel2">
<li><a href="#_normative_reference_9">13.1. Normative Reference</a></li>
<li><a href="#_dependencies_7">13.2. Dependencies</a></li>
<li><a href="#_test_environment_9">13.3. Test Environment</a></li>
<li><a href="#_test_data_sets_8">13.4. Test Data Sets</a></li>
<li><a href="#_test_cases_8">13.5. Test Cases</a>
<ul class="sectlevel3">
<li><a href="#_conformance_point_i_ehr_extract_export_ehr">13.5.1. Conformance point: I_EHR_EXTRACT.export_ehr()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_26">13.5.1.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_26">13.5.1.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_ehr_extract_export_ehr_extract">13.5.2. Conformance point: I_EHR_EXTRACT.export_ehr_extract()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_27">13.5.2.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_27">13.5.2.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_ehr_extract_export_ehr_2">13.5.3. Conformance point: I_EHR_EXTRACT.export_ehr()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_28">13.5.3.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_28">13.5.3.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_ehr_extract_export_ehrs">13.5.4. Conformance point: I_EHR_EXTRACT.export_ehrs()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_29">13.5.4.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_29">13.5.4.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_ehr_extract_export_ehr_extracts">13.5.5. Conformance point: I_EHR_EXTRACT.export_ehr_extracts()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_30">13.5.5.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_30">13.5.5.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_tdd_import_tdd">13.5.6. Conformance point: I_TDD.import_tdd()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_31">13.5.6.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_31">13.5.6.2. TC bbbb</a></li>
</ul>
</li>
<li><a href="#_conformance_point_i_tdd_import_tdds">13.5.7. Conformance point: I_TDD.import_tdds()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_32">13.5.7.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_32">13.5.7.2. TC bbbb</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_non_functional_conformance_security_and_privacy">14. Non-Functional Conformance - Security and Privacy</a>
<ul class="sectlevel2">
<li><a href="#_normative_reference_10">14.1. Normative Reference</a></li>
<li><a href="#_dependencies_8">14.2. Dependencies</a></li>
<li><a href="#_test_environment_10">14.3. Test Environment</a></li>
<li><a href="#_test_data_sets_9">14.4. Test Data Sets</a></li>
<li><a href="#_test_cases_9">14.5. Test Cases</a>
<ul class="sectlevel3">
<li><a href="#_conformance_point_i_ehr_composition_create_composition">14.5.1. Conformance point: I_EHR_COMPOSITION.create_composition()</a>
<ul class="sectlevel4">
<li><a href="#_tc_aaaa_33">14.5.1.1. TC aaaa</a></li>
<li><a href="#_tc_bbbb_33">14.5.1.2. TC bbbb</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_application_programmer_interfaces_apis">15. Application Programmer Interfaces (APIs)</a>
<ul class="sectlevel2">
<li><a href="#_rest_api_component">15.1. REST API Component</a></li>
</ul>
</li>
<li><a href="#_profiles">16. Profiles</a>
<ul class="sectlevel2">
<li><a href="#_default_profiles">16.1. Default Profiles</a>
<ul class="sectlevel3">
<li><a href="#_functional">16.1.1. Functional</a></li>
<li><a href="#_non_functional">16.1.2. Non-Functional</a></li>
<li><a href="#_other_non_functional">16.1.3. Other Non-Functional</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock text-center">
<div class="content">
<img src="https://specifications.openehr.org/images/openEHR_logo_RGB.svg" alt="openEHR logo">
</div>
</div>
</div>
</div>
<h1 id="_openehr_platform_conformance_test_schedule" class="sect0"><a class="anchor" href="#_openehr_platform_conformance_test_schedule"></a>openEHR Platform Conformance Test Schedule</h1>
<div class="openblock partintro">
<div class="content">
<table class="tableblock frame-all grid-all fit-content spread">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2"><strong>Issuer</strong>: <a href="https://www.openehr.org/programs/specification" target="_blank" rel="noopener">openEHR Specification Program</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Release</strong>: CNF latest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Status</strong>: DEVELOPMENT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Revision</strong>: <a href="#latest_issue">[latest_issue]</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Date</strong>: <a href="#latest_issue_date">[latest_issue_date]</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>Keywords</strong>: conformance</p></td>
</tr>
</tbody>
</table>
<div class="imageblock text-center">
<div class="content">
<object type="image/svg+xml" data="openehr_block_diagram.svg" width="60%"><span class="alt">openEHR components</span></object>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2">&#169; 2017 - 2022 The openEHR Foundation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><a href="https://www.openehr.org" target="_blank" rel="noopener">The openEHR Foundation</a> is an independent, non-profit foundation, facilitating the sharing of health records by consumers and clinicians via open specifications, clinical models and open platform implementations.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Licence</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="https://specifications.openehr.org/images/cc-by-nd-88x31.png" alt="image"></span> Creative Commons Attribution-NoDerivs 3.0 Unported. <a href="https://creativecommons.org/licenses/by-nd/3.0/" class="bare">https://creativecommons.org/licenses/by-nd/3.0/</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Support</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Issues: <a href="https://specifications.openehr.org/components/CNF/open_issues" target="_blank" rel="noopener">Problem Reports</a><br>
 Web: <a href="https://specifications.openehr.org" target="_blank" rel="noopener">specifications.openEHR.org</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_amendment_record"><a class="anchor" href="#_amendment_record"></a>Amendment Record</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 54.5454%;">
<col style="width: 18.1818%;">
<col style="width: 18.1819%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Issue</th>
<th class="tableblock halign-left valign-top">Details</th>
<th class="tableblock halign-left valign-top">Raiser</th>
<th class="tableblock halign-left valign-top">Completed</th>
</tr>
</thead>
<tbody>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>CNF Release 1.0.?</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="latest_issue"></a>0.8.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rewrite main schedule based on EhrBase (Github commit <a href="https://github.com/ehrbase/ehrbase/commit/674e8b2506a77bf1adc365eb73e718e2126f2c8e" target="_blank" rel="noopener">674e8b2</a>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P Pazos;<br>
 W Wagner;<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="latest_issue_date"></a>23 Nov 2021</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.7.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Updates and new diagrams for SUT section; Adjust some test sets.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">17 Mar 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.7.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Major rework based on openEHR Patform SM.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">openEHR SEC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">18 Oct 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.6.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Updates to REST API at 25 Aug 2017. Added glossary. Improved SUT diagram.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale,<br>
 S Iancu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">26 Aug 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.6.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Major rework from SEC call 9 Aug 2017.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C Chevalley,<br>
 H Frankel,<br>
 S Iancu,<br>
 B Lah,<br>
 B Naess,<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">11 Aug 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.5.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECCNF-1" target="_blank" rel="noopener">SPECCNF-1</a>: Initial Writing.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">B Naess,<br>
 I McNicoll,<br>
 P Pazos,<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">01 Jun 2017</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_acknowledgements"><a class="anchor" href="#_acknowledgements"></a>Acknowledgements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This specification was developed and is maintained by the <a href="https://www.openehr.org/programs/specification/editorialcommittee" target="_blank" rel="noopener">openEHR Specifications Editorial Committee (SEC)</a>.</p>
</div>
<div class="sect2">
<h3 id="_principal_authors"><a class="anchor" href="#_principal_authors"></a>Principal Authors</h3>
<div class="ulist">
<ul>
<li>
<p>Thomas Beale, Ars Semantica, UK; openEHR International Board</p>
</li>
<li>
<p>Pablo Pazos Gutierrez &lt;<a href="mailto:pablo.pazos@cabolabs.com">pablo.pazos@cabolabs.com</a>&gt;</p>
</li>
<li>
<p>Wladislaw Wagner &lt;<a href="mailto:wladislaw.wagner@vitagroup.ag">wladislaw.wagner@vitagroup.ag</a>&gt;</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_trademarks"><a class="anchor" href="#_trademarks"></a>Trademarks</h3>
<div class="ulist">
<ul>
<li>
<p>'openEHR' is a trademark of the openEHR Foundation</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_preface"><a class="anchor" href="#_preface"></a>1. Preface</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_purpose"><a class="anchor" href="#_purpose"></a>1.1. Purpose</h3>
<div class="paragraph">
<p>This document specifies the openEHR Platform Conformance test schedule, which may be used to determine the conformance of openEHR platform products to openEHR plaform-related specifications. The audience of this document includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Software development organisations developing healthcare information systems;</p>
</li>
<li>
<p>Customer (i.e. procuring) organisations.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_documents"><a class="anchor" href="#_related_documents"></a>1.2. Related Documents</h3>
<div class="paragraph">
<p>Useful references for reading this document include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="https://specifications.openehr.org/releases/BASE/latest/architecture_overview.html" target="_blank" rel="noopener">openEHR Architecture Overview</a>;</p>
</li>
<li>
<p>The <a href="https://specifications.openehr.org/releases/CNF/latest/guide.html" target="_blank" rel="noopener">openEHR Conformance Guide</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_status"><a class="anchor" href="#_status"></a>1.3. Status</h3>
<div class="paragraph">
<p>This specification is in the DEVELOPMENT state. The development version of this document can be found at <a href="https://specifications.openehr.org/releases/CNF/latest/platform_test_schedule.html" target="_blank" rel="noopener">https://specifications.openehr.org/releases/CNF/latest/platform_test_schedule.html</a>.</p>
</div>
<div class="paragraph">
<p>Known omissions or questions are indicated in the text with a 'to be determined' paragraph, as follows:</p>
</div>
<div class="paragraph tbd">
<p><strong>TBD</strong>: (example To Be Determined paragraph)</p>
</div>
</div>
<div class="sect2">
<h3 id="_feedback"><a class="anchor" href="#_feedback"></a>1.4. Feedback</h3>
<div class="paragraph">
<p>Feedback may be provided on the <a href="https://discourse.openehr.org/c/implem/conformance" target="_blank" rel="noopener">openEHR Conformance forum</a>.</p>
</div>
<div class="paragraph">
<p>Issues may be raised on the <a href="https://specifications.openehr.org/components/CNF/open_issues" target="_blank" rel="noopener">specifications Problem Report tracker</a>.</p>
</div>
<div class="paragraph">
<p>To see changes made due to previously reported issues, see the <a href="https://specifications.openehr.org/components/CNF/history" target="_blank" rel="noopener">CNF component Change Request tracker</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_glossary_of_terms_and_acronyms"><a class="anchor" href="#_glossary_of_terms_and_acronyms"></a>2. Glossary of Terms and Acronyms</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following terms and acronyms are used in this document.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Term</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application Programmer Interface.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CDS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clinical Decision Support.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://en.wikipedia.org/wiki/Representational_state_transfer" target="_blank" rel="noopener">Representational state transfer</a>,
                         a type of web service. REST-compliant Web services allow requesting systems to access and manipulate
                         textual representations of Web resources using a uniform and predefined set of stateless operations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SUT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">System under test.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a>3. Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Conformance testing is used as the basis of product certification, and has the following goals:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Tendering</em>: enable tendering authorities to state formal criteria for compliance in tenders</p>
</li>
<li>
<p><em>Protection for solution developers</em>: enables bona fide vendors and other developers to prove the quality of their solutions compared to other offerings claiming conformance</p>
</li>
<li>
<p><em>Protection for procurement</em>: provides a way of ensuring that purchased solutions can be contractually guaranteed to perform in certain ways</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_scope"><a class="anchor" href="#_scope"></a>3.1. Scope</h3>
<div class="paragraph">
<p>This specification describes the <em>conformance points</em> for <em>openEHR platform products</em> whose semantics are based on openEHR Foundation specifications. Such systems typically include data services (i.e. persistence &amp; querying) along with various options dependent on the orientation of the product and its maturity; these may include integration capabilities, domain services (e.g. guidelines, planning) and so on. It does not cover applications or modelling tools.</p>
</div>
<div class="paragraph">
<p>A conformance point is understood as a <em>testable capability of a system that relates to a business function</em>. For example, conformance points for an EHR persistence service (aka Clinical Data Repository, or CDR) may include 'create EHR', 'update EHR', 'versioning' etc. Conformance points are based on <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html" target="_blank" rel="noopener">openEHR Platform Abstract Service Model</a> API calls.</p>
</div>
<div class="paragraph">
<p>One or more methods of testing each conformance point is described in this specification. Conformance testing is based on comparing system behaviour to the relevant openEHR published specifications.</p>
</div>
<div class="paragraph">
<p>Fine-grained system capabilities naturally aggregate in various ways to produce specific coarse-grained business-relevant profiles, such as for a 'minimally viable openEHR system' and so on. In order to provide the customer side with a means of determining what constitute sensible sets of requirements, the specification defines a set of <em>profiles</em>.</p>
</div>
<div class="paragraph">
<p>The scope of this specification is limited to the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>(specific) functional capabilities of systems;</p>
</li>
<li>
<p>limited non-functional capabilities, including:</p>
<div class="ulist">
<ul>
<li>
<p>external data format used by exposed APIs;</p>
</li>
<li>
<p>security and privacy.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The system under test is accessed via one or more concrete protocol APIs, each of which is defined in the relevant openEHR Specification.</p>
</div>
<div class="paragraph">
<p>This specification does not cover claims to other non-functional characteristics such as capacity, performance, availability, or consistency of systems. It is however recommended that supply agreements for operational solutions include criteria for these factors, as relevant to the situation.</p>
</div>
<div class="paragraph">
<p>It may be possible to develop a band-based rating sytem for capacity. Performance, availability, consistency and related characteristics may be assessed using a framework that takes account of the CAP and / or PACELC theorems.</p>
</div>
<div class="paragraph">
<p>Specific applications are also outside the scope of this specification, however, it is assumed that in order for solutions to be testable, a minimal generic viewing tool is provided to enable viewing or data and other testable events.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conformance_schedule"><a class="anchor" href="#_conformance_schedule"></a>4. Conformance Schedule</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_2"><a class="anchor" href="#_overview_2"></a>4.1. Overview</h3>
<div class="paragraph">
<p>This section contains the schedule according to which conformance claims can be made for a product. The conformance test schedule is divided into functional and non-functional parts, for which the structures are slightly different.</p>
</div>
<div class="paragraph">
<p>Functional conformance is on the basis of <em>product component</em>, i.e. 'EHR persistence', 'Querying' etc, each corresponding to a named block on the above SUT diagram. Each product component has one table in this schedule. Formal conformance points, defined in terms of calls in the relevant component service interface, are listed in the second column of the table. The first column groups conformance points under 'capability', which is understood as a marketing term reflecting coarse-grained functionality, and is <em>used as the basis for conformance profiles</em> described in the next section.</p>
</div>
<div class="paragraph">
<p>The remaining columns but one describe each 'semantic' conformance point, and define the logic of a conformance test case for it, expressed as Java-like pseudo-code. In many cases, one test script may be used to test multiple conformance points.</p>
</div>
<div class="paragraph">
<p>The final column(s) provides the implementation of the test case for REST web services over HTTP. Each other protocol will result in a new column on the right.</p>
</div>
<div class="paragraph">
<p>The following illustrates the conformance table structure for functional components.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 18.1818%;">
<col style="width: 18.1818%;">
<col style="width: 27.2727%;">
<col style="width: 18.1818%;">
<col style="width: 18.1819%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Capability</th>
<th class="tableblock halign-left valign-top">Conformance Point<br>
                         (Service Model call)</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Test case script</th>
<th class="tableblock halign-left valign-top">REST script</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Claimed capability<br>
 of the component.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Testable characteristic<br>
                         defined in terms of<br>
                         abstract service model call.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description of conformance point.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logical test case<br>
                                                                                         script (pseudo-code)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST API test script<br>
                                                                                                                 (postman)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For the small number of system non-functional characteristics for which conformance is defined here, the table structure is the same. However, conformance points are not formally defined by the openEHR Service Model, but informally defined by this specification.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_func_conf_def_component"><a class="anchor" href="#_func_conf_def_component"></a>5. Functional Conformance: Definitions Component</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_normative_reference"><a class="anchor" href="#_normative_reference"></a>5.1. Normative Reference</h3>
<div class="paragraph">
<p>Items under this validation suite conceptually use these abstract interfaces defined in the <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_definition_package" target="_blank" rel="noopener">Abstract Definition Service Model</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>I_DEFINITION_ADL14</p>
</li>
<li>
<p>I_DEFINITION_ADL2</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These are concretely realised in implementation technology specfic APIs, such as the <a href="https://specifications.openehr.org/releases/ITS-REST/latest/definitions.html" target="_blank" rel="noopener">Definitions REST API</a>.</p>
</div>
<div class="paragraph">
<p>The artefacts that flow through these interfaces are defined by the following specifications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://specifications.openehr.org/releases/AM/latest/ADL1.4.html" target="_blank" rel="noopener">ADL 1.4</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/AM/latest/AOM1.4.html" target="_blank" rel="noopener">AOM 1.4</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/AM/latest/ADL2.html" target="_blank" rel="noopener">ADL 2</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/AM/latest/AOM2.html" target="_blank" rel="noopener">AOM 2</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/AM/latest/Identification.html" target="_blank" rel="noopener">Archetype Identification</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_test_environment"><a class="anchor" href="#_test_environment"></a>5.2. Test Environment</h3>
<div class="paragraph">
<p>The server under test should support:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>OPTs 1.4 or 2, but OPT 1.4 if more frequent since modeling tools supporting this were around for a long time. Could also support ADL, 1.4 or 2;</p>
</li>
<li>
<p>validation of OPTs and archetypes uploaded to it, or even provide a service to do so before uploading (useful while developing);</p>
</li>
<li>
<p>different versions of the same OPTs and archetypes.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following should be taken into account when testing any given product:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The server under test should support the full cycle of OPT management, including: validation, loading, versioning, retrieving, delete or deactivation (data for this OPT is loaded but no new data should be accepted for it). For the delete, the internal behavior should be defined: 1. if data was committed referencing an OPT, can it be physically deleted? or should be logically deleted? 2. if there is no
data, can the OPT be deleted physically? Logical delete might work as the deactivation mentioned above.</p>
</li>
<li>
<p>The test cases are the same for OPT 1.4/2, but tests should be written separately and different datasets should be created for 1.4 and 2.</p>
</li>
<li>
<p>Different implementations might use specific formats for the template IDs, when testing each server, the template IDs should be adapted to prevent failures for wrong format on the template ID. This is due to openEHR not yet defining a format for the template IDs in the specifications.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_opt_1_42_test_cases"><a class="anchor" href="#_opt_1_42_test_cases"></a>5.3. OPT 1.4/2 Test cases</h3>
<div class="sect3">
<h4 id="_conformance_point_i_definition_adl14_validate_opt"><a class="anchor" href="#_conformance_point_i_definition_adl14_validate_opt"></a>5.3.1. Conformance Point: I_DEFINITION_ADL14.validate_opt()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_definition_adl14_interface" target="_blank" rel="noopener"><code>I_DEFINITION_ADL14.<em>validate_opt()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_test_data_sets"><a class="anchor" href="#_test_data_sets"></a>5.3.1.1. Test Data Sets</h5>
<div class="ulist">
<ul>
<li>
<p>minimal valid OPT (each containing each entry type);</p>
</li>
<li>
<p>maximal valid OPT (all types in the RM);</p>
</li>
<li>
<p>invalid OPT (empty file);</p>
</li>
<li>
<p>invalid OPT (empty <code>template_id</code>);</p>
</li>
<li>
<p>invalid OPT (removed mandatory elements);</p>
</li>
<li>
<p>invalid OPT (added multiple elements that had an upper bound of 1)</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_tc_i_definition_adl14_validate_opt_valid_opt"><a class="anchor" href="#_tc_i_definition_adl14_validate_opt_valid_opt"></a>5.3.1.2. TC I_DEFINITION_ADL14.validate_opt-valid_opt</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>validate valid OPTs</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The server should be empty (no EHRs, no commits, no OPTs).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None (validation should not change the state of the system).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>For each valid OPT in the data set, invoke the OPT validation service</p>
</li>
<li>
<p>The result should be positive and the server should return should be related to &#8220;OPT is valid&#8221;.</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
some servers might not have a way to just validate the OPT, and validation might be part of the OPT upload functionality. In that case, the validation should upload and validate the OPT, and in the cases of valid OPTs, the OPT should be deleted afterwards, so the system state doesn’t change. For invalid OPTs, the upload should fail.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_tc_i_definition_adl14_validate_opt_invalid_opt"><a class="anchor" href="#_tc_i_definition_adl14_validate_opt_invalid_opt"></a>5.3.1.3. TC I_DEFINITION_ADL14.validate_opt-invalid_opt</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>validate valid OPTs</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The server should be empty (no EHRs, no commits, no OPTs).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None (validation should not change the state of the system).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>For each invalid OPT in the data set, invoke the OPT validation service</p>
</li>
<li>
<p>The result should be negative related to the &#8220;OPT is invalid&#8221;, would be useful if the server also returns where the problems are in the OPT</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Implementation note:</strong> when a step says &#8220;for each X, invoke service Y&#8221;, means that the test should run completely for each X, that is, the pre-conditions and post-conditions apply to the run for X. So if we have:</p>
</div>
<div class="paragraph">
<p>Test set: a, b, c</p>
</div>
<div class="paragraph">
<p>Test case:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ensure pre-conditions</p>
</li>
<li>
<p>verify post-conditions</p>
</li>
<li>
<p>flow</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>for each X in data set, run service Y</p>
</li>
<li>
<p>verify result</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The run should be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ensure pre-conditions</p>
</li>
<li>
<p>invoke Y(a)</p>
</li>
<li>
<p>verify result</p>
</li>
<li>
<p>verify post-conditions</p>
</li>
<li>
<p>ensure pre-conditions</p>
</li>
<li>
<p>invoke Y(b)</p>
</li>
<li>
<p>verify result</p>
</li>
<li>
<p>verify post-conditions</p>
</li>
<li>
<p>ensure pre-conditions</p>
</li>
<li>
<p>invoke Y(c)</p>
</li>
<li>
<p>verify result</p>
</li>
<li>
<p>verify post-conditions</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_definition_adl14_upload_opt"><a class="anchor" href="#_conformance_point_i_definition_adl14_upload_opt"></a>5.3.2. Conformance Point: I_DEFINITION_ADL14.upload_opt()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_definition_adl14_interface" target="_blank" rel="noopener"><code>I_DEFINITION_ADL14.<em>upload_opt()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_data_set"><a class="anchor" href="#_data_set"></a>5.3.2.1. Data set</h5>
<div class="ulist">
<ul>
<li>
<p>minimal valid OPT (each with one type of entry, cover all entries)</p>
</li>
<li>
<p>minimal valid OPT, two versions</p>
</li>
<li>
<p>maximal valid OPT (all types in the RM)</p>
</li>
<li>
<p>invalid OPT (empty file)</p>
</li>
<li>
<p>invalid OPT (empty <code>template_id</code>)</p>
</li>
<li>
<p>invalid OPT (removed mandatory elements)</p>
</li>
<li>
<p>invalid OPT (added multiple elements that had an upper bound of 1)</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_tc_i_definition_adl14_upload_opt_valid_opt"><a class="anchor" href="#_tc_i_definition_adl14_upload_opt_valid_opt"></a>5.3.2.2. TC I_DEFINITION_ADL14.upload_opt-valid_opt</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>upload valid OPTs</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No OPTs should be loaded on the system.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A new OPT with the given <code>template_id</code> is loaded into the server.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>NOTE: the server should be able to retrieve the template by `template_id` or retrieve if an OPT exists or not by `template_id`.</pre>
</div>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>For each valid OPT in the data set, invoke the OPT upload service</p>
</li>
<li>
<p>The result should be positive, the server accepted the OPT and it is stored as it was uploaded</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_definition_adl14_upload_opt_invalid_opt"><a class="anchor" href="#_tc_i_definition_adl14_upload_opt_invalid_opt"></a>5.3.2.3. TC I_DEFINITION_ADL14.upload_opt-invalid_opt</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>upload invalid OPTs</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No OPTs should be loaded on the system.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No OPTs should be loaded on the system.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>For each invalid OPT in the data set, invoke the OPT upload service</p>
</li>
<li>
<p>The result should be negative, the server rejected the OPT because it was invalid, and would be useful if the result contains where the errors are in the uploaded OPT.</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_definition_adl14_upload_opt_valid_opt_twice_conflict"><a class="anchor" href="#_tc_i_definition_adl14_upload_opt_valid_opt_twice_conflict"></a>5.3.2.4. TC I_DEFINITION_ADL14.upload_opt-valid_opt_twice_conflict</h5>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
since there is no formal versioning mechanism for templates 1.4 (OPT 2 might use the archetype id format for the template id that also includes a version number, but this is not widely used), the OPT upload service needs to handle a version parameter, for instance this is the solution on the <a href="https://specifications.openehr.org/releases/ITS-REST/latest/definitions.html#definitions-adl-1.4-template" target="_blank" rel="noopener">openEHR REST API</a>. If the version information is not available when uploading OPTs, then uploading an OPT with the same <code>template_id</code> twice will make the second upload fail (conflict).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An alternative solution for the version parameter is to add the version number to the other_details of the OPT, or directly into the <code>template_id</code>.</p>
</div>
<div class="paragraph">
<p>See: <a href="https://specifications.openehr.org/jira/browse/SPECBASE-30" target="_blank" rel="noopener">SPECBASE-30</a> and <a href="https://specifications.openehr.org/jira/browse/SPECITS-42" target="_blank" rel="noopener">SPECITS-42</a>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Upload valid OPT twice with conflict</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No OPTs should be loaded on the system.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A new OPT with the given <code>template_id</code> is loaded into the server, and there will be only one OPT loaded.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
the server should be able to retrieve the template by <code>template_id</code>, or retrieve if an OPT exists or not by <code>template_id</code>.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>For each valid OPT in the data set, invoke the OPT upload service</p>
</li>
<li>
<p>The result should be positive (the server accepted the OPT)</p>
</li>
<li>
<p>Invoke the upload service with the same OPT as in 1.</p>
</li>
<li>
<p>The result should be negative (the server rejected the OPT)</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_definition_adl14_upload_opt_valid_opt_twice_no_conflict"><a class="anchor" href="#_tc_i_definition_adl14_upload_opt_valid_opt_twice_no_conflict"></a>5.3.2.5. TC I_DEFINITION_ADL14.upload_opt-valid_opt_twice_no_conflict</h5>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
considering the note on the previous flow, for this flow the version parameter is provided, and both service invocations contain a different version value.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>upload valid OPT twice with conflict</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No OPTs should be loaded on the system.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Two new OPTs with the given <code>template_id</code> and different versions are loaded into the server.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
the server should be able to retrieve the templates by <code>template_id</code> and version, or retrieve if an OPT exists or not by <code>template_id</code> and version. Given only the <code>template_id</code>, the server will return just the latest version.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>For each valid OPT in the data set, invoke the OPT upload service, including the version parameter = 1</p>
</li>
<li>
<p>The result should be positive (the server accepted the OPT)</p>
</li>
<li>
<p>Invoke the upload service with the same OPT as in 1., including the version parameter = 2</p>
</li>
<li>
<p>The result should be positive (the server accepted the OPT)</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_definition_adl14_get_opt"><a class="anchor" href="#_conformance_point_i_definition_adl14_get_opt"></a>5.3.3. Conformance Point: I_DEFINITION_ADL14.get_opt()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_definition_adl14_interface" target="_blank" rel="noopener"><code>I_DEFINITION_ADL14.<em>get_opt()</em></code></a></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
the flows of this test case will include flows from the Upload OPT test case, in order to have something to retrieve.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_data_sets"><a class="anchor" href="#_data_sets"></a>5.3.3.1. Data sets</h5>
<div class="ulist">
<ul>
<li>
<p>minimal valid OPT (covering all entry types)</p>
</li>
<li>
<p>minimal valid OPT, two versions</p>
</li>
<li>
<p>maximal valid OPT (all types in the RM)</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_tc_i_definition_adl14_get_opt_get_single"><a class="anchor" href="#_tc_i_definition_adl14_get_opt_get_single"></a>5.3.3.2. TC I_DEFINITION_ADL14.get_opt-get_single</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>retrieve a single OPT</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>All valid OPTs should be loaded into the system, only the single versioned ones.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None (retrieve should not change the state of the system).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the retrieve OPT service with existing <code>template_ids</code></p>
</li>
<li>
<p>For each <code>template_id</code>, the correct OPT will be returned</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
to check point 2, the retrieved OPT should be exactly the same as the uploaded one.
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_definition_adl14_get_opt_retrieve_fail"><a class="anchor" href="#_tc_i_definition_adl14_get_opt_retrieve_fail"></a>5.3.3.3. TC I_DEFINITION_ADL14.get_opt-retrieve_fail</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>empty server OPT retrieve fail test</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No OPTs should be loaded on the system.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the retrieve OPT service with a random <code>template_id</code></p>
</li>
<li>
<p>The service should return an error related to the non existence of the requested OPT</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_definition_adl14_get_opt_retrieve_latest_version"><a class="anchor" href="#_tc_i_definition_adl14_get_opt_retrieve_latest_version"></a>5.3.3.4. TC I_DEFINITION_ADL14.get_opt-retrieve_latest_version</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>retrieve last version of versioned OPT</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OPTs with more than one version should be loaded.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the retrieve OPT service with existing <code>template_ids</code></p>
</li>
<li>
<p>For each <code>template_id</code>, the correct OPT will be returned, and will be the last version</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
to be sure the last version was returned, a small modification to the OPT could be done.
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_definition_adl14_get_opt_retrieve_specific_version"><a class="anchor" href="#_tc_i_definition_adl14_get_opt_retrieve_specific_version"></a>5.3.3.5. TC I_DEFINITION_ADL14.get_opt-retrieve_specific_version</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>retrieve a specific version (not last) of versioned OPT</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>OPTs with more than one version should be loaded.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the retrieve OPT service with existing <code>template_ids</code> and a version parameter value that is not the last</p>
</li>
<li>
<p>For each <code>template_id</code>, the correct OPT will be returned, and will be the requested version</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
to be sure the last version was returned, a small modification to the OPT could be done.
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_definition_adl14_get_opts"><a class="anchor" href="#_conformance_point_i_definition_adl14_get_opts"></a>5.3.4. Conformance Point: I_DEFINITION_ADL14.get_opts()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_definition_adl14_interface" target="_blank" rel="noopener"><code>I_DEFINITION_ADL14.<em>get_opts()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_data_sets_2"><a class="anchor" href="#_data_sets_2"></a>5.3.4.1. Data sets</h5>
<div class="ulist">
<ul>
<li>
<p>minimal valid OPT (covering each type of entry);</p>
</li>
<li>
<p>minimal valid OPT, two versions;</p>
</li>
<li>
<p>maximal valid OPT (all types in the RM).</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_tc_i_definition_adl14_get_opts_retrieve_all"><a class="anchor" href="#_tc_i_definition_adl14_get_opts_retrieve_all"></a>5.3.4.2. TC I_DEFINITION_ADL14.get_opts-retrieve_all</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>retrieve all loaded OPTs</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>All valid OPTs should be loaded.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the retrieve OPTs service</p>
</li>
<li>
<p>All the loaded OPTs should be returned, if there are versions of any OPTs, only the last version is retrieved</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_definition_adl14_get_opts_retrieve_all_no_opts"><a class="anchor" href="#_tc_i_definition_adl14_get_opts_retrieve_all_no_opts"></a>5.3.4.3. TC I_DEFINITION_ADL14.get_opts-retrieve_all_no_opts</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>retrieve all loaded OPTs when none is loaded</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No OPTs should be loaded on the system.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the retrieve OPTs service</p>
</li>
<li>
<p>The service should return an empty set and should not fail.</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_definition_adl14_delete_opt"><a class="anchor" href="#_conformance_point_i_definition_adl14_delete_opt"></a>5.3.5. Conformance Point: I_DEFINITION_ADL14.delete_opt()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_definition_adl14_interface" target="_blank" rel="noopener"><code>I_DEFINITION_ADL14.<em>delete_opt()</em></code></a></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
the OPT delete can only happen if there is no associated data with the OPT, or if there exists a newer revision (minor version of the same OPT) in the server under test. For all these tests, there is not data committed to the server, so the delete can happen.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Implementation recommendations: the delete could be logical, so the OPT exists in the server but is not available, and there could be a service to retrieve deleted OPTs. Those can be undeleted or physically deleted (this can’t be undone), and only users with admin permissions should be able to physically delete OPTs.</p>
</div>
<div class="sect4">
<h5 id="_data_sets_3"><a class="anchor" href="#_data_sets_3"></a>5.3.5.1. Data sets</h5>
<div class="ulist">
<ul>
<li>
<p>minimal valid OPT</p>
</li>
<li>
<p>minimal valid OPT, two versions</p>
</li>
<li>
<p>maximal valid OPT (all types in the RM)</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_tc_i_definition_adl14_delete_opt_delete_existing"><a class="anchor" href="#_tc_i_definition_adl14_delete_opt_delete_existing"></a>5.3.5.2. TC I_DEFINITION_ADL14.delete_opt-delete_existing</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>delete existing OPTs</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>All valid OPTs should be loaded into the system.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>For each existing <code>template_id</code>, invoke the delete OPT service</p>
</li>
<li>
<p>Verify the OPT is not longer available via the retrieve OPTs service</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
for step 1, exclude versioned OPT, the result should be the same: the OPT is not available.
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_definition_adl14_delete_opt_delete_latest_version"><a class="anchor" href="#_tc_i_definition_adl14_delete_opt_delete_latest_version"></a>5.3.5.3. TC I_DEFINITION_ADL14.delete_opt-delete_latest_version</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>delete last version of a versioned OPT</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No OPTs should be loaded on the system.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Include flow: upload valid OPTs</p>
</li>
<li>
<p>Invoke the delete OPT service for all existing <code>template_ids</code></p>
</li>
<li>
<p>Include flow: retrieve all loaded OPTs when none is loaded</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>NOTE:
* for step 1, include only versioned OPT.
* for versioned OPTs, when no version parameter is present when invoking the delete OPT service, all the versions of the OPT will be deleted.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_definition_adl14_delete_opt_delete_specific_version"><a class="anchor" href="#_tc_i_definition_adl14_delete_opt_delete_specific_version"></a>5.3.5.4. TC I_DEFINITION_ADL14.delete_opt-delete_specific_version</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>delete specific version of a versioned OPT</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No OPTs should be loaded on the system.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Include flow: upload valid OPTs</p>
</li>
<li>
<p>Invoke the delete OPT service for an existing <code>template_id</code> and version of the OPT, version should not be the last</p>
</li>
<li>
<p>Include flow: retrieve all loaded OPTs</p>
</li>
<li>
<p>The OPT set retrieved on step 3 should contain the deleted OPT, since the latest version was not deleted</p>
</li>
<li>
<p>Include flow: delete existing OPTs</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
for step 1, include only versioned OPT.
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_definition_adl14_delete_opt_delete_non_existing"><a class="anchor" href="#_tc_i_definition_adl14_delete_opt_delete_non_existing"></a>5.3.5.5. TC I_DEFINITION_ADL14.delete_opt-delete_non_existing</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>delete a non existing OPT</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No OPTs should be loaded on the system.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Include flow: upload valid OPTs</p>
</li>
<li>
<p>Invoke the delete OPT service with a non existing <code>template_id</code></p>
</li>
<li>
<p>The server will return an error related to the OPT not existing in the server</p>
</li>
<li>
<p>Include flow: delete existing OPTs</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_func_conf_ehr_component"><a class="anchor" href="#_func_conf_ehr_component"></a>6. Functional Conformance: EHR Component</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_normative_reference_2"><a class="anchor" href="#_normative_reference_2"></a>6.1. Normative Reference</h3>
<div class="paragraph">
<p>Items in this validation suite conceptually use the following abstract interfaces from the <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_ehr_package" target="_blank" rel="noopener">Abstract Platform Service Model, EHR component</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>I_EHR_SERVICE</code></p>
</li>
<li>
<p><code>I_EHR</code></p>
</li>
<li>
<p><code>I_EHR_STATUS</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These are concretely realised in implementation technology specfic APIs, such as the <a href="https://specifications.openehr.org/releases/ITS-REST/latest/ehr.html" target="_blank" rel="noopener">EHR REST API</a>.</p>
</div>
<div class="paragraph">
<p>The data that flow through these interfaces are defined by the following information model specifications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/ehr.html" target="_blank" rel="noopener">EHR IM</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/common.html" target="_blank" rel="noopener">Common IM</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/support.html" target="_blank" rel="noopener">Support IM</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_test_environment_2"><a class="anchor" href="#_test_environment_2"></a>6.2. Test Environment</h3>
<div class="paragraph">
<p>The server under test should support:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>at least the OPT 1.4 format, and optionally <a href="https://specifications.openehr.org/releases/AM/latest/OPT2.html" target="_blank" rel="noopener">OPT 2</a>.</p>
</li>
<li>
<p>at least the XML representation of COMPOSITIONs for committing data, which may be validated by the <a href="https://specifications.openehr.org/releases/ITS-XML/latest/components/RM" target="_blank" rel="noopener">openEHR XSDs</a>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_test_data_sets_2"><a class="anchor" href="#_test_data_sets_2"></a>6.3. Test Data Sets</h3>
<div class="paragraph">
<p>These are the data set classes:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>VALID:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>not providing an <code>EHR_STATUS</code> (empty input, the server creates the default structures and data)</p>
</li>
<li>
<p>providing a valid <code>EHR_STATUS</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>INVALID:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>providing invalid <code>EHR_STATUS</code></p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Valid data sets when the <code>EHR_STATUS</code> is provided and internal strucrures are valid (data set class 1.a):</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 18.1818%;">
<col style="width: 18.1818%;">
<col style="width: 18.1818%;">
<col style="width: 18.1818%;">
<col style="width: 18.1819%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">No.</th>
<th class="tableblock halign-left valign-top">is_queryable</th>
<th class="tableblock halign-left valign-top">is_modifiable</th>
<th class="tableblock halign-left valign-top">subject</th>
<th class="tableblock halign-left valign-top">other_details</th>
<th class="tableblock halign-left valign-top">ehr_id</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not provided</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not provided</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not provided</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not provided</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not provided</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not provided</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not provided</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not provided</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">15</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provided</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Any other data set is invalid, for instance providing <code>EHR_STATUS</code> with:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>missing <code><em>is_queryable</em></code>, <code><em>is_modifiable</em></code></p>
</li>
<li>
<p>empty <code><em>is_queryable, `_is_modifiable</em></code></p>
</li>
<li>
<p>missing or empty <code><em>subject_id</em></code></p>
</li>
<li>
<p>invalid <code><em>subject_id</em></code></p>
</li>
<li>
<p>invalid <code><em>other_details</em></code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Notes:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>When the <code><em>ehr_id</em></code> is not present, it is expected that it is assigned by the server.</p>
</li>
<li>
<p>The server should set the <code>EHR.<em>system_id</em></code> value to a known value (defined by the server&#8217;s configuration).</p>
</li>
<li>
<p>The default values that should be assigned by the server for is_modifiable and is_queryable are 'true', and for the subject it defaults to an instance of <code>PARTY_SELF</code>.</p>
</li>
<li>
<p>There are no cases to check if the provided <code>ehr_id`is valid, since in the <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html" target="_blank" rel="noopener">openEHR Platform Service Model</a> the parameters are typed to `UUID</code>, any other format will be an invalid call.</p>
</li>
<li>
<p>The validity of an <code>EHR_STATUS</code> can be checked in its JSON form by validating against the <a href="https://github.com/openEHR/specifications-ITS-JSON/latest/components/RM" target="_blank" rel="noopener">JSON schemas</a>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_test_cases"><a class="anchor" href="#_test_cases"></a>6.4. Test Cases</h3>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_service_has_ehr"><a class="anchor" href="#_conformance_point_i_ehr_service_has_ehr"></a>6.4.1. Conformance point: I_EHR_SERVICE.has_ehr()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_service_interface" target="_blank" rel="noopener"><code>I_EHR_SERVICE.<em>has_ehr()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_ehr_has_ehr_existing_ehr_id"><a class="anchor" href="#_tc_ehr_has_ehr_existing_ehr_id"></a>6.4.1.1. TC EHR.has_ehr-existing_ehr_id</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Check has EHR with existing EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An EHR should exist in the system with a known <code>ehr_id</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke has EHR service with the known <code>ehr_id</code></p>
</li>
<li>
<p>The result should be positive, e.g. <code>"the EHR with &lt;ehr_id&gt; exists"</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_has_ehr_existing_subject_id"><a class="anchor" href="#_tc_ehr_has_ehr_existing_subject_id"></a>6.4.1.2. TC EHR.has_ehr-existing_subject_id</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Check has EHR with existing EHR by <code>subject_id</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An EHR should exist in the system with a known subject_id.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke has EHR service with the known <code>subject_id</code></p>
</li>
<li>
<p>The result should be positive, e.g. <code>"the EHR with &lt;subject_id&gt; exists"</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<code>subject_id</code> refers to the <code>PARTY_REF</code> class instance containing the identifier of a patient represented by <code>PARTY_SELF</code> in the openEHR Reference Model.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_tc_ehr_has_ehr_non_existing_ehr_id"><a class="anchor" href="#_tc_ehr_has_ehr_non_existing_ehr_id"></a>6.4.1.3. TC EHR.has_ehr-non_existing_ehr_id</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Check has EHR with non existing EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The server should be empty (no EHRs, no commits, no OPTs).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke has EHR service with a random <code>ehr_id</code>.</p>
</li>
<li>
<p>The result should be negative, e.g. <code>"the EHR with &lt;ehr_id&gt; does not exist"</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_has_ehr_non_existing_subject_id"><a class="anchor" href="#_tc_ehr_has_ehr_non_existing_subject_id"></a>6.4.1.4. TC EHR.has_ehr-non_existing_subject_id</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Check has EHR with non existing EHR by <code>subject_id</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The server should be empty (no EHRs, no commits, no OPTs).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke has EHR service with a random <code>subject_id</code></p>
</li>
<li>
<p>The result should be negative, e.g. <code>"the EHR for &lt;subject_id&gt; does not exist"</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_service_create_ehr"><a class="anchor" href="#_conformance_point_i_ehr_service_create_ehr"></a>6.4.2. Conformance point: I_EHR_SERVICE.create_ehr()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_service_interface" target="_blank" rel="noopener"><code>I_EHR_SERVICE.<em>create_ehr()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_ehr_create_ehr_main"><a class="anchor" href="#_tc_ehr_create_ehr_main"></a>6.4.2.1. TC EHR.create_ehr-main</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Create new EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The server should be empty (no EHRs, no commits, no OPTs).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A new EHR will exist in the system and be consistent with the data sets used.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the create EHR service</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>for each item in the VALID data set classes</p>
</li>
<li>
<p>when the <code>ehr_id</code> is provided, should be unique for each invocation of the service</p>
</li>
</ol>
</div>
</li>
<li>
<p>The server should answer with a positive response associated to the successful EHR creation</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_create_ehr_same_ehr_twice"><a class="anchor" href="#_tc_ehr_create_ehr_same_ehr_twice"></a>6.4.2.2. TC EHR.create_ehr-same_ehr_twice</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Attempt to create same EHR twice</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The server should be empty (no EHRs, no commits, no OPTs).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A new EHR will exist in the system, the first one created, and be consistent with the data sets used.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the create EHR service</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>for each VALID data set not providing ehr_id</p>
</li>
<li>
<p>for each VALID data set providing ehr_id</p>
</li>
</ol>
</div>
</li>
<li>
<p>The server should answer with a positive response associated to the successful EHR creation</p>
</li>
<li>
<p>Invoke the create EHR service</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>with the same <code>ehr_id</code> of the EHR created in 1.1. (should be read from the response)</p>
</li>
<li>
<p>with the same <code>ehr_id</code> of the EHR created in 1.2. (should be read from the test data sets)</p>
</li>
</ol>
</div>
</li>
<li>
<p>The server should answer with a negative response, related to the existence of an EHR with the provided <code>ehr_id</code>, because <code>ehr_id</code> values should be unique</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_create_ehr_two_ehrs_same_patient"><a class="anchor" href="#_tc_ehr_create_ehr_two_ehrs_same_patient"></a>6.4.2.3. TC EHR.create_ehr-two_ehrs_same_patient</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Create two EHRs for the same patient</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The server should be empty (no EHRs, no commits, no OPTs).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A new EHR will exist in the system.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the create EHR service</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>for each VALID data set with a provided subject and not providing <code>ehr_id</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>The server should answer with a positive response associated to the successful EHR creation</p>
</li>
<li>
<p>Invoke the create EHR service</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>with the same data set used in 1.1</p>
</li>
</ol>
</div>
</li>
<li>
<p>The server should answer with a negative response, related with the EHR already existing for the provided subject</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_service_get_ehr"><a class="anchor" href="#_conformance_point_i_ehr_service_get_ehr"></a>6.4.3. Conformance point: I_EHR_SERVICE.get_ehr()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_service_interface" target="_blank" rel="noopener"><code>I_EHR_SERVICE.<em>get_ehr()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_ehr_get_ehr_existing_ehr_by_ehr_id"><a class="anchor" href="#_tc_ehr_get_ehr_existing_ehr_by_ehr_id"></a>6.4.3.1. TC EHR.get_ehr-existing_ehr_by_ehr_id</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get existing EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An EHR should exist in the system with a known <code>ehr_id</code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke get EHR service with the known <code>ehr_id</code></p>
</li>
<li>
<p>The result should be positive and retrieve the EHR</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_get_ehr_existing_ehr_by_subject_id"><a class="anchor" href="#_tc_ehr_get_ehr_existing_ehr_by_subject_id"></a>6.4.3.2. TC EHR.get_ehr-existing_ehr_by_subject_id</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get existing EHR by <code>subject_id</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An EHR should exist in the system with a known <code>subject_id</code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke get EHR service with the known <code>subject_id</code></p>
</li>
<li>
<p>The result should be positive and retrieve the EHR</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_get_ehr_get_ehr_by_invalid_ehr_id"><a class="anchor" href="#_tc_ehr_get_ehr_get_ehr_by_invalid_ehr_id"></a>6.4.3.3. TC EHR.get_ehr-get_ehr_by_invalid_ehr_id</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get non existing EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The server should be empty (no EHRs, no commits, no OPTs).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke get EHR service by a random <code>ehr_id</code></p>
</li>
<li>
<p>The result should be negative, e.g. <code>"EHR with &lt;ehr_id&gt; does not exist"</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_get_ehr_get_ehr_by_invalid_subject_id"><a class="anchor" href="#_tc_ehr_get_ehr_get_ehr_by_invalid_subject_id"></a>6.4.3.4. TC EHR.get_ehr-get_ehr_by_invalid_subject_id</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get non existing EHR by <code>subject_id</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The server should be empty (no EHRs, no commits, no OPTs).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke get EHR service by a random <code>subject_id</code></p>
</li>
<li>
<p>The result should be negative, e.g. <code>"EHR for &lt;subject_id&gt; does not exist"</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ehr_status_test_cases"><a class="anchor" href="#_ehr_status_test_cases"></a>6.5. EHR_STATUS Test Cases</h3>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_status_get_ehr_status"><a class="anchor" href="#_conformance_point_i_ehr_status_get_ehr_status"></a>6.5.1. Conformance Point: I_EHR_STATUS.get_ehr_status()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_status_interface" target="_blank" rel="noopener"><code>I_EHR_STATUS.<em>get_ehr_status()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_ehr_status_get_ehr_status_get_by_ehr_id"><a class="anchor" href="#_tc_ehr_status_get_ehr_status_get_by_ehr_id"></a>6.5.1.1. TC EHR_STATUS.get_ehr_status-get_by_ehr_id</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get status of an existing EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An EHR with known <code>ehr_id</code> should exist.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get <code>EHR_STATUS</code> service by the existing <code>ehr_id</code></p>
</li>
<li>
<p>The result should be positive and retrieve a correspondent <code>EHR_STATUS</code>.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The <code>EHR_STATUS</code> internal information should match the rules in which the EHR was created (see test flow Create EHR)</p>
</li>
<li>
<p>Those rules should be verified: a. has or not a <code>subject_id</code>, b. has correct value for <code>is_modifiable</code>, c. has correct value for <code>is_queryable</code>.</p>
</li>
</ol>
</div>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_status_get_ehr_status_get_by_invalid_ehr_id"><a class="anchor" href="#_tc_ehr_status_get_ehr_status_get_by_invalid_ehr_id"></a>6.5.1.2. TC EHR_STATUS.get_ehr_status-get_by_invalid_ehr_id</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get status of a non-existing EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The server should be empty (no EHRs, no commits, no OPTs).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get <code>EHR_STATUS</code> service by a random <code>ehr_id</code></p>
</li>
<li>
<p>The result should be negative and the result should include an error e.g. <code>"EHR with &lt;ehr_id&gt; doesn’t exist"</code>.</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_status_set_ehr_queryable"><a class="anchor" href="#_conformance_point_i_ehr_status_set_ehr_queryable"></a>6.5.2. Conformance Point: I_EHR_STATUS.set_ehr_queryable()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_status_interface" target="_blank" rel="noopener"><code>I_EHR_STATUS.<em>set_ehr_queryable()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_ehr_status_set_ehr_queryable_existing_ehr"><a class="anchor" href="#_tc_ehr_status_set_ehr_queryable_existing_ehr"></a>6.5.2.1. TC EHR_STATUS.set_ehr_queryable-existing_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Set EHR queryable of an existing EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An EHR with known <code>ehr_id</code> should exist.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>EHR_STATUS.is_queryable</code>, for the EHR with known <code>ehr_id</code>, should be <code>true</code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>For the existing EHR, invoke the set EHR queryable service</p>
</li>
<li>
<p>The result should be positive and the corresponding <code>EHR_STATUS.is_queryable</code> should be <code>true</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_status_set_ehr_queryable_non_existing_ehr"><a class="anchor" href="#_tc_ehr_status_set_ehr_queryable_non_existing_ehr"></a>6.5.2.2. TC EHR_STATUS.set_ehr_queryable-non_existing_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Set EHR queryable of non existing EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The server should be empty (no EHRs, no commits, no OPTs).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the set EHR queryable service by a random <code>ehr_id</code></p>
</li>
<li>
<p>The result should be negative and the result should include an error e.g. <code>"EHR with &lt;ehr_id&gt; doesn’t exist"</code>.</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_status_set_ehr_modifiable"><a class="anchor" href="#_conformance_point_i_ehr_status_set_ehr_modifiable"></a>6.5.3. Conformance Point: I_EHR_STATUS.set_ehr_modifiable()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_status_interface" target="_blank" rel="noopener"><code>I_EHR_STATUS.<em>set_ehr_modifiable()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_ehr_status_set_ehr_modifiable_existing_ehr"><a class="anchor" href="#_tc_ehr_status_set_ehr_modifiable_existing_ehr"></a>6.5.3.1. TC EHR_STATUS.set_ehr_modifiable-existing_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Set EHR modifiable of an existing EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An EHR with known <code>ehr_id</code> should exist.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>EHR_STATUS.is_modifiable</code>, for the EHR with known <code>ehr_id</code>, should be <code>true</code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>For the existing EHR, invoke the set EHR modifiable service</p>
</li>
<li>
<p>The result should be positive and the corresponding <code>EHR_STATUS.is_modifiable</code> should be <code>true</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_status_set_ehr_modifiable_non_existing_ehr"><a class="anchor" href="#_tc_ehr_status_set_ehr_modifiable_non_existing_ehr"></a>6.5.3.2. TC EHR_STATUS.set_ehr_modifiable-non_existing_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Set EHR modifiable of non-existing EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The server should be empty (no EHRs, no commits, no OPTs).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the set EHR modifiable service by a random <code>ehr_id</code></p>
</li>
<li>
<p>The result should be negative and the result should include an error e.g. <code>"EHR with &lt;ehr_id&gt; doesn’t exist"</code>.</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_status_clear_ehr_queryable"><a class="anchor" href="#_conformance_point_i_ehr_status_clear_ehr_queryable"></a>6.5.4. Conformance Point: I_EHR_STATUS.clear_ehr_queryable()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_status_interface" target="_blank" rel="noopener"><code>I_EHR_STATUS.<em>clear_ehr_queryable()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_ehr_status_clear_ehr_queryable_existing_ehr"><a class="anchor" href="#_tc_ehr_status_clear_ehr_queryable_existing_ehr"></a>6.5.4.1. TC EHR_STATUS.clear_ehr_queryable-existing_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Clear EHR queryable of an existing EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An EHR with known <code>ehr_id</code> should exist.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>EHR_STATUS.is_queryable</code>, for the EHR with known <code>ehr_id</code>, should be <code>false</code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>For the existing EHR, invoke the clear EHR queryable service</p>
</li>
<li>
<p>The result should be positive and the corresponding <code>EHR_STATUS.is_queryable</code> should be <code>false</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_status_clear_ehr_queryable_non_existing_ehr"><a class="anchor" href="#_tc_ehr_status_clear_ehr_queryable_non_existing_ehr"></a>6.5.4.2. TC EHR_STATUS.clear_ehr_queryable-non_existing_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Clear EHR queryable of non-existing EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The server should be empty (no EHRs, no commits, no OPTs).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the clear EHR queryable service by a random <code>ehr_id</code></p>
</li>
<li>
<p>The result should be negative and the result should include an error e.g. <code>"EHR with &lt;ehr_id&gt; doesn’t exist"</code>.</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_status_clear_ehr_modifiable"><a class="anchor" href="#_conformance_point_i_ehr_status_clear_ehr_modifiable"></a>6.5.5. Conformance Point: I_EHR_STATUS.clear_ehr_modifiable()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_status_interface" target="_blank" rel="noopener"><code>I_EHR_STATUS.<em>clear_ehr_modifiable()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_ehr_status_clear_ehr_modifiable_existing_ehr"><a class="anchor" href="#_tc_ehr_status_clear_ehr_modifiable_existing_ehr"></a>6.5.5.1. TC EHR_STATUS.clear_ehr_modifiable-existing_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Clear EHR modifiable of an existing EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An EHR with known <code>ehr_id</code> should exist.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>EHR_STATUS.is_modifiable</code>, for the EHR with known <code>ehr_id</code>, should be <code>false</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>For the existing EHR, invoke the clear EHR modifiable service</p>
</li>
<li>
<p>The result should be positive and the corresponding <code>EHR_STATUS.is_modifiable</code> should be <code>false</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_status_clear_ehr_modifiable_non_existing_ehr"><a class="anchor" href="#_tc_ehr_status_clear_ehr_modifiable_non_existing_ehr"></a>6.5.5.2. TC EHR_STATUS.clear_ehr_modifiable-non_existing_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Clear EHR modifiable of non existing EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The server should be empty (no EHRs, no commits, no OPTs).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the clear EHR modifiable service by a random <code>ehr_id</code></p>
</li>
<li>
<p>The result should be negative and the result should include an error e.g. <code>"EHR with &lt;ehr_id&gt; doesn’t exist"</code>.</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_functional_conformance_ehr_composition_component"><a class="anchor" href="#_functional_conformance_ehr_composition_component"></a>7. Functional Conformance: EHR / COMPOSITION Component</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_normative_reference_3"><a class="anchor" href="#_normative_reference_3"></a>7.1. Normative Reference</h3>
<div class="paragraph">
<p>Items in this validation suite conceptually use the following abstract interfaces from the <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_ehr_package" target="_blank" rel="noopener">Abstract Platform Service Model, EHR/COMPOSITION component</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>I_EHR_COMPOSITION</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These are concretely realised in implementation technology specfic APIs, such as the <a href="https://specifications.openehr.org/releases/ITS-REST/latest/ehr.html" target="_blank" rel="noopener">EHR REST API</a>.</p>
</div>
<div class="paragraph">
<p>The data that flow through these interfaces are defined by the following information model specifications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/ehr.html" target="_blank" rel="noopener">EHR IM</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/common.html" target="_blank" rel="noopener">Common IM</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/data_structures.html" target="_blank" rel="noopener">Data Structures IM</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/data_types.html" target="_blank" rel="noopener">Data Types IM</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/support.html" target="_blank" rel="noopener">Support IM</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/common.html#_change_control_package" target="_blank" rel="noopener">Versioning</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_dependencies"><a class="anchor" href="#_dependencies"></a>7.2. Dependencies</h3>
<div class="paragraph">
<p>This test suite depends on other test suites:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#_func_conf_def_component">Functional Conformance: Definitions Component</a>, providing OPTs;</p>
</li>
<li>
<p><a href="#_func_conf_ehr_component">Functional Conformance: EHR Component</a>, providing EHRs.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_test_environment_3"><a class="anchor" href="#_test_environment_3"></a>7.3. Test Environment</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The server under test should support at least OPTs, 1.4 or 2, but OPT 1.4 if more frequent since modeling tools supporting this were around for a long time. Could also support ADL, 1.4 or 2.</p>
</li>
<li>
<p>The server should support at least one of the XML or JSON representations of COMPOSITIONs for committing data, and integrate the corresponding schemas (XML or JSON) to validate data syntactically (before validating against an OPT).</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_test_cases_2"><a class="anchor" href="#_test_cases_2"></a>7.4. Test Cases</h3>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_composition_has_composition"><a class="anchor" href="#_conformance_point_i_ehr_composition_has_composition"></a>7.4.1. Conformance point: I_EHR_COMPOSITION.has_composition()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_composition_interface" target="_blank" rel="noopener"><code>I_EHR_COMPOSITION.<em>has_composition()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_has_composition"><a class="anchor" href="#_tc_ehr_composition_has_composition"></a>7.4.1.1. TC EHR_COMPOSITION.has_composition</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Has existing <code>COMPOSITION</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR has a <code>CONTRIBUTION</code></p>
</li>
<li>
<p>The <code>CONTRIBUTION</code> contains a <code>VERSION</code> with known uid.</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the has <code>COMPOSITION</code> service for the <code>ehr_id</code> and <code>VERSION.uid</code></p>
</li>
<li>
<p>The result must be TRUE</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_has_composition_bad_composition"><a class="anchor" href="#_tc_ehr_composition_has_composition_bad_composition"></a>7.4.1.2. TC EHR_COMPOSITION.has_composition_bad_composition</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Has <code>COMPOSITION</code>, <code>COMPOSITION</code> doesn’t exist</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR has no <code>CONTRIBUTIONs</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the has <code>COMPOSITION</code> service for <code>ehr_id</code>, and a random <code>VERSION.uid</code></p>
</li>
<li>
<p>The result must be FALSE</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_has_composition_bad_ehr"><a class="anchor" href="#_tc_ehr_composition_has_composition_bad_ehr"></a>7.4.1.3. TC EHR_COMPOSITION.has_composition_bad_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Has <code>COMPOSITION</code> on non-existent EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>There are no EHRs on the server</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the has <code>COMPOSITION</code> service with a random <code>ehr_id</code></p>
</li>
<li>
<p>The service should return an error related to the non existence of the EHR</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_get_composition_latest"><a class="anchor" href="#_get_composition_latest"></a>7.4.2. Get COMPOSITION latest</h4>
<div class="paragraph">
<p><strong>Implementation consideration:</strong></p>
</div>
<div class="paragraph">
<p>When a <code>COMPOSITION</code> is retrieved from a service, it will comply with a specific format. There could be a variant for each test to retrieve the <code>COMPOSITION</code> in any of the supported openEHR formats, and the  syntactic validation of those retrieved formats should be done by using the corresponding schemas (XML, JSON, etc). That would be the minimal validation for conformance testing. Though it would be ideal to have semantic validation of the retrieved <code>COMPOSITIONs</code> to ensure conformance, which is achieved by validating against the corresponding OPT in the testing layer.</p>
</div>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_composition_interface" target="_blank" rel="noopener"><code>I_EHR_COMPOSITION.<em>get_composition_latest()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_get_composition_latest"><a class="anchor" href="#_tc_ehr_composition_get_composition_latest"></a>7.4.2.1. TC EHR_COMPOSITION.get_composition_latest</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get existing <code>COMPOSITION</code> latest</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR has a <code>VERSIONED_COMPOSITION</code> with known uid</p>
</li>
<li>
<p>The <code>VERSIONED_COMPOSITION</code> has two <code>VERSIONs</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get <code>COMPOSITION</code> latest service for the <code>ehr_id</code> and <code>VERSIONED_COMPOSITION</code> uid</p>
</li>
<li>
<p>The result must return the <code>COMPOSITION</code> contents, and should be the latest version</p>
</li>
<li>
<p>The retrieved format should contain all the exact same data as the format used when committing the <code>COMPOSITION</code> (content check)</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_get_composition_latest_bad_composition"><a class="anchor" href="#_tc_ehr_composition_get_composition_latest_bad_composition"></a>7.4.2.2. TC EHR_COMPOSITION.get_composition_latest_bad_composition</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get <code>COMPOSITION</code> latest, <code>COMPOSITION</code> doesn’t exist</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists and has no <code>CONTRIBUTIONs</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get <code>COMPOSITION</code> latest service for ehr_uid, and a random <code>VERSIONED_COMPOSITION</code> uid</p>
</li>
<li>
<p>The result must be empty, with an error &#8220;the COMPOSITION uid doesn’t exist in the EHR ehr_uid&#8221;</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_get_composition_latest_bad_ehr"><a class="anchor" href="#_tc_ehr_composition_get_composition_latest_bad_ehr"></a>7.4.2.3. TC EHR_COMPOSITION.get_composition_latest_bad_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get <code>COMPOSITION</code> latest on non-existent EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>There are no EHRs on the server</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get <code>COMPOSITION</code> latest service with a random ehr_id, and a random <code>VERSIONED_COMPOSITION</code> uid</p>
</li>
<li>
<p>The service should return an error related to the non existence of the EHR</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_get_composition_at_time"><a class="anchor" href="#_get_composition_at_time"></a>7.4.3. Get COMPOSITION at time</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_composition_interface" target="_blank" rel="noopener"><code>I_EHR_COMPOSITION.<em>get_composition_at_time()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_get_composition_at_time"><a class="anchor" href="#_tc_ehr_composition_get_composition_at_time"></a>7.4.3.1. TC EHR_COMPOSITION.get_composition_at_time</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get existing <code>COMPOSITION</code> at time</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR has one or more <code>VERSIONED_COMPOSITIONs</code> with known uids</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get <code>COMPOSITION</code> at time service for the ehr_id, <code>VERSIONED_COMPOSITION.uid</code> and current time</p>
</li>
<li>
<p>The result must return the <code>COMPOSITION</code> contents of the existing <code>COMPOSITION</code> at given time</p>
</li>
<li>
<p>The retrieved format should contain all the exact same data as the format used when committing the <code>COMPOSITION</code> (content check)</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
When requesting a <code>COMPOSITION</code> at time using the current time, the last version of the matching composition, if it exists, should be retrieved.
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_get_composition_at_time_no_time_arg"><a class="anchor" href="#_tc_ehr_composition_get_composition_at_time_no_time_arg"></a>7.4.3.2. TC EHR_COMPOSITION.get_composition_at_time_no_time_arg</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get existing <code>COMPOSITION</code> at time, without a given time</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR has one or more <code>VERSIONED_COMPOSITIONs</code> with known uids</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get <code>COMPOSITION</code> at time service for the <code>ehr_id</code>, <code>VERSIONED_COMPOSITION</code> uid and no time</p>
</li>
<li>
<p>The result must return the <code>COMPOSITION</code> contents of the existing <code>COMPOSITION</code>, and should be the latest <code>VERSION</code> of the <code>COMPOSITION</code></p>
</li>
<li>
<p>The retrieved format should contain all the exact same data as the format used when committing the <code>COMPOSITION</code> (content check)</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Test this using <code>COMPOSITIONs</code> with one version and multiple versions, to be sure the retrieved one is the latest;<br>
      The previous tests for &#8220;get COMPOSITION latest&#8221; could be used to compare results.
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_get_composition_at_time_bad_composition"><a class="anchor" href="#_tc_ehr_composition_get_composition_at_time_bad_composition"></a>7.4.3.3. TC EHR_COMPOSITION.get_composition_at_time_bad_composition</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get <code>COMPOSITION</code> at time, <code>COMPOSITION</code> doesn’t exist</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists and has no <code>CONTRIBUTIONs</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get <code>COMPOSITION</code> at time service for <code>ehr_uid</code>, and a random <code>VERSIONED_COMPOSITION.uid</code> and current time</p>
</li>
<li>
<p>The result must be empty, with an error related to &#8220;the COMPOSITION uid doesn’t exist in the EHR ehr_uid&#8221;</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_get_composition_at_time_bad_ehr"><a class="anchor" href="#_tc_ehr_composition_get_composition_at_time_bad_ehr"></a>7.4.3.4. TC EHR_COMPOSITION.get_composition_at_time_bad_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get <code>COMPOSITION</code> at time on non-existent EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>There are no EHRs on the server</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get <code>COMPOSITION</code> at time service with a random ehr_id, random <code>VERSIONED_OBJECT.uid</code> and current time</p>
</li>
<li>
<p>The service should return an error indicating non-existence of the EHR</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_get_composition_at_times"><a class="anchor" href="#_tc_ehr_composition_get_composition_at_times"></a>7.4.3.5. TC EHR_COMPOSITION.get_composition_at_times</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get existing <code>COMPOSITION</code> at time, cover different times</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR should have one <code>VERSIONED_COMPOSITION</code> with a know uid</p>
</li>
<li>
<p>The <code>VERSIONED_COMPOSITION</code> should have two VERSIONs (the EHR has two <code>CONTRIBUTIONs</code> for the same <code>COMPOSITION</code>)</p>
</li>
<li>
<p><code>CONTRIBUTIONs</code> were done at times t0 and t1 with t0 &lt; t1</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get <code>COMPOSITION</code> at time service for the ehr_id, <code>VERSIONED_COMPOSITION</code> uid and a time &lt; t0</p>
</li>
<li>
<p>The result must be negative and return an error related to the <code>COMPOSITION</code> not existing at that time</p>
</li>
<li>
<p>Invoke the get <code>COMPOSITION</code> at time service for the ehr_id, <code>VERSIONED_COMPOSITION</code> uid and a time &gt; t0 and &lt; t1</p>
</li>
<li>
<p>The result must return the <code>COMPOSITION</code> contents of the <code>COMPOSITION</code> committed in t0</p>
</li>
<li>
<p>The retrieved format should contain all the exact same data as the format used when committing the <code>COMPOSITION</code> (content check)</p>
</li>
<li>
<p>Invoke the get <code>COMPOSITION</code> at time service for the ehr_id, <code>VERSIONED_COMPOSITION</code> uid and a time &gt; t1</p>
</li>
<li>
<p>The result must return the <code>COMPOSITION</code> contents of the <code>COMPOSITION</code> committed in t1</p>
</li>
<li>
<p>The retrieved format should contain all the exact same data as the format used when committing the <code>COMPOSITION</code> (content check)</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_get_composition_at_version"><a class="anchor" href="#_get_composition_at_version"></a>7.4.4. Get COMPOSITION at version</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_composition_interface" target="_blank" rel="noopener"><code>I_EHR_COMPOSITION.<em>get_composition_version()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_get_composition_version"><a class="anchor" href="#_tc_ehr_composition_get_composition_version"></a>7.4.4.1. TC EHR_COMPOSITION.get_composition_version</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get existing <code>COMPOSITION</code> at version</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR has one <code>VERSION</code> with known version id</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get <code>COMPOSITION</code> at version service for the ehr_id, <code>VERSION</code> version id</p>
</li>
<li>
<p>The result must return the <code>COMPOSITION</code> contents of the existing <code>VERSION</code></p>
</li>
<li>
<p>The retrieved format should contain all the exact same data as the format used when committing the <code>COMPOSITION</code> (content check)</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_get_composition_version_bad_version"><a class="anchor" href="#_tc_ehr_composition_get_composition_version_bad_version"></a>7.4.4.2. TC EHR_COMPOSITION.get_composition_version_bad_version</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get <code>COMPOSITION</code> at version, <code>VERSION</code> doesn’t exist</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists and doesn’t have any commits</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get <code>COMPOSITION</code> at version service for the <code>ehr_id</code>, and a random version id</p>
</li>
<li>
<p>The result must be negative and return an error related to the non-existent <code>COMPOSITION</code> with the version id</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_get_composition_version_bad_ehr"><a class="anchor" href="#_tc_ehr_composition_get_composition_version_bad_ehr"></a>7.4.4.3. TC EHR_COMPOSITION.get_composition_version_bad_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get <code>COMPOSITION</code> at version, EHR doesn’t exist</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The system doesn’t have any EHRs</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get <code>COMPOSITION</code> at version service a random <code>ehr_id</code> and random version id</p>
</li>
<li>
<p>The result must be negative and return an error related to the non-existent EHR.</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_get_composition_versions"><a class="anchor" href="#_tc_ehr_composition_get_composition_versions"></a>7.4.4.4. TC EHR_COMPOSITION.get_composition_versions</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get <code>COMPOSITION</code> at version, cover different versions</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR should have one <code>VERSIONED_COMPOSITION</code> with a known uid</p>
</li>
<li>
<p>The <code>VERSIONED_COMPOSITION</code> should have two <code>VERSIONs</code> (the EHR has two <code>CONTRIBUTIONs</code> for the same <code>COMPOSITION</code>)</p>
</li>
<li>
<p>Both <code>VERSIONs</code> have ids: v1 and v2</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get <code>COMPOSITION</code> at version service, for the <code>ehr_id</code> and <code>VERSION</code> version id v1</p>
</li>
<li>
<p>The result must be positive and retrieve the <code>COMPOSITION</code>, that should match the <code>COMPOSITION</code> created with version id v1. (content check).</p>
</li>
<li>
<p>Invoke the get <code>COMPOSITION</code> at version service, for the <code>ehr_id</code> and <code>VERSION</code> version id v2</p>
</li>
<li>
<p>The result must be positive and retrieve the <code>COMPOSITION</code>, that should match the <code>COMPOSITION</code> created with version id v2 (content check).</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_get_versioned_composition"><a class="anchor" href="#_get_versioned_composition"></a>7.4.5. Get VERSIONED COMPOSITION</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_composition_interface" target="_blank" rel="noopener"><code>I_EHR_COMPOSITION.<em>get_versioned_composition()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_get_versioned_composition"><a class="anchor" href="#_tc_ehr_composition_get_versioned_composition"></a>7.4.5.1. TC EHR_COMPOSITION.get_versioned_composition</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get existing <code>VERSIONED_COMPOSITION</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR has one <code>VERSIONED_COMPOSITION</code> with known uid</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get <code>VERSIONED_COMPOSITION</code> service for the <code>ehr_id</code> and <code>VERSIONED_COMPOSITION</code> uid</p>
</li>
<li>
<p>The result must return a valid <code>VERSIONED_COMPOSITION</code> object, referencing the <code>VERSION</code> it contains</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Notes:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To consider different cases, try with <code>VERSIONED_COMPOSITION</code> that contain just one <code>VERSION</code> or many <code>VERSIONs</code></p>
</li>
<li>
<p>For that, the valid test cases for Create <code>COMPOSITION</code> could be used to comply with the preconditions of this test flow</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_get_non_existent_versioned_composition"><a class="anchor" href="#_tc_ehr_composition_get_non_existent_versioned_composition"></a>7.4.5.2. TC EHR_COMPOSITION.get_non_existent_versioned_composition</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get non-existent <code>VERSIONED_COMPOSITION</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR doesn’t have any commits</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get <code>VERSIONED_COMPOSITION</code> service for the <code>ehr_id</code> and a random <code>VERSIONED_COMPOSITION</code> uid</p>
</li>
<li>
<p>The result must be negative and return an error related to the non-existence of the <code>VERSIONED_COMPOSITION</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_get_versioned_composition_bad_ehr"><a class="anchor" href="#_tc_ehr_composition_get_versioned_composition_bad_ehr"></a>7.4.5.3. TC EHR_COMPOSITION.get_versioned_composition_bad_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get <code>VERSIONED_COMPOSITION</code>, EHR doesn’t exist</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The system doesn’t have any EHRs</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get <code>VERSIONED_COMPOSITION</code> service for a random <code>ehr_id</code> and a random <code>VERSIONED_COMPOSITION</code> uid</p>
</li>
<li>
<p>The result must be negative and return an error related to the non-existence of the EHR</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_create_composition"><a class="anchor" href="#_create_composition"></a>7.4.6. Create COMPOSITION</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_composition_interface" target="_blank" rel="noopener"><code>I_EHR_COMPOSITION.<em>create_composition()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_create_event_composition"><a class="anchor" href="#_tc_ehr_composition_create_event_composition"></a>7.4.6.1. TC EHR_COMPOSITION.create_event_composition</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Create new event <code>COMPOSITION</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The OPT, associated with the event <code>COMPOSITION</code> that will be created, should exist on the server</p>
</li>
<li>
<p>An EHR with known <code>ehr_id</code> should exist</p>
</li>
<li>
<p>The EHR should have no commits</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A new event <code>COMPOSITION</code> exists in the EHR.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the create <code>COMPOSITION</code> service with a valid event <code>COMPOSITION</code>, compliant with the existing OPT, and with the known <code>ehr_id</code></p>
</li>
<li>
<p>The result should be positive, return information about the new <code>COMPOSITION</code> added to the EHR, and the version number should be 1</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_create_persistent_composition"><a class="anchor" href="#_tc_ehr_composition_create_persistent_composition"></a>7.4.6.2. TC EHR_COMPOSITION.create_persistent_composition</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Create new persistent <code>COMPOSITION</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The OPT, associated with the persistent <code>COMPOSITION</code> that will be created, should exist on the server</p>
</li>
<li>
<p>An EHR with known <code>ehr_id</code> should exist</p>
</li>
<li>
<p>The EHR should have no commits</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A new persistent <code>COMPOSITION</code> exists in the EHR.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the create <code>COMPOSITION</code> service with a valid persistent <code>COMPOSITION</code>, compliant with the existing OPT, and the known <code>ehr_id</code></p>
</li>
<li>
<p>The result should be positive, and return information about the new <code>COMPOSITION</code> added to the EHR, and the version number should be 1</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_create_persistent_composition_same_opt_twice"><a class="anchor" href="#_tc_ehr_composition_create_persistent_composition_same_opt_twice"></a>7.4.6.3. TC EHR_COMPOSITION.create_persistent_composition_same_opt_twice</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Create persistent <code>COMPOSITION</code> for the same OPT twice</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The OPT, associated with the persistent <code>COMPOSITION</code> that will be created, should exist on the server</p>
</li>
<li>
<p>An EHR with known <code>ehr_id</code> should exist</p>
</li>
<li>
<p>The EHR should have no commits</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A new persistent <code>COMPOSITION</code> exists in the EHR.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the create <code>COMPOSITION</code> service with a valid persistent <code>COMPOSITION</code>, compliant with the existing OPT, and with the known <code>ehr_id</code></p>
</li>
<li>
<p>The result should be positive, and return information about the new <code>COMPOSITION</code> added to the EHR, and the version number should be 1</p>
</li>
<li>
<p>Invoke the create <code>COMPOSITION</code> service with a valid persistent <code>COMPOSITION</code> and the same <code>ehr_id</code> as in 1., the <code>COMPOSITION</code> should comply with the same persistent OPT as the <code>COMPOSITION</code> in 1</p>
</li>
<li>
<p>The result should be negative, returning an error related to trying to create a persistent <code>COMPOSITION</code> for the same persistent OPT that already has a first version</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Notes:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Current criteria is: only one &#8216;create&#8217; operation is allowed for persistent <code>COMPOSITIONs</code>, the next operations over an existing persistent <code>COMPOSITION</code> should be &#8216;modifications&#8217;.</p>
</li>
<li>
<p>This is under debate in the openEHR SEC since some implementations permit 'persistent' <code>COMPOSIITONS</code> to have more than one instance in the same EHR and some others not. This is due to the lack of information in the openEHR specifications. There is also a discussion to define other types of categories for <code>COMPOSITIONs</code> to allow different behaviors.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Ref:  <a href="https://discourse.openehr.org/t/specrm-89-support-for-episodic-category/51/3" class="bare">https://discourse.openehr.org/t/specrm-89-support-for-episodic-category/51/3</a></p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_create_invalid_event_composition"><a class="anchor" href="#_tc_ehr_composition_create_invalid_event_composition"></a>7.4.6.4. TC EHR_COMPOSITION.create_invalid_event_composition</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Create new invalid event <code>COMPOSITION</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The OPT, associated with the event <code>COMPOSITION</code> that will be created, should exist on the server</p>
</li>
<li>
<p>An EHR with known <code>ehr_id</code> should exist</p>
</li>
<li>
<p>The EHR should have no commits</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the create <code>COMPOSITION</code> service with an invalid event <code>COMPOSITION</code> and the known <code>ehr_id</code></p>
</li>
<li>
<p>The result should be negative, and return information about the errors in the provided <code>COMPOSITION</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_create_invalid_persistent_composition"><a class="anchor" href="#_tc_ehr_composition_create_invalid_persistent_composition"></a>7.4.6.5. TC EHR_COMPOSITION.create_invalid_persistent_composition</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Create new invalid persistent <code>COMPOSITION</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The OPT, associated with the persistent <code>COMPOSITION</code> that will be created, should exist on the server</p>
</li>
<li>
<p>An EHR with known <code>ehr_id</code> should exist</p>
</li>
<li>
<p>The EHR should have no commits</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the create <code>COMPOSITION</code> service with an invalid persistent <code>COMPOSITION</code> and the known <code>ehr_id</code></p>
</li>
<li>
<p>The result should be negative, and return information about the errors in the provided <code>COMPOSITION</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_create_event_composition_bad_opt"><a class="anchor" href="#_tc_ehr_composition_create_event_composition_bad_opt"></a>7.4.6.6. TC EHR_COMPOSITION.create_event_composition_bad_opt</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Create new event <code>COMPOSITION</code>, referenced OPT doesn’t exist</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The OPT, referenced by the <code>COMPOSITION</code> to commit, doesn’t exist on the server</p>
</li>
<li>
<p>An EHR with known <code>ehr_id</code> should exist</p>
</li>
<li>
<p>The EHR should have no commits</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the create <code>COMPOSITION</code> service with a valid event <code>COMPOSITION</code> and the known <code>ehr_id</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The <code>COMPOSITION</code> should reference an OPT that doesn’t exist on the server</p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be negative, and return information about the non-existent OPT</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_create_event_composition_bad_ehr"><a class="anchor" href="#_tc_ehr_composition_create_event_composition_bad_ehr"></a>7.4.6.7. TC EHR_COMPOSITION.create_event_composition_bad_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Create new event <code>COMPOSITION</code>, EHR doesn’t exist</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The OPT, referenced by the <code>COMPOSITION</code> to commit, exists on the server</p>
</li>
<li>
<p>The server doesn’t have any EHRs</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the create <code>COMPOSITION</code> service with a valid event <code>COMPOSITION</code> and a random <code>ehr_id</code></p>
</li>
<li>
<p>The result should be negative, and return information about the non-existent EHR</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_update_composition"><a class="anchor" href="#_update_composition"></a>7.4.7. Update COMPOSITION</h4>
<div class="paragraph">
<p>The update <code>COMPOSITION</code> service needs the <code>VERSION.preceding_version_uid</code> attribute to be set, so the server knows which existing <code>VERSION</code> of the <code>COMPOSITION</code> will be associated with the newly committed <code>COMPOSITION</code>. The Service Model spec is not clear about where that attribute is defined. By taking into account the Reference Model, the <code>COMPOSITION</code> doesn’t contain that value but the <code>VERSION</code> does. For the <code>COMPOSITION</code> update service the <code>preceding_version_uid</code> should be a parameter or the definition in the SM should mention this.</p>
</div>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_composition_interface" target="_blank" rel="noopener"><code>I_EHR_COMPOSITION.<em>update_composition()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_update_event_composition"><a class="anchor" href="#_tc_ehr_composition_update_event_composition"></a>7.4.7.1. TC EHR_COMPOSITION.update_event_composition</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Update an existing event <code>COMPOSITION</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The OPT referenced by the <code>COMPOSITIONs</code> to commit exists on the server</p>
</li>
<li>
<p>An EHR with known <code>ehr_id</code> should exist</p>
</li>
<li>
<p>The EHR should have no commits</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>A new <code>VERSIONED_OBJECT</code> exists on the server</p>
</li>
<li>
<p>The <code>VERSIONED_OBJECT</code> has two <code>VERSIONs</code> of <code>COMPOSITION</code></p>
</li>
<li>
<p>One <code>VERSION.commit_audit.change_type</code> is <code>CREATE</code>, the other one is <code>MODIFY</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the create <code>COMPOSITION</code> service with a valid event <code>COMPOSITION</code> and the existing <code>ehr_id</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The <code>COMPOSITION</code> reference the existing OPT</p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be positive and a new <code>COMPOSITION</code> should exist in the EHR</p>
</li>
<li>
<p>Invoke the update <code>COMPOSITION</code> service with a valid event <code>COMPOSITION</code> to the existing <code>ehr_id</code> and <code>preceding_version_uid</code> should be the version uid from the <code>COMPOSITION</code> created in 1</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>This <code>COMPOSITION</code> has the same OPT as the <code>COMPOSITION</code> created in 1</p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be positive and a new version of the existing <code>COMPOSITION</code> should exist in the EHR</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_update_persistent_composition"><a class="anchor" href="#_tc_ehr_composition_update_persistent_composition"></a>7.4.7.2. TC EHR_COMPOSITION.update_persistent_composition</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Update an existing persistent <code>COMPOSITION</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The OPT referenced by the <code>COMPOSITIONs</code> to commit exists on the server</p>
</li>
<li>
<p>An EHR with known <code>ehr_id</code> should exist</p>
</li>
<li>
<p>The EHR should have no commits</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The server should contain one <code>VERSIONED_OBJECT</code></p>
</li>
<li>
<p>The <code>VERSIONED_OBJECT</code> should have two <code>VERSIONs</code> of <code>COMPOSITION</code></p>
</li>
<li>
<p>The <code>COMPOSITIONs</code> should comply with the existing OPT</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the create <code>COMPOSITION</code> service with a valid persistent <code>COMPOSITION</code> and the existing <code>ehr_id</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The OPT referenced by this <code>COMPOSITION</code> exists on the server</p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be positive and a new <code>COMPOSITION</code> should exist in the EHR</p>
</li>
<li>
<p>Invoke the update <code>COMPOSITION</code> service with a valid persistent <code>COMPOSITION</code>, to the existing <code>ehr_id</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>that has the same template as the <code>COMPOSITION</code> created in 1.,</p>
</li>
<li>
<p><code>preceding_version_uid</code> should be the <code>VERSION.uid</code> from the <code>COMPOSITION</code> created in 1</p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be positive and a new version of the existing <code>COMPOSITION</code> should exist in the EHR</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_update_non_existent_composition"><a class="anchor" href="#_tc_ehr_composition_update_non_existent_composition"></a>7.4.7.3. TC EHR_COMPOSITION.update_non_existent_composition</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Update a non-existing <code>COMPOSITION</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The OPT referenced by the <code>COMPOSITIONs</code> to commit exists on the server</p>
</li>
<li>
<p>An EHR with known <code>ehr_id</code> should exist</p>
</li>
<li>
<p>The EHR should have no commits</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the update <code>COMPOSITION</code> service with a valid event <code>COMPOSITION</code>, the existing <code>ehr_id</code> and                                           <code>preceding_version_uid</code> should be a random value</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The <code>COMPOSITION</code> should comply with the existing OPT</p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be negative and return an error related to the non-existence of the <code>preceding_version_id</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_update_composition_wrong_template"><a class="anchor" href="#_tc_ehr_composition_update_composition_wrong_template"></a>7.4.7.4. TC EHR_COMPOSITION.update_composition_wrong_template</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Update an existing <code>COMPOSITION</code>, referencing a different template</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The OPTs, referenced by the <code>COMPOSITIONs</code> to commit, exist on the server</p>
</li>
<li>
<p>An EHR with known <code>ehr_id</code> should exist</p>
</li>
<li>
<p>The EHR should have no commits</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The server has a new <code>VERSIONED_OBJECT</code></p>
</li>
<li>
<p>The <code>VERSIONED_OBJECT</code> has one version of a <code>COMPOSITION</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the create <code>COMPOSITION</code> service with a valid event <code>COMPOSITION</code> and the existing <code>ehr_id</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The OPT referenced by this <code>COMPOSITION</code> exists on the server</p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be positive and a new <code>COMPOSITION</code> should exist in the EHR</p>
</li>
<li>
<p>Invoke the update <code>COMPOSITION</code> service with a valid event <code>COMPOSITION</code>, to the existing <code>ehr_id</code> and <code>preceding_version_uid</code> should be the version uid from the <code>COMPOSITION</code> created in 1</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The <code>COMPOSITION</code> references a different template than the one referenced by the <code>COMPOSITION</code> created in 1.</p>
</li>
<li>
<p>The OPT referenced by this <code>COMPOSITION</code> exists on the server</p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be negative and return an error related to the <code>template_id</code> mismatch</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_delete_composition"><a class="anchor" href="#_delete_composition"></a>7.4.8. Delete COMPOSITION</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_composition_interface" target="_blank" rel="noopener"><code>I_EHR_COMPOSITION.<em>delete_composition()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_delete_event_composition"><a class="anchor" href="#_tc_ehr_composition_delete_event_composition"></a>7.4.8.1. TC EHR_COMPOSITION.delete_event_composition</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Delete event <code>COMPOSITION</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The OPT referenced by the <code>COMPOSITIONs</code> to commit exists on the server</p>
</li>
<li>
<p>An EHR with known <code>ehr_id</code> should exist</p>
</li>
<li>
<p>The EHR should have no commits</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The server has one <code>VERSIONED_OBJECT</code></p>
</li>
<li>
<p>The <code>VERSIONED_OBJECT</code> contains two versions of <code>COMPOSITION</code></p>
</li>
<li>
<p>The second <code>VERSION.lifecycle_state</code> value is the code `openehr::523</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">deleted</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>`</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the create <code>COMPOSITION</code> service with a valid event <code>COMPOSITION</code> and the existing <code>ehr_id</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The <code>COMPOSITION</code> complies with the existing OPT</p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be positive and a new <code>COMPOSITION</code> should exist in the EHR</p>
</li>
<li>
<p>Invoke the delete <code>COMPOSITION</code> service with the existing <code>ehr_id</code> and <code>preceding_version_uid</code> should be the version id of the <code>COMPOSITION</code> created in 1</p>
</li>
<li>
<p>The result should be positive, and the <code>COMPOSITION</code> should be deleted</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The common implementation of the <code>delete</code> operation is two create a new <code>VERSION</code> of the <code>COMPOSITION</code> that has <code>VERSION.commit_audit.change_type = openehr::523|deleted|</code>, and <code>VERSION.lifecycle_state = openehr::523|deleted|</code>. So the <code>delete</code> operation is not a physical delete but a logical delete. Some implementations might add the option of a physical deleted. This test case considers the <code>postcondition</code> to be a logical delete, which behaves like an <code>update</code> operation in which a new <code>VERSION</code> of an existing <code>COMPOSITION</code> is created.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_delete_persistent_composition"><a class="anchor" href="#_tc_ehr_composition_delete_persistent_composition"></a>7.4.8.2. TC EHR_COMPOSITION.delete_persistent_composition</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Delete persistent <code>COMPOSITION</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The OPT referenced by the <code>COMPOSITIONs</code> to commit exists on the server</p>
</li>
<li>
<p>An EHR with known <code>ehr_id</code> should exist</p>
</li>
<li>
<p>The EHR should have no commits</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The server has one <code>VERSIONED_OBJECT</code></p>
</li>
<li>
<p>The <code>VERSIONED_OBJECT</code> contains two versions of <code>COMPOSITION</code></p>
</li>
<li>
<p>The second <code>VERSION.lifecycle_state</code> value is the code `openehr::523</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">deleted</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>`</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the create <code>COMPOSITION</code> service with a valid persistent <code>COMPOSITION</code> and the existing <code>ehr_id</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The <code>COMPOSITION</code> complies with the existing OPT</p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be positive and a new <code>COMPOSITION</code> should exist in the EHR</p>
</li>
<li>
<p>Invoke the delete <code>COMPOSITION</code> service with the existing <code>ehr_id</code> and <code>preceding_version_uid</code> should be the version id of the <code>COMPOSITION</code> created in 1</p>
</li>
<li>
<p>The result should be positive, and the <code>COMPOSITION</code> should be deleted</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_ehr_composition_delete_non_existent_composition"><a class="anchor" href="#_tc_ehr_composition_delete_non_existent_composition"></a>7.4.8.3. TC EHR_COMPOSITION.delete_non_existent_composition</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Delete persistent <code>COMPOSITION</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The OPT referenced by the <code>COMPOSITIONs</code> to commit exists on the server</p>
</li>
<li>
<p>An EHR with known <code>ehr_id</code> should exist</p>
</li>
<li>
<p>The EHR should have no commits</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the delete <code>COMPOSITION</code> service with the existing <code>ehr_id</code> and a random <code>preceding_version_uid</code></p>
</li>
<li>
<p>The result should be negative and return an error related to the non-existent <code>COMPOSITION</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_functional_conformance_ehr_contribution_component"><a class="anchor" href="#_functional_conformance_ehr_contribution_component"></a>8. Functional Conformance: EHR / CONTRIBUTION Component</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_normative_reference_4"><a class="anchor" href="#_normative_reference_4"></a>8.1. Normative Reference</h3>
<div class="paragraph">
<p>Items under this validation suite conceptually use these abstract interfaces from the <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_contribution_interface" target="_blank" rel="noopener">Abstract Platform Service Model, EHR/EHR_CONTRIBUTION component</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_dependencies_2"><a class="anchor" href="#_dependencies_2"></a>8.2. Dependencies</h3>
<div class="paragraph">
<p>This test suite depends on other test suites:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#_func_conf_def_component">Functional Conformance: Definitions Component</a>, providing OPTs;</p>
</li>
<li>
<p><a href="#_func_conf_ehr_component">Functional Conformance: EHR Component</a>, providing EHRs.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_test_environment_4"><a class="anchor" href="#_test_environment_4"></a>8.3. Test Environment</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The server under test should support at least OPTs, 1.4 or 2, but OPT 1.4 if more frequent since modeling tools supporting this were around for a long time. Could also support ADL, 1.4 or 2.</p>
</li>
<li>
<p>The server should support at least one of the XML or JSON representations of <code>CONTRIBUTIONs</code> for committing data, and integrate the corresponding schemas (XML or JSON) to validate data syntactically (before validating against an OPT).</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_test_data_sets_3"><a class="anchor" href="#_test_data_sets_3"></a>8.4. Test Data Sets</h3>
<div class="sect3">
<h4 id="_general_contribution_commit_data_sets"><a class="anchor" href="#_general_contribution_commit_data_sets"></a>8.4.1. General CONTRIBUTION Commit Data Sets</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>CONTRIBUTIONs</code> with single valid <code>VERSION&lt;COMPOSITION&gt;</code> (minimal, one for each entry type)</p>
</li>
<li>
<p><code>CONTRIBUTIONs</code> with multiple valid <code>VERSION&lt;COMPOSITION&gt;</code> (reuse the minimal ^)</p>
</li>
<li>
<p><code>CONTRIBUTION</code> with single valid <code>VERSION&lt;COMPOSITION&gt;</code> with maximal data sets</p>
</li>
<li>
<p>Empty <code>CONTRIBUTION</code> (no <code>VERSIONs</code>)</p>
</li>
<li>
<p><code>CONTRIBUTIONs</code> with invalid <code>VERSION&lt;COMPOSITION&gt;</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Invalid data</p>
</li>
<li>
<p>Wrong <code>change_type</code></p>
</li>
<li>
<p>Wrong <code>lifecycle</code></p>
</li>
</ol>
</div>
</li>
<li>
<p><code>CONTRIBUTIONs</code> with multiple <code>VERSION&lt;COMPOSITION&gt;</code>, with mixed valid and invalid ones</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
these cases do not consider which RM type is contained in the <code>VERSIONs</code>, it could be <code>COMPOSITION</code>, <code>FOLDER</code>, <code>EHR_STATUS</code>, etc.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_composition_contribution_commit_data_sets"><a class="anchor" href="#_composition_contribution_commit_data_sets"></a>8.4.2. COMPOSITION CONTRIBUTION Commit Data Sets</h4>
<div class="paragraph">
<p>Since there are many combinations of data that could be used for testing the Commit <code>CONTRIBUTION</code> service, we decided to create three main kinds of <code>CONTRIBUTIONs</code> that should be tested:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Valid</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>minimal <code>COMPOSITIONs</code> with one type of ENTRY (one <code>ENTRY</code> each, all <code>ENTRYs</code> covered)</p>
</li>
<li>
<p>maximal <code>COMPOSITION</code> (all data types, all <code>ENTRY</code> types, and <code>SECTIONs</code>)</p>
</li>
<li>
<p>a persistent <code>COMPOSITION</code> (e.g. problem list, medication list, immunization list, …)</p>
</li>
<li>
<p>time series <code>COMPOSITION</code> (observation with many events, e.g. CPR compressions intervals)</p>
</li>
<li>
<p><code>COMPOSITION</code> with alternative types (e.g. lab result <code>DV_COUNT</code>, <code>DV_QUANTITY</code> and <code>DV_CODED_TEXT</code>)</p>
</li>
<li>
<p><code>COMPOSITION</code> with <code>DV_CODED_TEXT</code> instance on nodes declared as <code>DV_TEXT</code> in the OPT</p>
</li>
<li>
<p><code>COMPOSITION</code> with empty <code>ELEMENT.value</code> and not empty <code>ELEMENT.null_flavour</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>Invalid</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Invalid <code>COMPOSITIONs</code> (e.g. mandatory items not present, wrong types, extra items not declared in OPT, invalid values)</p>
</li>
<li>
<p>Referenced OPT not loaded (this has to do more with the state of the system than to invalid data)</p>
</li>
</ol>
</div>
</li>
<li>
<p>Change type combinations (these are the minimal required, all supported change types can be found in the <a href="https://github.com/openEHR/terminology/blob/master/openEHR_RM/en/openehr_terminology.xml#L26-L34" target="_blank" rel="noopener"> openEHR Terminology</a>)</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>VERSION.commit_audit.change_type = creation</code></p>
</li>
<li>
<p><code>VERSION.commit_audit.change_type = modification</code></p>
</li>
<li>
<p><code>VERSION.commit_audit.change_type = delete</code></p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
there could be many combinations of flows to use the different Change Types mentioned above. The minimal required by this specification it that the server is capable of this flow: 1. creation 2. modification (one or many times) 3. deleted
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_data_set_considerations"><a class="anchor" href="#_data_set_considerations"></a>8.4.2.1. Data Set Considerations</h5>
<div class="paragraph">
<p><strong>change_type</strong></p>
</div>
<div class="paragraph">
<p>Each <code>VERSION</code> in a <code>CONTRIBUTION</code> has an <code>AUDIT_DETAILS</code> which contains a <code>change_type</code> attribute. The value on that attribute determines the internal behavior for processing each <code>VERSION</code>, and each <code>VERSION</code> in the same <code>CONTRIBUTION</code> could have a different <code>change_type</code>. The most used change types are:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>creation</strong>: the <code>VERSION</code> represents the first version of a <code>COMPOSITION</code>.</p>
</li>
<li>
<p><strong>amendment</strong>: the <code>VERSION</code> represents a new version of an existing <code>COMPOSITION</code>, with the purpose of adding data.</p>
</li>
<li>
<p><strong>modification</strong>: the <code>VERSION</code> represents a new version of an existing <code>COMPOSITION</code>, with the purpose of changing data, maybe to fix an error.</p>
</li>
<li>
<p><strong>deleted</strong>:the <code>VERSION</code> represents a new version of an existing <code>COMPOSITION</code>, with the purpose of deleting it.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Internally, amendment and modification might be processed in the exact same way, because the difference is semantic not functional.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/openEHR/terminology/blob/master/openEHR_RM/en/openehr_terminology.xml#L26" target="_blank" rel="noopener">Here is a full list</a>.</p>
</div>
<div class="paragraph">
<p><strong>lifecycle_state</strong></p>
</div>
<div class="paragraph">
<p>Each <code>VERSION</code> in a <code>CONTRIBUTION</code> contains an <code>lifecycle_state</code> attribute, which value gives semantics about the contents of the <code>VERSION</code>. The values could be:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>incomplete</strong>: the <code>COMPOSITION</code> was committed incomplete and should be completed (reviewed, validated, amended) later.</p>
</li>
<li>
<p><strong>complete</strong>: the <code>COMPOSITION</code> was complete at the moment it was committed.</p>
</li>
<li>
<p><strong>deleted</strong>: the <code>COMPOSITION</code> was committed for deletion.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>These codes are defined in the <a href="https://github.com/openEHR/terminology/blob/master/openEHR_RM/en/openehr_terminology.xml" target="_blank" rel="noopener">openEHR Terminology</a>.</p>
</div>
<div class="paragraph">
<p><span class="image">lifecycle state machine</span></p>
</div>
</div>
<div class="sect4">
<h5 id="_combinations_of_data_sets"><a class="anchor" href="#_combinations_of_data_sets"></a>8.4.2.2. Combinations of data sets</h5>
<div class="paragraph">
<p>These combinations can be tested by doing a single commit. The same combinations with flows of multiple commits could lead to different results.</p>
</div>
<div class="paragraph">
<p><strong>One commit (no previous commits were done), single version cases:</strong></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
All change types but creation should fail on the first commit, since other change types need a previous commit. Last one could fail because the first commit can’t be <code>change_type = deleted</code> or because the <code>lifecycle_state = |complete|</code> can’t be with <code>change_type = deleted</code>.
</td>
</tr>
</table>
</div>
<table id="one_commit" class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 17%;">
<col style="width: 20%;">
<col style="width: 25%;">
<col style="width: 27%;">
<col style="width: 11%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">change_type</th>
<th class="tableblock halign-center valign-top">lifecycle_state*</th>
<th class="tableblock halign-center valign-top">composition category</th>
<th class="tableblock halign-center valign-top">composition validity**</th>
<th class="tableblock halign-center valign-top">expected</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">creation</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">complete</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">event</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">valid</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">accepted</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">amendment</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">complete</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">event</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">valid</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">rejected</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">modification</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">complete</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">event</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">valid</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">rejected</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">deleted</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">complete</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">event</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">valid</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">rejected</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">creation</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">complete</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">persistent</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">valid</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">accepted</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">amendment</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">complete</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">persistent</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">valid</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">rejected</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">modification</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">complete</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">persistent</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">valid</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">rejected</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">deleted</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">complete</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">persistent</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">valid</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">rejected</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">creation</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">deleted</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">event</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">valid</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">rejected</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">amendment</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">deleted</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">event</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">valid</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">rejected</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">modification</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">deleted</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">event</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">valid</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">rejected</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">deleted</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">deleted</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">event</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">valid</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">rejected</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
the incomplete cases should be equal to the complete, because the flag is just adding semantics about the content, not setting how the content should be processed.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
the invalid cases will make the accepted cases on the previous table to be rejected because the content in the <code>COMPOSITION</code> is not
valid.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>One commit (no previous commits were done), multiple versions cases:</strong></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
the tables below represent one <code>VERSION</code> in the committed <code>CONTRIBUTION</code>.
</td>
</tr>
</table>
</div>
<div class="olist upperalpha">
<ol class="upperalpha">
<li>
<p>Creating two valid, complete event <code>COMPOSITIONs</code> in one commit should be accepted.</p>
</li>
</ol>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">change_type+</th>
<th class="tableblock halign-center valign-top">lifecycle_state++</th>
<th class="tableblock halign-center valign-top">composition category</th>
<th class="tableblock halign-center valign-top">composition validity</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">creation</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">complete</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">event</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">valid</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">creation</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">complete</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">event</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">valid</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This <code>CONTRIBUTION</code> should be accepted.</p>
</div>
<div class="olist upperalpha">
<ol class="upperalpha">
<li>
<p>Creating two valid, complete persistent <code>COMPOSITIONs</code> in one commit should be accepted.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
depending on the server implementation, some servers might not accept the second <code>COMPOSITION</code> if both <code>COMPOSITIONs</code> reference the same persistent OPT. So this test case considers both <code>COMPOSITIONs</code> reference different persistent OPTs.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">change_type+</th>
<th class="tableblock halign-center valign-top">lifecycle_state++</th>
<th class="tableblock halign-center valign-top">composition category</th>
<th class="tableblock halign-center valign-top">composition validity</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">creation</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">complete</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">persistent</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">valid</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">creation</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">complete</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">persistent</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">valid</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This <code>CONTRIBUTION</code> should be accepted.</p>
</div>
<div class="olist upperalpha">
<ol class="upperalpha">
<li>
<p>Creating two valid, complete and mixed category <code>COMPOSITIONs</code> in one commit should be accepted.</p>
</li>
</ol>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">change_type+</th>
<th class="tableblock halign-center valign-top">lifecycle_state++</th>
<th class="tableblock halign-center valign-top">composition category</th>
<th class="tableblock halign-center valign-top">composition validity</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">creation</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">complete</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">event</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">valid</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">creation</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">complete</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">persistent</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">valid</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This <code>CONTRIBUTION</code> should be accepted.</p>
</div>
<div class="olist upperalpha">
<ol class="upperalpha">
<li>
<p>If any <code>COMPOSITION</code> is invalid in a <code>CONTRIBUTION</code>, the whole commit should fail. It doesn’t matter if it is complete or incomplete, event or persistent (just showing some of the combinations below).</p>
</li>
</ol>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">change_type+</th>
<th class="tableblock halign-center valign-top">lifecycle_state++</th>
<th class="tableblock halign-center valign-top">composition category</th>
<th class="tableblock halign-center valign-top">composition validity</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">creation</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">complete</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">event</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">valid</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">creation</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">complete</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">event</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">invalid</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">change_type+</th>
<th class="tableblock halign-center valign-top">lifecycle_state++</th>
<th class="tableblock halign-center valign-top">composition category</th>
<th class="tableblock halign-center valign-top">composition validity</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">creation</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">complete</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">persistent</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">valid</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">creation</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">complete</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">persistent</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">invalid</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">change_type+</th>
<th class="tableblock halign-center valign-top">lifecycle_state++</th>
<th class="tableblock halign-center valign-top">composition category</th>
<th class="tableblock halign-center valign-top">composition validity</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">creation</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">complete</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">event</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">valid</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">creation</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">complete</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">persistent</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">invalid</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">change_type+</th>
<th class="tableblock halign-center valign-top">lifecycle_state++</th>
<th class="tableblock halign-center valign-top">composition category</th>
<th class="tableblock halign-center valign-top">composition validity</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">creation</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">complete</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">event</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">invalid</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">creation</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">complete</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">persistent</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">valid</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>These <code>CONTRIBUTIONs</code> should be <mark>REJECTED</mark>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
(+) for other change types than creation, the first commit will be rejected, so not included in the table those cases but should be tested.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
(++) the incomplete cases should be equal to the complete, because the flag is just adding semantics about the content, not setting how the content should be processed.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ehr_status_contribution_commit_data_sets"><a class="anchor" href="#_ehr_status_contribution_commit_data_sets"></a>8.4.3. EHR_STATUS CONTRIBUTION Commit Data Sets</h4>
<div class="sect4">
<h5 id="_combinations_for_data_sets"><a class="anchor" href="#_combinations_for_data_sets"></a>8.4.3.1. Combinations for data sets</h5>
<div class="paragraph">
<p>The following accepted and rejected apply under any of these scenarios:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The server has an EHR with the default <code>EHR_STATUS</code> (the EHR was created without providing an <code>EHR_STATUS</code>).</p>
</li>
<li>
<p>The server has an EHR created by providing an <code>EHR_STATUS</code>.</p>
</li>
<li>
<p>The server has an EHR with modifications already done to its <code>EHR_STATUS</code> (consecutive modifications).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Reject Cases:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>CONTRIBUTIONs</code> with <code>VERSION</code>, where <code>VERSION.commit_audit.change_type</code> IN [<code>creation</code>, <code>deleted</code>] should be rejected, because the default <code>EHR_STATUS</code> was already created in the EHR, and the <code>EHR_STATUS</code> can’t be deleted once created.</p>
</li>
<li>
<p><code>CONTRIBUTIONs</code> with <code>VERSION</code>, where <code>VERSION.lifecycle_state</code> = <code>incomplete</code> should be rejected, because the <code>incomplete</code> state doesn’t apply to <code>EHR_STATUS</code>. Though there is an open issue related to this: <a href="https://specifications.openehr.org/jira/browse/SPECPR-368" class="bare">https://specifications.openehr.org/jira/browse/SPECPR-368</a></p>
</li>
<li>
<p>Any other case with an <code>invalid</code> <code>EHR_STATUS</code> in <code>VERSION</code> should also be rejected.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Accepted Cases:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>CONTRIBUTIONs</code> with <code>VERSION</code> where <code>VERSION.commit_audit.change_type</code> IN [<code>modification</code>, <code>amendment</code>] and <code>valid</code> <code>EHR_STATUS</code>, should be accepted. This inscludes the following combinations for <code>EHR_STATUS</code>:</p>
</li>
</ol>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">is_modifiable</th>
<th class="tableblock halign-center valign-top">is_queryable</th>
<th class="tableblock halign-center valign-top">subject.external_ref</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">HIER_OBJECT_ID</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">GENERIC_ID</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">NULL</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">HIER_OBJECT_ID</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">GENERIC_ID</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">NULL</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">HIER_OBJECT_ID</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">GENERIC_ID</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">NULL</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">HIER_OBJECT_ID</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">GENERIC_ID</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">NULL</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">HIER_OBJECT_ID</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">GENERIC_ID</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">NULL</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Since <code>EHR_STATUS</code> is <code>LOCATABLE</code>, is should have an <code>archetype_id</code> assigned. It is recommended to test the combination described above, combined with different values for <code>EHR_STATUS.archetype_id</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_folder_contribution_commit_data_sets"><a class="anchor" href="#_folder_contribution_commit_data_sets"></a>8.4.4. FOLDER CONTRIBUTION Commit Data Sets</h4>
<div class="paragraph">
<p>All the datasets are specified at the <code>EHR.directory</code> level, since that is the current level of operation of the openEHR REST API for <code>FOLDERs</code> to create, update or delete.</p>
</div>
<div class="sect4">
<h5 id="_data_set_combinations"><a class="anchor" href="#_data_set_combinations"></a>8.4.4.1. Data Set Combinations</h5>
<div class="paragraph">
<p><code>Valid</code> payload should include these cases:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>minimal directory</p>
</li>
<li>
<p>directory with items</p>
</li>
<li>
<p>directry with subfolders</p>
</li>
<li>
<p>directory with items and subfolders</p>
</li>
<li>
<p>directory with items and subfolders with items</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Sample structure of <code>FOLDERs</code> with items:</p>
</div>
<div class="paragraph">
<p><span class="image">Folders with items</span></p>
</div>
<div class="paragraph">
<p>Table of data combinations:</p>
</div>
<table id="folder_commit" class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">change_type</th>
<th class="tableblock halign-center valign-top">lifecycle_state</th>
<th class="tableblock halign-center valign-top">payload</th>
<th class="tableblock halign-center valign-top">expected</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">creation</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">complete / incomplete</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">valid</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">accepted</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">amendment / modification</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">complete / incomplete</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">valid</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">accepted</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">deleted</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">deleted</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">valid</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">accepted</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Any <code>invalid</code> payload should be rejected.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_test_cases_3"><a class="anchor" href="#_test_cases_3"></a>8.5. Test Cases</h3>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_contribution_commit_contribution"><a class="anchor" href="#_conformance_point_i_ehr_contribution_commit_contribution"></a>8.5.1. Conformance point: I_EHR_CONTRIBUTION.commit_contribution()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_contribution_interface" target="_blank" rel="noopener"><code>I_EHR_CONTRIBUTION.<em>commit_contribution()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_commit_contribution_valid_composition"><a class="anchor" href="#_tc_i_ehr_contribution_commit_contribution_valid_composition"></a>8.5.1.1. TC I_EHR_CONTRIBUTION.commit_contribution-valid_composition</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Successfully commit <code>CONTRIBUTION</code> of <code>COMPOSITION</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>OPTs for each valid cases are loaded on the server</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The EHR with <code>ehr_id</code> should have a new <code>CONTRIBUTION</code></p>
</li>
<li>
<p>The ID(s) of the created <code>VERSION(s)</code> are correct</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>the version ID matches the <code>change_type</code> executed (creation = 1, modification/amendment = 2, 3, …)</p>
</li>
<li>
<p>ID(s) can be used to retrieve a <code>VERSION&lt;COMPOSITION&gt;</code>)</p>
</li>
</ol>
</div>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke commit <code>CONTRIBUTION</code> service with the existing <code>ehr_id</code> and valid data sets</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The <code>COMPOSITIONs</code> reference existing OPTs on the server</p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be positive and retrieve the id of the <code>CONTRIBUTION</code> just created</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_commit_contribution_invalid_composition"><a class="anchor" href="#_tc_i_ehr_contribution_commit_contribution_invalid_composition"></a>8.5.1.2. TC I_EHR_CONTRIBUTION.commit_contribution-invalid_composition</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Commit <code>CONTRIBUTION</code> with invalid <code>COMPOSITION</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>OPTs for each valid cases are loaded on the server</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke commit <code>CONTRIBUTION</code> service with an existing <code>ehr_id</code> and the invalid <code>VERSION&lt;COMPOSITION&gt;</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The <code>COMPOSITIONs</code> reference existing OPTs on the server</p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be negative and provide info about the errors with the data committed</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_commit_contribution_empty"><a class="anchor" href="#_tc_i_ehr_contribution_commit_contribution_empty"></a>8.5.1.3. TC I_EHR_CONTRIBUTION.commit_contribution-empty</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Commit <code>CONTRIBUTION</code> with no content.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke commit <code>CONTRIBUTION</code> service with an existing <code>ehr_id</code> and no data in the <code>CONTRIBUTION</code></p>
</li>
<li>
<p>The result should be negative and retrieve an error indicating the empty list of <code>VERSION&lt;COMPOSITION&gt;</code> in the <code>CONTRIBUTION</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_commit_contribution_valid_invalid_compositions"><a class="anchor" href="#_tc_i_ehr_contribution_commit_contribution_valid_invalid_compositions"></a>8.5.1.4. TC I_EHR_CONTRIBUTION.commit_contribution-valid_invalid_compositions</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Commit <code>CONTRIBUTION</code> with mixed valid and invalid <code>COMPOSITIONs</code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>OPTs for each valid cases are loaded on the server</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke commit <code>CONTRIBUTION</code> service with an existing <code>ehr_id</code> and multiple <code>VERSION&lt;COMPOSITION&gt;</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Some <code>VERSIONs</code> are valid, some aree invalid</p>
</li>
<li>
<p>The <code>COMPOSITIONs</code> reference existing OPTs on the server</p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be negative and retrieve an error related invalid <code>VERSION&lt;COMPOSITION&gt;</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
the whole commit should behave like a transaction and fail, no <code>CONTRIBUTIONs</code> or <code>VERSIONs</code> should be created on the server.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_commit_contribution_event_composition"><a class="anchor" href="#_tc_i_ehr_contribution_commit_contribution_event_composition"></a>8.5.1.5. TC I_EHR_CONTRIBUTION.commit_contribution-event_composition</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Commit <code>CONTRIBUTION</code> with event <code>COMPOSITION</code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>OPTs for each valid cases are loaded on the server</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>There should be two <code>VERSIONs</code> of the same <code>COMPOSITION</code> in the EHR with <code>ehr_id</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke commit <code>CONTRIBUTION</code> service with an existing <code>ehr_id</code> and a valid <code>VERSION&lt;COMPOSITION&gt;</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The <code>COMPOSITION</code> has category = event</p>
</li>
<li>
<p>The <code>COMPOSITION</code> reference existing an OPT on the server</p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be positive, returning the created <code>CONTRIBUTION</code> with the ID of the created <code>VERSION&lt;COMPOSITION&gt;</code></p>
</li>
<li>
<p>Invoke commit <code>CONTRIBUTION</code> service with an existing <code>ehr_id</code> and a valid <code>VERSION&lt;COMPOSITION&gt;</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The <code>COMPOSITION</code> should have the same <code>template_id</code> as the one used in 1.</p>
</li>
<li>
<p>The <code>VERSION</code> change_type = modification and <code>preceding_version_uid</code> = version id returned in 2.</p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be positive and the returned version id should reflect it’s a new version of an existing <code>COMPOSITION</code> created in 1. (has the same <code>OBJECT_VERSION_ID</code> with version number = 2)</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_commit_contribution_persistent_composition"><a class="anchor" href="#_tc_i_ehr_contribution_commit_contribution_persistent_composition"></a>8.5.1.6. TC I_EHR_CONTRIBUTION.commit_contribution-persistent_composition</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Commit <code>CONTRIBUTION</code> with persistent <code>COMPOSITIONs</code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>OPTs for each valid case are loaded on the server</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>There should be two <code>VERSIONs</code> of the same <code>COMPOSITION</code> in the EHR with <code>ehr_id</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke commit <code>CONTRIBUTION</code> service with an existing <code>ehr_id</code> and a valid <code>VERSION&lt;COMPOSITION&gt;</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The <code>COMPOSITION.category</code> = persistent</p>
</li>
<li>
<p>The <code>COMPOSITION</code> references an existing OPT on the server</p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be positive, returning the version id for the created <code>VERSION</code></p>
</li>
<li>
<p>Invoke commit <code>CONTRIBUTION</code> service with an existing <code>ehr_id</code> and a valid <code>VERSION&lt;COMPOSITION&gt;</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The <code>COMPOSITION</code> should have the same <code>template_id</code> as the one used in 1.</p>
</li>
<li>
<p>The <code>VERSION.change_type</code> = modification</p>
</li>
<li>
<p>The <code>VERSION.preceding_version_uid</code> = version id returned in 2.,</p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be positive and the returned version id should reflect it is a new version of an existing     <code>COMPOSITION</code> created in 1. (has the same <code>OBJECT_VERSION_ID</code> with version number = 2)</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_commit_contribution_delete_composition"><a class="anchor" href="#_tc_i_ehr_contribution_commit_contribution_delete_composition"></a>8.5.1.7. TC I_EHR_CONTRIBUTION.commit_contribution-delete_composition</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Commit <code>CONTRIBUTION</code> deleting a <code>COMPOSITION</code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>OPTs for each valid case are loaded on the server</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Two <code>VERSIONs</code> of the same <code>COMPOSITION</code> should exist in the EHR with ehr_id</p>
</li>
<li>
<p>The <code>VERSIONED_OBJECT</code> should be logically deleted
NOTE: the effect of a <code>VERSIONED_OBJECT</code> being deleted might vary in different implementations. This needs further specification at the <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html" target="_blank" rel="noopener">openEHR Service Model</a></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke commit <code>CONTRIBUTION</code> service with an existing <code>ehr_id</code> and a valid <code>VERSION&lt;COMPOSITION&gt;</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The <code>COMPOSITION</code> references an existing OPT on the server</p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be positive, returning the version id for the created <code>VERSION</code></p>
</li>
<li>
<p>Invoke commit <code>CONTRIBUTION</code> service with an existing <code>ehr_id</code> and a valid <code>VERSION&lt;COMPOSITION&gt;</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The <code>COMPOSITION</code> should reference the same <code>template_id</code> as the one used in 1.</p>
</li>
<li>
<p>The <code>VERSION.change_type = deleted</code></p>
</li>
<li>
<p>The <code>VERSION.preceding_version_uid</code> = version id returned in 2.</p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be positive and the returned version id should reflect it is a new version of an existing <code>COMPOSITION</code> created in 1. (has the same <code>OBJECT_VERSION_ID</code> with version number = 2, which should be deleted)</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_commit_contribution_two_commits_second_invalid"><a class="anchor" href="#_tc_i_ehr_contribution_commit_contribution_two_commits_second_invalid"></a>8.5.1.8. TC I_EHR_CONTRIBUTION.commit_contribution-two_commits_second_invalid</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Commit two <code>CONTRIBUTIONa</code> on same <code>COMPOSITION</code> with second containing invalid content.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>OPTs for each valid case are loaded on the server</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>There will be just one <code>VERSION</code> in the EHR with <code>ehr_id</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke commit <code>CONTRIBUTION</code> service with an existing <code>ehr_id</code> and a valid <code>VERSION&lt;COMPOSITION&gt;</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The <code>COMPOSITION</code> references an existing OPT on the server</p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be positive, returning the version id for the created VERSION</p>
</li>
<li>
<p>Invoke commit <code>CONTRIBUTION</code> service with an existing <code>ehr_id</code> and a valid <code>VERSION&lt;COMPOSITION&gt;</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The <code>COMPOSITION</code> references the same <code>template_id</code> as the one used in 1.</p>
</li>
<li>
<p>The <code>VERSION</code> has change_type = modification</p>
</li>
<li>
<p>The <code>VERSION</code> has preceding_version_uid = version id returned in 2.</p>
</li>
<li>
<p>The <code>COMPOSITION</code> is one of the invalid data sets</p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be negative, and retrieve some info about the errors found on the data committed</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_commit_contribution_two_commits_second_creation"><a class="anchor" href="#_tc_i_ehr_contribution_commit_contribution_two_commits_second_creation"></a>8.5.1.9. TC I_EHR_CONTRIBUTION.commit_contribution-two_commits_second_creation</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Commit two <code>CONTRIBUTIONa</code> on same <code>COMPOSITION</code> with second having change_type = creation</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>OPTs for each valid case are loaded on the server</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>There will be just one <code>VERSION</code> in the EHR with <code>ehr_id</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke commit <code>CONTRIBUTION</code> service with an existing <code>ehr_id</code> and a valid <code>VERSION&lt;COMPOSITION&gt;</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The <code>COMPOSITION</code> references an existing OPT on the server</p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be positive, returning the version id for the created <code>VERSION</code></p>
</li>
<li>
<p>Invoke commit <code>CONTRIBUTION</code> service with an existing <code>ehr_id</code> and a valid <code>VERSION&lt;COMPOSITION&gt;</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The <code>COMPOSITION</code> references the same <code>template_id</code> as the one used in 1.</p>
</li>
<li>
<p>The <code>VERSION.change_type</code> = creation</p>
</li>
<li>
<p>The <code>VERSION.preceding_version_uid</code> = version id returned in 2.</p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be negative, and retrieve some info about the wrong change type (see notes)</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Validity criterion: only one 'create' operation is allowed for persistent <code>COMPOSITIONs</code>, the next operations over an existing persistent <code>COMPOSITION</code> should be modification.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_commit_contribution_non_exiting_opt"><a class="anchor" href="#_tc_i_ehr_contribution_commit_contribution_non_exiting_opt"></a>8.5.1.10. TC I_EHR_CONTRIBUTION.commit_contribution-non_exiting_opt</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Commit <code>CONTRIBUTION</code> with <code>COMPOSITION</code> referencing a non existing OPT</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>There are no OPTs loaded on the server</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke commit <code>CONTRIBUTION</code> service with an existing <code>ehr_id</code> and a valid <code>VERSION&lt;COMPOSITION&gt;</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The <code>COMPOSITION</code> references a random OPT <code>template_id</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be negative and retrieve an error indicating the missing OPT</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_commit_contribution_minimal_ehr_status"><a class="anchor" href="#_tc_i_ehr_contribution_commit_contribution_minimal_ehr_status"></a>8.5.1.11. TC I_EHR_CONTRIBUTION.commit_contribution-minimal_ehr_status</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Commit <code>CONTRIBUTION</code> containing minimal <code>EHR_STATUS</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR contains a default <code>EHR_STATUS</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The EHR should have a new <code>CONTRIBUTION</code></p>
</li>
<li>
<p>The EHR should have a new <code>VERSION</code> for the <code>EHR_STATUS</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke commit <code>CONTRIBUTION</code> service with an existing <code>ehr_id</code> and the valid data sets (see section B.3.)</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>For <code>EHR_STATUS</code> <code>CONTRIBUTIONs</code>, the <code>change_type</code> is always <code>modification</code> or <code>amendment</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be positive and retrieve the id of the <code>CONTRIBUTION</code> just created</p>
</li>
<li>
<p>Verify expected <code>CONTRIBUTION</code> uids and <code>CONTRIBUTION</code> count for the EHR with <code>ehr_id</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_commit_contribution_full_ehr_status"><a class="anchor" href="#_tc_i_ehr_contribution_commit_contribution_full_ehr_status"></a>8.5.1.12. TC I_EHR_CONTRIBUTION.commit_contribution-full_ehr_status</h5>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
this case is the same as previous but the precondition 2. is different.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Commit <code>CONTRIBUTION</code> containing full <code>EHR_STATUS</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR contains a full <code>EHR_STATUS</code> (all the optional information is set, i.e. <code>subject.external_ref</code> etc)</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The EHR should have a new <code>CONTRIBUTION</code></p>
</li>
<li>
<p>The EHR should have a new <code>VERSION</code> for the <code>EHR_STATUS</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke commit <code>CONTRIBUTION</code> service with an existing <code>ehr_id</code> and the valid data sets (see above)</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Use <code>change_type</code> = <code>modification</code> or <code>amendment</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be positive and retrieve the id of the <code>CONTRIBUTION</code> just created</p>
</li>
<li>
<p>Verify expected <code>CONTRIBUTION</code> uids and <code>CONTRIBUTION</code> count for the EHR with <code>ehr_id</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_commit_contribution_ehr_status_invalid_change_type"><a class="anchor" href="#_tc_i_ehr_contribution_commit_contribution_ehr_status_invalid_change_type"></a>8.5.1.13. TC I_EHR_CONTRIBUTION.commit_contribution-ehr_status_invalid_change_type</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Commit <code>CONTRIBUTION</code> containing <code>EHR_STATUS</code> with invalid change type</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR has the default <code>EHR_STATUS</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke commit <code>CONTRIBUTION</code> service with an existing <code>ehr_id</code> and the valid data sets (see above)</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Use <code>change_type = create</code> and <code>delete</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be negative and retrieve an error indicating the <code>EHR_STATUS</code> already existing for the EHR</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_commit_contribution_invalid_ehr_status"><a class="anchor" href="#_tc_i_ehr_contribution_commit_contribution_invalid_ehr_status"></a>8.5.1.14. TC I_EHR_CONTRIBUTION.commit_contribution-invalid_ehr_status</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Commit <code>CONTRIBUTION</code> containing invalid <code>EHR_STATUS</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR has the default <code>EHR_STATUS</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke commit <code>CONTRIBUTION</code> service with an existing <code>ehr_id</code> and the invalid data sets (see above)</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Use <code>change_type</code> = <code>modification</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be negative and retrieve an error indicating the invalid <code>EHR_STATUS</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_commit_contribution_valid_directory"><a class="anchor" href="#_tc_i_ehr_contribution_commit_contribution_valid_directory"></a>8.5.1.15. TC I_EHR_CONTRIBUTION.commit_contribution-valid_directory</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Commit <code>CONTRIBUTION</code> containing valid <code>FOLDER</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR doesn’t have a <code>directory</code> (root <code>FOLDER</code>)</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The EHR with <code>ehr_id</code> should have a new <code>CONTRIBUTION</code> and a <code>directory</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke commit <code>CONTRIBUTION</code> service with an existing <code>ehr_id</code> and the valid data sets (see above) and <code>change_type</code> =                       <code>creation</code></p>
</li>
<li>
<p>The result should be positive and retrieve the id of the <code>CONTRIBUTION</code> just created</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_commit_contribution_fail_create_existing_directory"><a class="anchor" href="#_tc_i_ehr_contribution_commit_contribution_fail_create_existing_directory"></a>8.5.1.16. TC I_EHR_CONTRIBUTION.commit_contribution-fail_create_existing_directory</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Commit <code>CONTRIBUTION</code> attempting to create an EHR directory that already exists</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR has a <code>directory</code> (root <code>FOLDER</code>)</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke commit <code>CONTRIBUTION</code> service with an existing <code>ehr_id</code> and the valid data sets (see above) and change_type =                       <code>creation</code></p>
</li>
<li>
<p>The result should be negative, and retrieve an error indicating the wrong <code>change_type</code> because the root <code>FOLDER</code> already exists</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_commit_contribution_fail_modify_non_existing_directory"><a class="anchor" href="#_tc_i_ehr_contribution_commit_contribution_fail_modify_non_existing_directory"></a>8.5.1.17. TC I_EHR_CONTRIBUTION.commit_contribution-fail_modify_non_existing_directory</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Commit <code>CONTRIBUTION</code> attempting to modify an EHR directory that doesn&#8217;t exist</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR has no <code>directory</code> (root <code>FOLDER</code>)</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke commit <code>CONTRIBUTION</code> service with an existing <code>ehr_id</code> and the valid data sets</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Use change_type = <code>modification</code></p>
</li>
<li>
<p>Use a random <code>preceding_version_uid</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>The result should be negative since, and retrieve an error indicating the wrong <code>change_type</code>, because it’s trying to modify something that doesn’t exist</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_commit_contribution_update_existing_directory"><a class="anchor" href="#_tc_i_ehr_contribution_commit_contribution_update_existing_directory"></a>8.5.1.18. TC I_EHR_CONTRIBUTION.commit_contribution-update_existing_directory</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Commit <code>CONTRIBUTION</code> updating an EHR directory</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR has a <code>directory</code> (root <code>FOLDER</code>)</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The EHR should have a new <code>CONTRIBUTION</code> and a new <code>VERSION</code> for the root <code>FOLDER</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke commit <code>CONTRIBUTION</code> service with an existing <code>ehr_id</code> and the valid data sets with <code>change_type</code> =                                   <code>modification</code> or <code>amendment</code></p>
</li>
<li>
<p>The result should be positive and retrieve the id of the <code>CONTRIBUTION</code> just created</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_contribution_list_contributions"><a class="anchor" href="#_conformance_point_i_ehr_contribution_list_contributions"></a>8.5.2. Conformance point: I_EHR_CONTRIBUTION.list_contributions()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_contribution_interface" target="_blank" rel="noopener"><code>I_EHR_CONTRIBUTION.<em>list_contributions()</em></code></a></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<code>CONTRIBUTIONs</code> can contain <code>COMPOSITION</code>, <code>EHR_STATUS</code> or <code>FOLDER</code>, or any mix of those. Each flow below applies to a specific type, except when 'ANY' is mentioned, in which case the flow applies to any of those three types.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_list_contributions_post_commit"><a class="anchor" href="#_tc_i_ehr_contribution_list_contributions_post_commit"></a>8.5.2.1. TC I_EHR_CONTRIBUTION.list_contributions-post_commit</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>List <code>CONTRIBUTIONs</code> following successful commit</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR as a <code>CONTRIBUTION</code> with known uid</p>
</li>
<li>
<p>The <code>CONTRIBUTION</code> contains a <code>VERSION&lt;COMPOSITION&gt;</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The EHR should have a new <code>CONTRIBUTION</code> and a new <code>VERSION</code> for the root <code>FOLDER</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke list <code>CONTRIBUTIONs</code> service with the existing <code>ehr_id</code></p>
</li>
<li>
<p>The result should be positive and retrieve a list of <code>CONTRIBUTIONs</code> with one item</p>
</li>
<li>
<p>The <code>CONTRIBUTION</code> should contain a <code>VERSION&lt;COMPOSITION&gt;</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_list_contributions_post_commit_2"><a class="anchor" href="#_tc_i_ehr_contribution_list_contributions_post_commit_2"></a>8.5.2.2. TC I_EHR_CONTRIBUTION.list_contributions-post_commit</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>List <code>CONTRIBUTIONs</code> following successful commit</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> should exist</p>
</li>
<li>
<p>The EHR has no <code>CONTRIBUTIONs</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke get <code>CONTRIBUTIONs</code> service by the existing <code>ehr_id</code></p>
</li>
<li>
<p>The result should be positive and retrieve an empty list</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_list_contributions_non_existing_ehr"><a class="anchor" href="#_tc_i_ehr_contribution_list_contributions_non_existing_ehr"></a>8.5.2.3. TC I_EHR_CONTRIBUTION.list_contributions-non_existing_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>List <code>CONTRIBUTIONs</code> of non-existing EHR (ANY)</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>There are no EHRs on the server</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke list <code>CONTRIBUTIONs</code> service with a random <code>ehr_id</code></p>
</li>
<li>
<p>The result should be negative and retrieve an error indicating <code>"EHR with `ehr_id</code> doesn’t exist"`</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_list_contributions_ehr_containing_ehr_status"><a class="anchor" href="#_tc_i_ehr_contribution_list_contributions_ehr_containing_ehr_status"></a>8.5.2.4. TC I_EHR_CONTRIBUTION.list_contributions-ehr_containing_ehr_status</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>List <code>CONTRIBUTIONs</code> post commit of <code>CONTRIBUTION</code> containing <code>EHR_STATUS</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR has a <code>CONTRIBUTION</code> with known uid</p>
</li>
<li>
<p>The <code>CONTRIBUTION</code> contains a <code>VERSION&lt;EHR_STATUS&gt;</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke list <code>CONTRIBUTIONs</code> service by the existing <code>ehr_id</code></p>
</li>
<li>
<p>The result should be positive and retrieve a list of <code>CONTRIBUTIONs</code> with one item</p>
</li>
<li>
<p>The <code>CONTRIBUTION</code> should contain an <code>EHR_STATUS</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_list_contributions_ehr_containing_directory"><a class="anchor" href="#_tc_i_ehr_contribution_list_contributions_ehr_containing_directory"></a>8.5.2.5. TC I_EHR_CONTRIBUTION.list_contributions-ehr_containing_directory</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>List <code>CONTRIBUTIONs</code> post commit of <code>CONTRIBUTION</code> containing a <code>directory</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR has a <code>CONTRIBUTION</code> with known uid</p>
</li>
<li>
<p>The <code>CONTRIBUTION</code> contains a <code>VERSION&lt;FOLDER&gt;</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke get <code>CONTRIBUTIONs</code> service by the existing <code>ehr_id</code></p>
</li>
<li>
<p>The result should be positive and retrieve a list of <code>CONTRIBUTIONs</code> with one item</p>
</li>
<li>
<p>The <code>CONTRIBUTION</code> should contain a <code>FOLDER</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_contribution_has_contribution"><a class="anchor" href="#_conformance_point_i_ehr_contribution_has_contribution"></a>8.5.3. Conformance point: I_EHR_CONTRIBUTION.has_contribution()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_contribution_interface" target="_blank" rel="noopener"><code>I_EHR_CONTRIBUTION.<em>has_contribution()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_has_contribution_existing"><a class="anchor" href="#_tc_i_ehr_contribution_has_contribution_existing"></a>8.5.3.1. TC I_EHR_CONTRIBUTION.has_contribution-existing</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test presence of <code>CONTRIBUTIONs</code> post commit of <code>CONTRIBUTION</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR should exist in the system with a known <code>ehr_id</code></p>
</li>
<li>
<p>The EHR has a <code>CONTRIBUTION</code> with known uid</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke has <code>CONTRIBUTION</code> service with the known <code>ehr_id</code> and <code>CONTRIBUTION</code> uid</p>
</li>
<li>
<p>The result should be <code>true</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_has_contribution_empty_ehr"><a class="anchor" href="#_tc_i_ehr_contribution_has_contribution_empty_ehr"></a>8.5.3.2. TC I_EHR_CONTRIBUTION.has_contribution-empty_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test presence of <code>CONTRIBUTIONs</code> on empty EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR should exists in the system with a known <code>ehr_id</code></p>
</li>
<li>
<p>The EHR doesn’t have any <code>CONTRIBUTIONs</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke has <code>CONTRIBUTION</code> service with the known <code>ehr_id</code> and a random <code>CONTRIBUTION</code> uid</p>
</li>
<li>
<p>The result should be <code>false</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_has_contribution_non_existing_ehr"><a class="anchor" href="#_tc_i_ehr_contribution_has_contribution_non_existing_ehr"></a>8.5.3.3. TC I_EHR_CONTRIBUTION.has_contribution-non_existing_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test presence of <code>CONTRIBUTIONs</code> on non-existent EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>There are no EHRs on the server</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke has <code>CONTRIBUTION</code> service with a random <code>ehr_id</code> and a random <code>CONTRIBUTION</code> uid</p>
</li>
<li>
<p>The result should be negative, and retrieve an error indicating <code>"the EHR with ehr_id doesn’t exist"</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_has_contribution_non_existing_contribution"><a class="anchor" href="#_tc_i_ehr_contribution_has_contribution_non_existing_contribution"></a>8.5.3.4. TC I_EHR_CONTRIBUTION.has_contribution-non_existing_contribution</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test presence of <code>CONTRIBUTION</code> that doesn&#8217;t exist</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR should exist on the server with a known <code>ehr_id</code></p>
</li>
<li>
<p>The EHR has <code>CONTRIBUTIONs</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke has <code>CONTRIBUTION</code> service with the known <code>ehr_id</code> and a random, not existing <code>CONTRIBUTION</code> uid</p>
</li>
<li>
<p>The result should be <code>false</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_contribution_get_contribution"><a class="anchor" href="#_conformance_point_i_ehr_contribution_get_contribution"></a>8.5.4. Conformance point: I_EHR_CONTRIBUTION.get_contribution()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_contribution_interface" target="_blank" rel="noopener"><code>I_EHR_CONTRIBUTION.<em>get_contribution()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_get_contribution_existing_contribution"><a class="anchor" href="#_tc_i_ehr_contribution_get_contribution_existing_contribution"></a>8.5.4.1. TC I_EHR_CONTRIBUTION.get_contribution-existing_contribution</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test get <code>CONTRIBUTION</code> from EHR with existing <code>CONTRIBUTION</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR should exist in the system with a known <code>ehr_id</code></p>
</li>
<li>
<p>The EHR has a <code>CONTRIBUTION</code> with known uid</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke has <code>CONTRIBUTION</code> service with the known <code>ehr_id</code> and <code>CONTRIBUTION</code> uid</p>
</li>
<li>
<p>The result should be the existing <code>CONTRIBUTION</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_get_contribution_empty_ehr"><a class="anchor" href="#_tc_i_ehr_contribution_get_contribution_empty_ehr"></a>8.5.4.2. TC I_EHR_CONTRIBUTION.get_contribution-empty_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test get <code>CONTRIBUTION</code> from empty EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR should exists in the system with a known <code>ehr_id</code></p>
</li>
<li>
<p>The EHR doesn’t have any <code>CONTRIBUTIONs</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke has <code>CONTRIBUTION</code> service with the known <code>ehr_id</code> and a random <code>CONTRIBUTION</code> uid</p>
</li>
<li>
<p>The result should be negative and retrieve an error indicating the non-existing <code>CONTRIBUTION</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_get_contribution_non_existing_ehr"><a class="anchor" href="#_tc_i_ehr_contribution_get_contribution_non_existing_ehr"></a>8.5.4.3. TC I_EHR_CONTRIBUTION.get_contribution-non_existing_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test get <code>CONTRIBUTION</code> from non-existing EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>There are no EHRs on the server</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke has <code>CONTRIBUTION</code> service with a random <code>ehr_id</code> and a random <code>CONTRIBUTION</code> uid</p>
</li>
<li>
<p>The result should be negative, and retrieve an error indicating <code>"the EHR with ehd_id doesn’t exist"</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_contribution_get_contribution_non_existing_contribution"><a class="anchor" href="#_tc_i_ehr_contribution_get_contribution_non_existing_contribution"></a>8.5.4.4. TC I_EHR_CONTRIBUTION.get_contribution-non_existing_contribution</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test get <code>CONTRIBUTION</code> from EHR with non-existing <code>CONTRIBUTION</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR should exist on the server with a known <code>ehr_id</code></p>
</li>
<li>
<p>The EHR has <code>CONTRIBUTIONs</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke has <code>CONTRIBUTION</code> service with the known <code>ehr_id</code> and a random, non-existing <code>CONTRIBUTION</code> uid</p>
</li>
<li>
<p>The result should be negative and retrieve an error indicating the non-existing <code>CONTRIBUTION</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_functional_conformance_ehr_directory_component"><a class="anchor" href="#_functional_conformance_ehr_directory_component"></a>9. Functional Conformance: EHR / DIRECTORY Component</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_normative_reference_5"><a class="anchor" href="#_normative_reference_5"></a>9.1. Normative Reference</h3>
<div class="paragraph">
<p>Items in this validation suite conceptually use the following abstract interfaces from the <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_directory_interface" target="_blank" rel="noopener">Abstract Platform Service Model, EHR/DIRECTORY component</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>I_EHR_DIRECTORY</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These are concretely realised in implementation technology specfic APIs, such as the <a href="https://specifications.openehr.org/releases/ITS-REST/latest/ehr.html" target="_blank" rel="noopener">EHR REST API</a>.</p>
</div>
<div class="paragraph">
<p>The data that flow through these interfaces are defined by the following information model specifications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/ehr.html" target="_blank" rel="noopener">EHR IM</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/common.html" target="_blank" rel="noopener">Common IM</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/data_structures.html" target="_blank" rel="noopener">Data Structures IM</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/data_types.html" target="_blank" rel="noopener">Data Types IM</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/support.html" target="_blank" rel="noopener">Support IM</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/common.html#_change_control_package" target="_blank" rel="noopener">Versioning</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_dependencies_3"><a class="anchor" href="#_dependencies_3"></a>9.2. Dependencies</h3>
<div class="paragraph">
<p>This test suite depends on other test suites:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#_func_conf_def_component">Functional Conformance: Definitions Component</a>, providing OPTs;</p>
</li>
<li>
<p><a href="#_func_conf_ehr_component">Functional Conformance: EHR Component</a>, providing EHRs.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_test_environment_5"><a class="anchor" href="#_test_environment_5"></a>9.3. Test Environment</h3>
<table class="tableblock frame-all grid-all" style="width: 5%;">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TBD</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_test_data_sets_4"><a class="anchor" href="#_test_data_sets_4"></a>9.4. Test Data Sets</h3>
<div class="paragraph">
<p>For the creation and modification of the <code>EHR.directory</code> structure it is important to explore the hierarchical nature of the <code>FOLDER</code> structures and consider the edge cases for <code>EHR.directory</code>.</p>
</div>
<div class="sect3">
<h4 id="_tests_of_ehr_directory"><a class="anchor" href="#_tests_of_ehr_directory"></a>9.4.1. Tests of EHR.directory</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>FOLDER</p>
</li>
<li>
<p>FOLDER with items</p>
</li>
<li>
<p>FOLDER with subfolders</p>
</li>
<li>
<p>FOLDER with subfolders and items on all the folders</p>
</li>
<li>
<p>FOLDER with n levels of subfolders and items (to detect any implementation limitations)</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_tests_of_reference_folder_structure"><a class="anchor" href="#_tests_of_reference_folder_structure"></a>9.4.2. Tests of Reference FOLDER structure</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
the following image is provided for reference. The items in the <code>FOLDER</code> are references to <code>VERSIONED_OBJECTs</code> that may contain <code>COMPOSITION</code>, <code>EHR_STATUS</code> and <code>FOLDER</code>. This documentation focuses on testing <code>COMPOSITION</code> as content in the <code>FOLDERs</code>. Related discussion:
<a href="https://discourse.openehr.org/t/whats-allowed-in-folder-items/1539" target="_blank" rel="noopener">here</a>.
</td>
</tr>
</table>
</div>
<div id="high_level_ehr_structure" class="imageblock text-center text-center">
<div class="content">
<img src="https://specifications.openehr.org/releases/RM/latest/ehr/diagrams/high_level_ehr_structure.svg" alt="high level ehr structure">
</div>
<div class="title">Figure 1. Folder structures in the EHR</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_test_cases_4"><a class="anchor" href="#_test_cases_4"></a>9.5. Test Cases</h3>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_directory_has_directory"><a class="anchor" href="#_conformance_point_i_ehr_directory_has_directory"></a>9.5.1. Conformance point: I_EHR_DIRECTORY.has_directory()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_directory_interface" target="_blank" rel="noopener"><code>I_EHR_DIRECTORY.<em>has_directory()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_has_directory_empty_ehr"><a class="anchor" href="#_tc_i_ehr_directory_has_directory_empty_ehr"></a>9.5.1.1. TC I_EHR_DIRECTORY.has_directory-empty_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test has_directory on empty EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR doesn’t have a directory</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the has_directory service for the <code>ehr_id</code></p>
</li>
<li>
<p>The result must be false</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_has_directory_ehr_with_directory"><a class="anchor" href="#_tc_i_ehr_directory_has_directory_ehr_with_directory"></a>9.5.1.2. TC I_EHR_DIRECTORY.has_directory-ehr_with_directory</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test has_directory on EHR containing a directory</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR has a directory</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the has_directory service for the <code>ehr_id</code></p>
</li>
<li>
<p>The result must be true</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_has_directory_bad_ehr"><a class="anchor" href="#_tc_i_ehr_directory_has_directory_bad_ehr"></a>9.5.1.3. TC I_EHR_DIRECTORY.has_directory-bad_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test has_directory on non-existent EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>There are no EHRs on the server</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the has_directory service for a random non-existent <code>ehr_id</code></p>
</li>
<li>
<p>An error should be returned, indicating that the EHR that doesn’t exist</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_directory_has_path"><a class="anchor" href="#_conformance_point_i_ehr_directory_has_path"></a>9.5.2. Conformance point: I_EHR_DIRECTORY.has_path()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_directory_interface" target="_blank" rel="noopener"><code>I_EHR_DIRECTORY.<em>has_path()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_has_path_empty_ehr"><a class="anchor" href="#_tc_i_ehr_directory_has_path_empty_ehr"></a>9.5.2.1. TC I_EHR_DIRECTORY.has_path-empty_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test has_path on empty EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR doesn’t have a directory</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the has path service for the <code>ehr_id</code> with a random <code>FOLDER</code> path</p>
</li>
<li>
<p>The result must be false</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_has_path_ehr_root_directory"><a class="anchor" href="#_tc_i_ehr_directory_has_path_ehr_root_directory"></a>9.5.2.2. TC I_EHR_DIRECTORY.has_path-ehr_root_directory</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test has_path on EHR with just root directory</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR and has an empty directory (no subfolders or items)</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the has path service for the <code>ehr_id</code> and an existing path <code>$path</code> from the data set</p>
</li>
<li>
<p>The result must be <code>$result</code> from the data set</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Data set</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">$path</th>
<th class="tableblock halign-center valign-top">$result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>'/'</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">random()</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<code>'/'</code> represents the string slash, which is the default name for the root <code>FOLDER</code> at <code>EHR.directory</code>, <code>random()</code> represents any randomly generated path that doesn’t exist.
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_has_path_folder_structure"><a class="anchor" href="#_tc_i_ehr_directory_has_path_folder_structure"></a>9.5.2.3. TC I_EHR_DIRECTORY.has_path-folder_structure</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test has_path on EHR with folder structure</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR has a directory with an internal structure (described below)</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the has path service for the <code>ehr_id</code> and the path $path from the data set</p>
</li>
<li>
<p>The result must be <code>$result</code> from the data set</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Data set</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Assuming the following structure in <code>EHR.directory</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/
    +--- emergency
    |        |
    |        +--- episode-x
    |        |      |
    |        |      +--- summary-composition-x
    |        |
    |        +--- episode-y
    |               |
    |               +--- summary-composition-y
    |
    +--- hospitalization
             |
             +--- summary-composition-z</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
these are the names of the <code>FOLDERs</code> and <code>COMPOSITIONs</code> in <code>EHR.directory.</code>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">$path</th>
<th class="tableblock halign-center valign-top">$result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'/'</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'/emergency'</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'/emergency/episode-x'</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'/emergency/episode-x/summary-composition-x'</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'/emergency/episode-y'</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'/emergency/episode-y/summary-composition-y'</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'/hospitalization'</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'/hospitalization/summary-composition-z'</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'/'</code> + random()</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'/emergency/'</code> + random()</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'/emergency/episode-x/'</code> + random()</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">random()</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
the table mixes cases that exist with cases of paths which part exists and parts doesn’t exist. The final one is a random path.
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_has_path_bad_ehr"><a class="anchor" href="#_tc_i_ehr_directory_has_path_bad_ehr"></a>9.5.2.4. TC I_EHR_DIRECTORY.has_path-bad_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test has_path on non-existent EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The server is empty</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the has path service for a random <code>ehr_id</code> and path</p>
</li>
<li>
<p>The service should return an error, indicating that the EHR doesn’t exist</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_directory_create_directory"><a class="anchor" href="#_conformance_point_i_ehr_directory_create_directory"></a>9.5.3. Conformance point: I_EHR_DIRECTORY.create_directory()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_directory_interface" target="_blank" rel="noopener"><code>I_EHR_DIRECTORY.<em>create_directory()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_create_directory_empty_ehr"><a class="anchor" href="#_tc_i_ehr_directory_create_directory_empty_ehr"></a>9.5.3.1. TC I_EHR_DIRECTORY.create_directory-empty_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test create_directory on empty EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR doesn’t have a directory</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The EHR <code>ehr_id</code> should have a directory</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the create directory service with the existing <code>ehr_id</code> and a valid <code>FOLDER</code> structure</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Use any of the data sets described on the previous tests and the reference directory structure</p>
</li>
</ol>
</div>
</li>
<li>
<p>The service should return a positive result indicating the directory created for the EHR</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_create_directory_ehr_with_directory"><a class="anchor" href="#_tc_i_ehr_directory_create_directory_ehr_with_directory"></a>9.5.3.2. TC I_EHR_DIRECTORY.create_directory-ehr_with_directory</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test create_directory on EHR with directory</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR has a directory</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the create directory service with the existing <code>ehr_id</code> and a valid <code>FOLDER</code> structure</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Use any of the data sets described on the previous tests and the reference directory structure</p>
</li>
</ol>
</div>
</li>
<li>
<p>The service should return an error, indicating that the EHR directory already exists</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_create_directory_bad_ehr"><a class="anchor" href="#_tc_i_ehr_directory_create_directory_bad_ehr"></a>9.5.3.3. TC I_EHR_DIRECTORY.create_directory-bad_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test create_directory on non-existent EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The server should be empty</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the create directory service for a random <code>ehr_id</code></p>
</li>
<li>
<p>The service should return an error, indicating that the EHR that doesn’t exist</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_directory_get_directory"><a class="anchor" href="#_conformance_point_i_ehr_directory_get_directory"></a>9.5.4. Conformance point: I_EHR_DIRECTORY.get_directory()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_directory_interface" target="_blank" rel="noopener"><code>I_EHR_DIRECTORY.<em>get_directory()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_get_directory_empty_ehr"><a class="anchor" href="#_tc_i_ehr_directory_get_directory_empty_ehr"></a>9.5.4.1. TC I_EHR_DIRECTORY.get_directory-empty_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test get_directory on empty EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR doesn’t have a directory</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get directory service for the <code>ehr_id</code></p>
</li>
<li>
<p>The service should return an empty structure</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
in a REST API implementation, the result could be an error status instead of an empty structure.
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_get_directory_ehr_root_directory"><a class="anchor" href="#_tc_i_ehr_directory_get_directory_ehr_root_directory"></a>9.5.4.2. TC I_EHR_DIRECTORY.get_directory-ehr_root_directory</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test get_directory on EHR with a root directory</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR has a single empty <code>FOLDER</code> in its directory</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get directory service for the <code>ehr_id</code></p>
</li>
<li>
<p>The service should return the structure of the <code>EHR.directory</code>: an empty <code>FOLDER</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_get_directory_directory_with_structure"><a class="anchor" href="#_tc_i_ehr_directory_get_directory_directory_with_structure"></a>9.5.4.3. TC I_EHR_DIRECTORY.get_directory-directory_with_structure</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test get_directory on EHR with a directory containing sub-structure</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR has a directory with a sub-structure (use the data sets from the previous tests and the reference directory structure)</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get directory service for the <code>ehr_id</code></p>
</li>
<li>
<p>The service should return the full structure of the EHR directory</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_get_directory_directory_with_structure_2"><a class="anchor" href="#_tc_i_ehr_directory_get_directory_directory_with_structure_2"></a>9.5.4.4. TC I_EHR_DIRECTORY.get_directory-directory_with_structure</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test get_directory on non-existent EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The server is empty</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get directory service for a random <code>ehr_id</code></p>
</li>
<li>
<p>The service should return an error related with the non-existent EHR</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_directory_get_directory_at_time"><a class="anchor" href="#_conformance_point_i_ehr_directory_get_directory_at_time"></a>9.5.5. Conformance point: I_EHR_DIRECTORY.get_directory_at_time()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_directory_interface" target="_blank" rel="noopener"><code>I_EHR_DIRECTORY.<em>get_directory_at_time()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_get_directory_at_time_empty_ehr"><a class="anchor" href="#_tc_i_ehr_directory_get_directory_at_time_empty_ehr"></a>9.5.5.1. TC I_EHR_DIRECTORY.get_directory_at_time-empty_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test get_directory_at_time on empty EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR doesn’t have a directory</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get directory at time service for the <code>ehr_id</code> and current time</p>
</li>
<li>
<p>The service should return an empty structure</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
considering a REST API implementation, the result could be an error status instead of an empty structure.
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_get_directory_at_time_empty_ehr_empty_time"><a class="anchor" href="#_tc_i_ehr_directory_get_directory_at_time_empty_ehr_empty_time"></a>9.5.5.2. TC I_EHR_DIRECTORY.get_directory_at_time-empty_ehr_empty_time</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test get_directory_at_time on empty EHR with empty time</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR doesn’t have a directory</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get directory at time service for the <code>ehr_id</code> and empty time</p>
</li>
<li>
<p>The service should return an empty structure</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
considering a REST API implementation, the result could be an error status instead of an empty structure.
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_get_directory_at_time_ehr_with_directory"><a class="anchor" href="#_tc_i_ehr_directory_get_directory_at_time_ehr_with_directory"></a>9.5.5.3. TC I_EHR_DIRECTORY.get_directory_at_time-ehr_with_directory</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test get_directory_at_time on empty EHR with directory</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR has a directory with one version (use any of the valid datasets from the previous tests)</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get directory at time service for the <code>ehr_id</code> and current time</p>
</li>
<li>
<p>The service should return the current directory</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_get_directory_at_time_ehr_with_directory_empty_time"><a class="anchor" href="#_tc_i_ehr_directory_get_directory_at_time_ehr_with_directory_empty_time"></a>9.5.5.4. TC I_EHR_DIRECTORY.get_directory_at_time-ehr_with_directory_empty_time</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test get_directory_at_time on EHR with directory with empty time</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR has a directory with one version (use any of the valid datasets from the previous tests)</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get directory at time service for the <code>ehr_id</code> and empty time</p>
</li>
<li>
<p>The service should return the current directory</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_get_directory_at_time_ehr_with_directory_versions"><a class="anchor" href="#_tc_i_ehr_directory_get_directory_at_time_ehr_with_directory_versions"></a>9.5.5.5. TC I_EHR_DIRECTORY.get_directory_at_time-ehr_with_directory_versions</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test get_directory_at_time on EHR with directory containing multiple versions</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR has a directory with two versions (use any of the valid datasets from the previous tests, add small changes to differentiate the versions)</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get directory at time service for the <code>ehr_id</code> and a time before <code>EHR.time_created</code></p>
</li>
<li>
<p>The service should return an empty structure</p>
</li>
<li>
<p>Invoke the get directory at time service for the <code>ehr_id</code> and a time after the first <code>EHR.directory</code> version was created and before the second <code>EHR.directory</code> version was created</p>
</li>
<li>
<p>The service should return the first version of <code>EHR.drectory</code></p>
</li>
<li>
<p>Invoke the get directory at time service for the <code>ehr_id</code> and current time</p>
</li>
<li>
<p>The service should return the second version of <code>EHR.directory</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_get_directory_at_time_ehr_with_directory_versions_empty_time"><a class="anchor" href="#_tc_i_ehr_directory_get_directory_at_time_ehr_with_directory_versions_empty_time"></a>9.5.5.6. TC I_EHR_DIRECTORY.get_directory_at_time-ehr_with_directory_versions_empty_time</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test get_directory_at_time on EHR with directory containing multiple versions with empty time</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with <code>ehr_id</code> exists</p>
</li>
<li>
<p>The EHR has a directory with two versions (use any of the valid datasets from the previous tests, add small changes to differentiate the versions)</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get directory at time service for the <code>ehr_id</code> and empty time</p>
</li>
<li>
<p>The service should return the current latest directory</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_get_directory_at_time_bad_ehr"><a class="anchor" href="#_tc_i_ehr_directory_get_directory_at_time_bad_ehr"></a>9.5.5.7. TC I_EHR_DIRECTORY.get_directory_at_time-bad_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test get_directory_at_time on EHR with directory containing multiple versions with empty time</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The server is empty</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get directory at time service for a random <code>ehr_id</code> and current time</p>
</li>
<li>
<p>The service should return an error indicating non-existent EHR</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_directory_update_directory"><a class="anchor" href="#_conformance_point_i_ehr_directory_update_directory"></a>9.5.6. Conformance point: I_EHR_DIRECTORY.update_directory()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_directory_interface" target="_blank" rel="noopener"><code>I_EHR_DIRECTORY.<em>update_directory()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_update_directory_ehr_with_directory"><a class="anchor" href="#_tc_i_ehr_directory_update_directory_ehr_with_directory"></a>9.5.6.1. TC I_EHR_DIRECTORY.update_directory-ehr_with_directory</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test update_directory on EHR with directory</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with <code>ehr_id</code> exists on the server</p>
</li>
<li>
<p>The EHR has a directory</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The EHR with <code>ehr_id</code> has an updated directory structure</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the update directory service for the <code>ehr_id</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Use any of the valid paylaods described on the previous tests</p>
</li>
</ol>
</div>
</li>
<li>
<p>The service should return a positive result related with the updated directory</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_update_directory_empty_ehr"><a class="anchor" href="#_tc_i_ehr_directory_update_directory_empty_ehr"></a>9.5.6.2. TC I_EHR_DIRECTORY.update_directory-empty_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test update_directory on empty EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with <code>ehr_id</code> exists on the server</p>
</li>
<li>
<p>The EHR doesn’t have a directory</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the update directory service for the <code>ehr_id</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Use any of the valid paylaods described on the previous tests</p>
</li>
</ol>
</div>
</li>
<li>
<p>The service should return an error indicating that the non existent directory to update</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_update_directory_bad_ehr"><a class="anchor" href="#_tc_i_ehr_directory_update_directory_bad_ehr"></a>9.5.6.3. TC I_EHR_DIRECTORY.update_directory-bad_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test update_directory on non-existent EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The server is empty</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the update directory service for random <code>ehr_id</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Any valid payload will suffice</p>
</li>
</ol>
</div>
</li>
<li>
<p>The service should return an error indicating that the non existent <code>ehr_id</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_directory_delete_directory"><a class="anchor" href="#_conformance_point_i_ehr_directory_delete_directory"></a>9.5.7. Conformance point: I_EHR_DIRECTORY.delete_directory()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_directory_interface" target="_blank" rel="noopener"><code>I_EHR_DIRECTORY.<em>delete_directory()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_delete_directory_empty_ehr"><a class="anchor" href="#_tc_i_ehr_directory_delete_directory_empty_ehr"></a>9.5.7.1. TC I_EHR_DIRECTORY.delete_directory-empty_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test delete_directory on empty EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with <code>ehr_id</code> exists on the server</p>
</li>
<li>
<p>The EHR doesn’t have a directory</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the delete directory service for the <code>ehr_id</code></p>
</li>
<li>
<p>The service should return an error indicating the non existent directory</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_delete_directory_ehr_with_directory"><a class="anchor" href="#_tc_i_ehr_directory_delete_directory_ehr_with_directory"></a>9.5.7.2. TC I_EHR_DIRECTORY.delete_directory-ehr_with_directory</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test delete_directory on EHR with directory</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with <code>ehr_id</code> exists on the server</p>
</li>
<li>
<p>The EHR has a directory</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The EHR <code>ehr_id</code> doesn’t have directory</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
the directory exists as a new deleted version (that is <code>VERSION.lifecycle_state=deleted</code>).
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the delete directory service for the <code>ehr_id</code></p>
</li>
<li>
<p>The service should return a positive result related with the deleted directory</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_delete_directory_bad_ehr"><a class="anchor" href="#_tc_i_ehr_directory_delete_directory_bad_ehr"></a>9.5.7.3. TC I_EHR_DIRECTORY.delete_directory-bad_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test delete_directory on non-existent EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The server is empty</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get directory service for a random <code>ehr_id</code></p>
</li>
<li>
<p>The service should return an error indicating that the non existent EHR</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_directory_has_directory_version"><a class="anchor" href="#_conformance_point_i_ehr_directory_has_directory_version"></a>9.5.8. Conformance point: I_EHR_DIRECTORY.has_directory_version()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_directory_interface" target="_blank" rel="noopener"><code>I_EHR_DIRECTORY.<em>has_directory_version()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_has_directory_version_empty_ehr"><a class="anchor" href="#_tc_i_ehr_directory_has_directory_version_empty_ehr"></a>9.5.8.1. TC I_EHR_DIRECTORY.has_directory_version-empty_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test has_directory_version on empty EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists on the server</p>
</li>
<li>
<p>The EHR doesn’t have a directory</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the has directory service for the <code>ehr_id</code> and a random version uid</p>
</li>
<li>
<p>The service should return false</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_has_directory_version_directory_with_two_versions"><a class="anchor" href="#_tc_i_ehr_directory_has_directory_version_directory_with_two_versions"></a>9.5.8.2. TC I_EHR_DIRECTORY.has_directory_version-directory_with_two_versions</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test has_directory_version on EHR that has two versions of directory</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists on the server</p>
</li>
<li>
<p>The EHR has two directory versions</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the has directory service for the <code>ehr_id</code> and the <code>version_uid</code> of the first version of directory</p>
</li>
<li>
<p>The service should return true</p>
</li>
<li>
<p>Invoke the has directory service for the <code>ehr_id</code> and the <code>version_uid</code> of the second version of directory</p>
</li>
<li>
<p>The service should return true</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_has_directory_version_bad_ehr"><a class="anchor" href="#_tc_i_ehr_directory_has_directory_version_bad_ehr"></a>9.5.8.3. TC I_EHR_DIRECTORY.has_directory_version-bad_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test has_directory_version on non-existent EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The server doesn’t have EHRs</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the has directory service for a random <code>ehr_id</code> and version uid</p>
</li>
<li>
<p>The service should return an error related with the non-existence of the EHR</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_directory_get_directory_at_version"><a class="anchor" href="#_conformance_point_i_ehr_directory_get_directory_at_version"></a>9.5.9. Conformance point: I_EHR_DIRECTORY.get_directory_at_version()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_directory_interface" target="_blank" rel="noopener"><code>I_EHR_DIRECTORY.<em>get_directory_at_version()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_get_directory_at_version_empty_ehr"><a class="anchor" href="#_tc_i_ehr_directory_get_directory_at_version_empty_ehr"></a>9.5.9.1. TC I_EHR_DIRECTORY.get_directory_at_version-empty_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test get_directory_at_version on empty EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists on the server</p>
</li>
<li>
<p>The EHR doesn’t have a directory</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get directory at version service for the <code>ehr_id</code> and a random version uid</p>
</li>
<li>
<p>The service should return an error indicating that the non-existence of the EHR directory version</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_get_directory_at_version_directory_with_two_versions"><a class="anchor" href="#_tc_i_ehr_directory_get_directory_at_version_directory_with_two_versions"></a>9.5.9.2. TC I_EHR_DIRECTORY.get_directory_at_version-directory_with_two_versions</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test get_directory_at_version on EHR that has two versions of directory</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists on the server</p>
</li>
<li>
<p>The EHR has two versions of directory</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get directory at version service for the <code>ehr_id</code> and the <code>version_uid</code> of the first version of directory</p>
</li>
<li>
<p>The service should return the first version of the directory</p>
</li>
<li>
<p>Invoke the get directory at version service for the <code>ehr_id</code> and the <code>version_uid</code> of the second version of directory</p>
</li>
<li>
<p>The service should return the second version of the directory</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_get_directory_at_version_bad_ehr"><a class="anchor" href="#_tc_i_ehr_directory_get_directory_at_version_bad_ehr"></a>9.5.9.3. TC I_EHR_DIRECTORY.get_directory_at_version-bad_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test get_directory_at_version on non-existent EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The server doesn’t have EHRs</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get directory at version service for a random <code>ehr_id</code> and version uid</p>
</li>
<li>
<p>The service should return an error related with the non existence of the EHR</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_directory_get_versioned_directory"><a class="anchor" href="#_conformance_point_i_ehr_directory_get_versioned_directory"></a>9.5.10. Conformance point: I_EHR_DIRECTORY.get_versioned_directory()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_directory_interface" target="_blank" rel="noopener"><code>I_EHR_DIRECTORY.<em>get_versioned_directory()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_get_versioned_directory_empty_ehr"><a class="anchor" href="#_tc_i_ehr_directory_get_versioned_directory_empty_ehr"></a>9.5.10.1. TC I_EHR_DIRECTORY.get_versioned_directory-empty_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test get_versioned_directory on non-existent EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists on the server</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get versioned directory service for the <code>ehr_id</code></p>
</li>
<li>
<p>The service should return an error because the versioned directory doesn’t exist</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
depending on the implementation, a valid result could also be returning an empty result instead of an error.
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_get_versioned_directory_directory_with_two_versions"><a class="anchor" href="#_tc_i_ehr_directory_get_versioned_directory_directory_with_two_versions"></a>9.5.10.2. TC I_EHR_DIRECTORY.get_versioned_directory-directory_with_two_versions</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test get_versioned_directory on EHR that has two versions of directory</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>An EHR with known <code>ehr_id</code> exists on the server</p>
</li>
<li>
<p>The EHR has two versions of directory</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get versioned directory service for the <code>ehr_id</code></p>
</li>
<li>
<p>The service should return the versioned folder and should reference the two exsinting versions</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tc_i_ehr_directory_get_versioned_directory_bad_ehr"><a class="anchor" href="#_tc_i_ehr_directory_get_versioned_directory_bad_ehr"></a>9.5.10.3. TC I_EHR_DIRECTORY.get_versioned_directory-bad_ehr</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Description</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Test get_versioned_directory on non-existent EHR</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Pre-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>The server doesn’t have any EHRs</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Post-conditions</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>None</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Flow</p></th>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the get directory service for a random <code>ehr_id</code></p>
</li>
<li>
<p>The service should return an error related with the non existence of the EHR</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_functional_conformance_demographic_component"><a class="anchor" href="#_functional_conformance_demographic_component"></a>10. Functional Conformance: Demographic Component</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_normative_reference_6"><a class="anchor" href="#_normative_reference_6"></a>10.1. Normative Reference</h3>
<div class="paragraph">
<p>Items in this validation suite conceptually use the following abstract interfaces from the <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_demographic_service_interface" target="_blank" rel="noopener">Abstract Platform Service Model, DEMOGRAPHIC component</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>I_DEMOGRAPHIC_SERVICE</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These are concretely realised in implementation technology specfic APIs, such as the <a href="https://specifications.openehr.org/releases/ITS-REST/latest/ehr.html" target="_blank" rel="noopener">EHR REST API</a>.</p>
</div>
<div class="paragraph">
<p>The data that flow through these interfaces are defined by the following information model specifications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Service Interfaces:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_demographic_package" target="_blank" rel="noopener">Abstract Demographic Service Model</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Information Models:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/demographic.html" target="_blank" rel="noopener">Demographic IM</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/common.html" target="_blank" rel="noopener">Common IM</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/data_structures.html" target="_blank" rel="noopener">Data Structures IM</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/data_types.html" target="_blank" rel="noopener">Data Types IM</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/support.html" target="_blank" rel="noopener">Support IM</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/common.html#_change_control_package" target="_blank" rel="noopener">Versioning</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_dependencies_4"><a class="anchor" href="#_dependencies_4"></a>10.2. Dependencies</h3>
<div class="paragraph">
<p>This test suite depends on other test suites:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#_func_conf_def_component">Functional Conformance: Definitions Component</a>, providing OPTs.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_test_environment_6"><a class="anchor" href="#_test_environment_6"></a>10.3. Test Environment</h3>
<table class="tableblock frame-all grid-all" style="width: 5%;">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TBD</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_test_data_sets_5"><a class="anchor" href="#_test_data_sets_5"></a>10.4. Test Data Sets</h3>
<table class="tableblock frame-all grid-all" style="width: 5%;">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TBD</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_test_cases_5"><a class="anchor" href="#_test_cases_5"></a>10.5. Test Cases</h3>
<div class="sect3">
<h4 id="_conformance_point_i_demographic_service_create_party"><a class="anchor" href="#_conformance_point_i_demographic_service_create_party"></a>10.5.1. Conformance point: I_DEMOGRAPHIC_SERVICE.create_party()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_demographic_service_interface" target="_blank" rel="noopener"><code>I_DEMOGRAPHIC_SERVICE.<em>create_party()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa"><a class="anchor" href="#_tc_aaaa"></a>10.5.1.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb"><a class="anchor" href="#_tc_bbbb"></a>10.5.1.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_demographic_service_get_party"><a class="anchor" href="#_conformance_point_i_demographic_service_get_party"></a>10.5.2. Conformance point: I_DEMOGRAPHIC_SERVICE.get_party()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_demographic_service_interface" target="_blank" rel="noopener"><code>I_DEMOGRAPHIC_SERVICE.<em>get_party()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_2"><a class="anchor" href="#_tc_aaaa_2"></a>10.5.2.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_2"><a class="anchor" href="#_tc_bbbb_2"></a>10.5.2.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_demographic_service_get_party_at_time"><a class="anchor" href="#_conformance_point_i_demographic_service_get_party_at_time"></a>10.5.3. Conformance point: I_DEMOGRAPHIC_SERVICE.get_party_at_time()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_demographic_service_interface" target="_blank" rel="noopener"><code>I_DEMOGRAPHIC_SERVICE.<em>get_party_at_time()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_3"><a class="anchor" href="#_tc_aaaa_3"></a>10.5.3.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_3"><a class="anchor" href="#_tc_bbbb_3"></a>10.5.3.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_demographic_service_update_party"><a class="anchor" href="#_conformance_point_i_demographic_service_update_party"></a>10.5.4. Conformance point: I_DEMOGRAPHIC_SERVICE.update_party()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_demographic_service_interface" target="_blank" rel="noopener"><code>I_DEMOGRAPHIC_SERVICE.<em>update_party()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_4"><a class="anchor" href="#_tc_aaaa_4"></a>10.5.4.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_4"><a class="anchor" href="#_tc_bbbb_4"></a>10.5.4.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_demographic_service_delete_party"><a class="anchor" href="#_conformance_point_i_demographic_service_delete_party"></a>10.5.5. Conformance point: I_DEMOGRAPHIC_SERVICE.delete_party()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_demographic_service_interface" target="_blank" rel="noopener"><code>I_DEMOGRAPHIC_SERVICE.<em>delete_party()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_5"><a class="anchor" href="#_tc_aaaa_5"></a>10.5.5.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_5"><a class="anchor" href="#_tc_bbbb_5"></a>10.5.5.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_demographic_service_get_party_at_version"><a class="anchor" href="#_conformance_point_i_demographic_service_get_party_at_version"></a>10.5.6. Conformance point: I_DEMOGRAPHIC_SERVICE.get_party_at_version()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_demographic_service_interface" target="_blank" rel="noopener"><code>I_DEMOGRAPHIC_SERVICE.<em>get_party_at_version()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_6"><a class="anchor" href="#_tc_aaaa_6"></a>10.5.6.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_6"><a class="anchor" href="#_tc_bbbb_6"></a>10.5.6.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_demographic_service_create_party_relationship"><a class="anchor" href="#_conformance_point_i_demographic_service_create_party_relationship"></a>10.5.7. Conformance point: I_DEMOGRAPHIC_SERVICE.create_party_relationship()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_demographic_service_interface" target="_blank" rel="noopener"><code>I_DEMOGRAPHIC_SERVICE.<em>create_party_relationship()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_7"><a class="anchor" href="#_tc_aaaa_7"></a>10.5.7.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_7"><a class="anchor" href="#_tc_bbbb_7"></a>10.5.7.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_demographic_service_get_party_relationship"><a class="anchor" href="#_conformance_point_i_demographic_service_get_party_relationship"></a>10.5.8. Conformance point: I_DEMOGRAPHIC_SERVICE.get_party_relationship()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_demographic_service_interface" target="_blank" rel="noopener"><code>I_DEMOGRAPHIC_SERVICE.<em>get_party_relationship()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_8"><a class="anchor" href="#_tc_aaaa_8"></a>10.5.8.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_8"><a class="anchor" href="#_tc_bbbb_8"></a>10.5.8.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_demographic_service_get_party_relationship_at_time"><a class="anchor" href="#_conformance_point_i_demographic_service_get_party_relationship_at_time"></a>10.5.9. Conformance point: I_DEMOGRAPHIC_SERVICE.get_party_relationship_at_time()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_demographic_service_interface" target="_blank" rel="noopener"><code>I_DEMOGRAPHIC_SERVICE.<em>get_party_relationship_at_time()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_9"><a class="anchor" href="#_tc_aaaa_9"></a>10.5.9.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_9"><a class="anchor" href="#_tc_bbbb_9"></a>10.5.9.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_demographic_service_update_party_relationship"><a class="anchor" href="#_conformance_point_i_demographic_service_update_party_relationship"></a>10.5.10. Conformance point: I_DEMOGRAPHIC_SERVICE.update_party_relationship()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_demographic_service_interface" target="_blank" rel="noopener"><code>I_DEMOGRAPHIC_SERVICE.<em>update_party_relationship()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_10"><a class="anchor" href="#_tc_aaaa_10"></a>10.5.10.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_10"><a class="anchor" href="#_tc_bbbb_10"></a>10.5.10.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_demographic_service_delete_party_relationship"><a class="anchor" href="#_conformance_point_i_demographic_service_delete_party_relationship"></a>10.5.11. Conformance point: I_DEMOGRAPHIC_SERVICE.delete_party_relationship()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_demographic_service_interface" target="_blank" rel="noopener"><code>I_DEMOGRAPHIC_SERVICE.<em>delete_party_relationship()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_11"><a class="anchor" href="#_tc_aaaa_11"></a>10.5.11.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_11"><a class="anchor" href="#_tc_bbbb_11"></a>10.5.11.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_demographic_service_get_party_relationship_at_version"><a class="anchor" href="#_conformance_point_i_demographic_service_get_party_relationship_at_version"></a>10.5.12. Conformance point: I_DEMOGRAPHIC_SERVICE.get_party_relationship_at_version()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_demographic_service_interface" target="_blank" rel="noopener"><code>I_DEMOGRAPHIC_SERVICE.<em>get_party_relationship_at_version()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_12"><a class="anchor" href="#_tc_aaaa_12"></a>10.5.12.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_12"><a class="anchor" href="#_tc_bbbb_12"></a>10.5.12.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_functional_conformance_querying_component"><a class="anchor" href="#_functional_conformance_querying_component"></a>11. Functional Conformance: Querying Component</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_normative_reference_7"><a class="anchor" href="#_normative_reference_7"></a>11.1. Normative Reference</h3>
<div class="paragraph">
<p>Items in this validation suite conceptually use the following abstract interfaces from the <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_query_service_interface" target="_blank" rel="noopener">Abstract Platform Service Model, QUERY component</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>I_QUERY_SERVICE</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These are concretely realised in implementation technology specfic APIs, such as the <a href="https://specifications.openehr.org/releases/ITS-REST/latest/query.html" target="_blank" rel="noopener">QUERY REST API</a>.</p>
</div>
<div class="paragraph">
<p>The data that flow through these interfaces are defined by the following information model specifications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Service Interfaces:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_query_package" target="_blank" rel="noopener">Abstract Query Service Model</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/ITS-REST/latest/query.html" target="_blank" rel="noopener">Query REST API</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Language Specifications:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://specifications.openehr.org/releases/QUERY/latest/AQL.html" target="_blank" rel="noopener">AQL specification</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_dependencies_5"><a class="anchor" href="#_dependencies_5"></a>11.2. Dependencies</h3>
<div class="paragraph">
<p>This test suite depends on other test suites:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#_func_conf_def_component">Functional Conformance: Definitions Component</a>, providing OPTs.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_test_environment_7"><a class="anchor" href="#_test_environment_7"></a>11.3. Test Environment</h3>
<table class="tableblock frame-all grid-all" style="width: 5%;">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TBD</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_test_data_sets_6"><a class="anchor" href="#_test_data_sets_6"></a>11.4. Test Data Sets</h3>
<table class="tableblock frame-all grid-all" style="width: 5%;">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TBD</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_test_cases_6"><a class="anchor" href="#_test_cases_6"></a>11.5. Test Cases</h3>
<div class="sect3">
<h4 id="_conformance_point_i_query_service_execute_stored_query"><a class="anchor" href="#_conformance_point_i_query_service_execute_stored_query"></a>11.5.1. Conformance point: I_QUERY_SERVICE.execute_stored_query()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_demographic_service_interface" target="_blank" rel="noopener"><code>I_QUERY_SERVICE.<em>execute_stored_query()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_13"><a class="anchor" href="#_tc_aaaa_13"></a>11.5.1.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_13"><a class="anchor" href="#_tc_bbbb_13"></a>11.5.1.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_query_service_execute_ad_hoc_query"><a class="anchor" href="#_conformance_point_i_query_service_execute_ad_hoc_query"></a>11.5.2. Conformance point: I_QUERY_SERVICE.execute_ad_hoc_query()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_demographic_service_interface" target="_blank" rel="noopener"><code>I_QUERY_SERVICE.<em>execute_ad_hoc_query()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_14"><a class="anchor" href="#_tc_aaaa_14"></a>11.5.2.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_14"><a class="anchor" href="#_tc_bbbb_14"></a>11.5.2.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_query_service_execute_stored_query_2"><a class="anchor" href="#_conformance_point_i_query_service_execute_stored_query_2"></a>11.5.3. Conformance point: I_QUERY_SERVICE.execute_stored_query()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_demographic_service_interface" target="_blank" rel="noopener"><code>I_QUERY_SERVICE.<em>execute_stored_query()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_15"><a class="anchor" href="#_tc_aaaa_15"></a>11.5.3.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_15"><a class="anchor" href="#_tc_bbbb_15"></a>11.5.3.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_query_service_execute_stored_query_3"><a class="anchor" href="#_conformance_point_i_query_service_execute_stored_query_3"></a>11.5.4. Conformance point: I_QUERY_SERVICE.execute_stored_query()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_demographic_service_interface" target="_blank" rel="noopener"><code>I_QUERY_SERVICE.<em>execute_stored_query()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_16"><a class="anchor" href="#_tc_aaaa_16"></a>11.5.4.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_16"><a class="anchor" href="#_tc_bbbb_16"></a>11.5.4.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_functional_conformance_admin_product_component"><a class="anchor" href="#_functional_conformance_admin_product_component"></a>12. Functional Conformance: Admin Product Component</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_normative_reference_8"><a class="anchor" href="#_normative_reference_8"></a>12.1. Normative Reference</h3>
<div class="paragraph">
<p>Items in this validation suite conceptually use the following abstract interfaces from the <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_admin_service_interface" target="_blank" rel="noopener">Abstract Platform Service Model, ADMIN component</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>I_ADMIN_SERVICE</code></p>
</li>
<li>
<p><code>I_ADMIN_DUMP_LOAD</code></p>
</li>
<li>
<p><code>I_ADMIN_ARCHIVE</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These are concretely realised in implementation technology specfic APIs, such as the {openehr_admin_rest_api}[ADMIN REST API^].</p>
</div>
<div class="paragraph">
<p>The data that flow through these interfaces are defined by the following information model specifications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Service Interfaces:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_admin_package" target="_blank" rel="noopener">Abstract Admin Service Model</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_dependencies_6"><a class="anchor" href="#_dependencies_6"></a>12.2. Dependencies</h3>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect2">
<h3 id="_test_environment_8"><a class="anchor" href="#_test_environment_8"></a>12.3. Test Environment</h3>
<table class="tableblock frame-all grid-all" style="width: 5%;">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TBD</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_test_data_sets_7"><a class="anchor" href="#_test_data_sets_7"></a>12.4. Test Data Sets</h3>
<table class="tableblock frame-all grid-all" style="width: 5%;">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TBD</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_test_cases_7"><a class="anchor" href="#_test_cases_7"></a>12.5. Test Cases</h3>
<div class="sect3">
<h4 id="_conformance_point_i_admin_service_list_contributions"><a class="anchor" href="#_conformance_point_i_admin_service_list_contributions"></a>12.5.1. Conformance point: I_ADMIN_SERVICE.list_contributions()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_admin_service_interface" target="_blank" rel="noopener"><code>I_ADMIN_SERVICE.<em>list_contributions()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_17"><a class="anchor" href="#_tc_aaaa_17"></a>12.5.1.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_17"><a class="anchor" href="#_tc_bbbb_17"></a>12.5.1.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_admin_service_contribution_count"><a class="anchor" href="#_conformance_point_i_admin_service_contribution_count"></a>12.5.2. Conformance point: I_ADMIN_SERVICE.contribution_count()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_admin_service_interface" target="_blank" rel="noopener"><code>I_ADMIN_SERVICE.<em>contribution_count()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_18"><a class="anchor" href="#_tc_aaaa_18"></a>12.5.2.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_18"><a class="anchor" href="#_tc_bbbb_18"></a>12.5.2.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_admin_service_versioned_composition_count"><a class="anchor" href="#_conformance_point_i_admin_service_versioned_composition_count"></a>12.5.3. Conformance point: I_ADMIN_SERVICE.versioned_composition_count()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_admin_service_interface" target="_blank" rel="noopener"><code>I_ADMIN_SERVICE.<em>versioned_composition_count()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_19"><a class="anchor" href="#_tc_aaaa_19"></a>12.5.3.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_19"><a class="anchor" href="#_tc_bbbb_19"></a>12.5.3.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_admin_service_composition_version_count"><a class="anchor" href="#_conformance_point_i_admin_service_composition_version_count"></a>12.5.4. Conformance point: I_ADMIN_SERVICE.composition_version_count()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_admin_service_interface" target="_blank" rel="noopener"><code>I_ADMIN_SERVICE.<em>composition_version_count()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_20"><a class="anchor" href="#_tc_aaaa_20"></a>12.5.4.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_20"><a class="anchor" href="#_tc_bbbb_20"></a>12.5.4.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_admin_service_physical_ehr_delete"><a class="anchor" href="#_conformance_point_i_admin_service_physical_ehr_delete"></a>12.5.5. Conformance point: I_ADMIN_SERVICE.physical_ehr_delete()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_admin_service_interface" target="_blank" rel="noopener"><code>I_ADMIN_SERVICE.<em>physical_ehr_delete()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_21"><a class="anchor" href="#_tc_aaaa_21"></a>12.5.5.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_21"><a class="anchor" href="#_tc_bbbb_21"></a>12.5.5.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_admin_service_physical_party_delete"><a class="anchor" href="#_conformance_point_i_admin_service_physical_party_delete"></a>12.5.6. Conformance point: I_ADMIN_SERVICE.physical_party_delete()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_admin_service_interface" target="_blank" rel="noopener"><code>I_ADMIN_SERVICE.<em>physical_party_delete()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_22"><a class="anchor" href="#_tc_aaaa_22"></a>12.5.6.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_22"><a class="anchor" href="#_tc_bbbb_22"></a>12.5.6.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_admin_dump_load_export_ehrs"><a class="anchor" href="#_conformance_point_i_admin_dump_load_export_ehrs"></a>12.5.7. Conformance point: I_ADMIN_DUMP_LOAD.export_ehrs()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_admin_dump_load_interface" target="_blank" rel="noopener"><code>I_ADMIN_DUMP_LOAD.<em>export_ehrs()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_23"><a class="anchor" href="#_tc_aaaa_23"></a>12.5.7.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_23"><a class="anchor" href="#_tc_bbbb_23"></a>12.5.7.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_admin_archive_archive_ehrs"><a class="anchor" href="#_conformance_point_i_admin_archive_archive_ehrs"></a>12.5.8. Conformance point: I_ADMIN_ARCHIVE.archive_ehrs()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_admin_archive_interface" target="_blank" rel="noopener"><code>I_ADMIN_ARCHIVE.<em>archive_ehrs()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_24"><a class="anchor" href="#_tc_aaaa_24"></a>12.5.8.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_24"><a class="anchor" href="#_tc_bbbb_24"></a>12.5.8.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_admin_archive_archive_parties"><a class="anchor" href="#_conformance_point_i_admin_archive_archive_parties"></a>12.5.9. Conformance point: I_ADMIN_ARCHIVE.archive_parties()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_admin_archive_interface" target="_blank" rel="noopener"><code>I_ADMIN_ARCHIVE.<em>archive_parties()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_25"><a class="anchor" href="#_tc_aaaa_25"></a>12.5.9.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_25"><a class="anchor" href="#_tc_bbbb_25"></a>12.5.9.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_functional_conformance_messaging_component"><a class="anchor" href="#_functional_conformance_messaging_component"></a>13. Functional Conformance: Messaging Component</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_normative_reference_9"><a class="anchor" href="#_normative_reference_9"></a>13.1. Normative Reference</h3>
<div class="paragraph">
<p>Items in this validation suite conceptually use the following abstract interfaces from the <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_message_service_interface" target="_blank" rel="noopener">Abstract Platform Service Model, MESSAGE component</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>I_EHR_EXTRACT</code></p>
</li>
<li>
<p><code>I_TDD</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These are concretely realised in implementation technology specfic APIs, such as the {openehr_message_rest_api}[MESSAGE REST API^].</p>
</div>
<div class="paragraph">
<p>The data that flow through these interfaces are defined by the following information model specifications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Service Interfaces:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_message_package" target="_blank" rel="noopener">Abstract Message Service Model</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Information Models:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/ehr_extract.html" target="_blank" rel="noopener">EHR Extract IM</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/ehr.html" target="_blank" rel="noopener">EHR IM</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/demographic.html" target="_blank" rel="noopener">Demographic IM</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/common.html" target="_blank" rel="noopener">Common IM</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/data_structures.html" target="_blank" rel="noopener">Data Structures IM</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/data_types.html" target="_blank" rel="noopener">Data Types IM</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/support.html" target="_blank" rel="noopener">Support IM</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_dependencies_7"><a class="anchor" href="#_dependencies_7"></a>13.2. Dependencies</h3>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect2">
<h3 id="_test_environment_9"><a class="anchor" href="#_test_environment_9"></a>13.3. Test Environment</h3>
<table class="tableblock frame-all grid-all" style="width: 5%;">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TBD</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_test_data_sets_8"><a class="anchor" href="#_test_data_sets_8"></a>13.4. Test Data Sets</h3>
<table class="tableblock frame-all grid-all" style="width: 5%;">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TBD</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_test_cases_8"><a class="anchor" href="#_test_cases_8"></a>13.5. Test Cases</h3>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_extract_export_ehr"><a class="anchor" href="#_conformance_point_i_ehr_extract_export_ehr"></a>13.5.1. Conformance point: I_EHR_EXTRACT.export_ehr()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_extract_interface" target="_blank" rel="noopener"><code>I_EHR_EXTRACT.<em>export_ehr()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_26"><a class="anchor" href="#_tc_aaaa_26"></a>13.5.1.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_26"><a class="anchor" href="#_tc_bbbb_26"></a>13.5.1.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_extract_export_ehr_extract"><a class="anchor" href="#_conformance_point_i_ehr_extract_export_ehr_extract"></a>13.5.2. Conformance point: I_EHR_EXTRACT.export_ehr_extract()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_extract_interface" target="_blank" rel="noopener"><code>I_EHR_EXTRACT.<em>export_ehr_extract()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_27"><a class="anchor" href="#_tc_aaaa_27"></a>13.5.2.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_27"><a class="anchor" href="#_tc_bbbb_27"></a>13.5.2.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_extract_export_ehr_2"><a class="anchor" href="#_conformance_point_i_ehr_extract_export_ehr_2"></a>13.5.3. Conformance point: I_EHR_EXTRACT.export_ehr()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_extract_interface" target="_blank" rel="noopener"><code>I_EHR_EXTRACT.<em>export_ehr()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_28"><a class="anchor" href="#_tc_aaaa_28"></a>13.5.3.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_28"><a class="anchor" href="#_tc_bbbb_28"></a>13.5.3.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_extract_export_ehrs"><a class="anchor" href="#_conformance_point_i_ehr_extract_export_ehrs"></a>13.5.4. Conformance point: I_EHR_EXTRACT.export_ehrs()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_extract_interface" target="_blank" rel="noopener"><code>I_EHR_EXTRACT.<em>export_ehrs()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_29"><a class="anchor" href="#_tc_aaaa_29"></a>13.5.4.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_29"><a class="anchor" href="#_tc_bbbb_29"></a>13.5.4.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_extract_export_ehr_extracts"><a class="anchor" href="#_conformance_point_i_ehr_extract_export_ehr_extracts"></a>13.5.5. Conformance point: I_EHR_EXTRACT.export_ehr_extracts()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_extract_interface" target="_blank" rel="noopener"><code>I_EHR_EXTRACT.<em>export_ehr_extracts()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_30"><a class="anchor" href="#_tc_aaaa_30"></a>13.5.5.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_30"><a class="anchor" href="#_tc_bbbb_30"></a>13.5.5.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_tdd_import_tdd"><a class="anchor" href="#_conformance_point_i_tdd_import_tdd"></a>13.5.6. Conformance point: I_TDD.import_tdd()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_tdd_interface" target="_blank" rel="noopener"><code>I_TDD.<em>import_tdd()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_31"><a class="anchor" href="#_tc_aaaa_31"></a>13.5.6.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_31"><a class="anchor" href="#_tc_bbbb_31"></a>13.5.6.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conformance_point_i_tdd_import_tdds"><a class="anchor" href="#_conformance_point_i_tdd_import_tdds"></a>13.5.7. Conformance point: I_TDD.import_tdds()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_tdd_interface" target="_blank" rel="noopener"><code>I_TDD.<em>import_tdds()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_32"><a class="anchor" href="#_tc_aaaa_32"></a>13.5.7.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_32"><a class="anchor" href="#_tc_bbbb_32"></a>13.5.7.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_non_functional_conformance_security_and_privacy"><a class="anchor" href="#_non_functional_conformance_security_and_privacy"></a>14. Non-Functional Conformance - Security and Privacy</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_normative_reference_10"><a class="anchor" href="#_normative_reference_10"></a>14.1. Normative Reference</h3>
<div class="paragraph">
<p>Items in this validation suite rely on the following specifications.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Service Interfaces:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_ehr_package" target="_blank" rel="noopener">Abstract EHR Service Model</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/ITS-REST/latest/ehr.html" target="_blank" rel="noopener">EHR REST API</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/ITS-REST/latest/demographic.html" target="_blank" rel="noopener">DEMOGRAPHIC REST API</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Information Models:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://specifications.openehr.org/releases/RM/latest/common.html#_digital_signature" target="_blank" rel="noopener">Digital Signature</a></p>
</li>
<li>
<p><a href="https://specifications.openehr.org/releases/BASE/latest/architecture_overview.html#_overview_4" target="_blank" rel="noopener">EHR/Demographic separation</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_dependencies_8"><a class="anchor" href="#_dependencies_8"></a>14.2. Dependencies</h3>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect2">
<h3 id="_test_environment_10"><a class="anchor" href="#_test_environment_10"></a>14.3. Test Environment</h3>
<table class="tableblock frame-all grid-all" style="width: 5%;">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TBD</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_test_data_sets_9"><a class="anchor" href="#_test_data_sets_9"></a>14.4. Test Data Sets</h3>
<table class="tableblock frame-all grid-all" style="width: 5%;">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TBD</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_test_cases_9"><a class="anchor" href="#_test_cases_9"></a>14.5. Test Cases</h3>
<div class="sect3">
<h4 id="_conformance_point_i_ehr_composition_create_composition"><a class="anchor" href="#_conformance_point_i_ehr_composition_create_composition"></a>14.5.1. Conformance point: I_EHR_COMPOSITION.create_composition()</h4>
<div class="paragraph">
<p>Platform service ref: <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_composition_interface" target="_blank" rel="noopener"><code>I_EHR_COMPOSITION.<em>create_composition()</em></code></a></p>
</div>
<div class="sect4">
<h5 id="_tc_aaaa_33"><a class="anchor" href="#_tc_aaaa_33"></a>14.5.1.1. TC aaaa</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect4">
<h5 id="_tc_bbbb_33"><a class="anchor" href="#_tc_bbbb_33"></a>14.5.1.2. TC bbbb</h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_application_programmer_interfaces_apis"><a class="anchor" href="#_application_programmer_interfaces_apis"></a>15. Application Programmer Interfaces (APIs)</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_rest_api_component"><a class="anchor" href="#_rest_api_component"></a>15.1. REST API Component</h3>
<div class="paragraph">
<p>Specifications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Service Interfaces:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html" target="_blank" rel="noopener">Abstract Service Model</a></p>
</li>
<li>
<p><a href="https://github.com/openEHR/specifications-ITS-REST" target="_blank" rel="noopener">REST APIs</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 22.2222%;">
<col style="width: 33.3333%;">
<col style="width: 22.2222%;">
<col style="width: 11.1112%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Product<br>
 Component</th>
<th class="tableblock halign-left valign-top">Capability</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Test case Script</th>
<th class="tableblock halign-left valign-top">REST Script</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>DEFINITION API</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_definition_adl14_interface" target="_blank" rel="noopener"><code>I_DEFINITION_ADL14</code></a><br>
 <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_definition_adl2_interface" target="_blank" rel="noopener"><code>I_DEFINITION_ADL2</code></a><br>
 <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_definition_query_interface" target="_blank" rel="noopener"><code>I_DEFINITION_QUERY</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exercise all functions &amp; arguments</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="{openehr_cnf_scripts_dir}/tc_api-rest_def.txt" target="_blank" rel="noopener">tc_api-rest_def</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="{openehr_cnf_scripts_dir}/REST/postman/tc_api-rest_def.json" target="_blank" rel="noopener">postman</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>EHR API</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_service_interface" target="_blank" rel="noopener"><code>I_EHR_SERVICE</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exercise all functions &amp; arguments</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="{openehr_cnf_scripts_dir}/tc_api-rest_ehr.txt" target="_blank" rel="noopener">tc_api-rest_ehr</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="{openehr_cnf_scripts_dir}/REST/postman/tc_api-rest_ehr.json" target="_blank" rel="noopener">postman</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>DEMOGRAPHIC API</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_demographic_service_interface" target="_blank" rel="noopener"><code>I_DEMOGRAPHIC_SERVICE</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exercise all functions &amp; arguments</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="{openehr_cnf_scripts_dir}/tc_api-rest_dem.txt" target="_blank" rel="noopener">tc_api-rest_dem</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="{openehr_cnf_scripts_dir}/REST/postman/tc_api-rest_dem.json" target="_blank" rel="noopener">postman</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>QUERY API</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_query_service_interface" target="_blank" rel="noopener"><code>I_QUERY_SERVICE</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exercise all functions &amp; arguments</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="{openehr_cnf_scripts_dir}/tc_api-rest_qry.txt" target="_blank" rel="noopener">tc_api-rest_qry</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="{openehr_cnf_scripts_dir}/REST/postman/tc_api-rest_qry.json" target="_blank" rel="noopener">postman</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ADMIN API</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_admin_service_interface" target="_blank" rel="noopener"><code>I_ADMIN_SERVICE</code></a><br>
 <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_admin_dump_load_interface" target="_blank" rel="noopener"><code>I_ADMIN_DUMP_LOAD</code></a><br>
 <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_admin_archive_interface" target="_blank" rel="noopener"><code>I_ADMIN_ARCHIVE</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exercise all functions &amp; arguments</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="{openehr_cnf_scripts_dir}/tc_api-rest_adm.txt" target="_blank" rel="noopener">tc_api-rest_adm</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="{openehr_cnf_scripts_dir}/REST/postman/tc_api-rest_adm.json" target="_blank" rel="noopener">postman</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>MESSAGE API</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_ehr_extract_interface" target="_blank" rel="noopener"><code>I_EHR_EXTRACT</code></a><br>
 <a href="https://specifications.openehr.org/releases/SM/latest/openehr_platform.html#_i_tdd_interface" target="_blank" rel="noopener"><code>I_TDD</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exercise all functions &amp; arguments</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="{openehr_cnf_scripts_dir}/tc_api-rest_msg.txt" target="_blank" rel="noopener">tc_api-rest_msg</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="{openehr_cnf_scripts_dir}/REST/postman/tc_api-rest_msg.json" target="_blank" rel="noopener">postman</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_profiles"><a class="anchor" href="#_profiles"></a>16. Profiles</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The schedule above describes capabilities of openEHR platform products that can be tested against the published specifiations. These capabilities are grouped into <em>profiles</em> to provide a guide to what constitutes the required functionality for particular category of solution.</p>
</div>
<div class="paragraph">
<p>A profile may be defined logically as a particular list of capabilities from the above schedule that may be combined to specify a particular kind of solution. For example, an openEHR Demographics product would treat most or all of the Demographic capabilities as mandatory, along with support for definitions, logging etc.</p>
</div>
<div class="paragraph">
<p>This specification defines a set of default profiles intended as a guide for determining the minimum capabilities to specify in order to obtain certain basic levels of functionality.</p>
</div>
<div class="paragraph">
<p>Producers of tender specifications and procuring organsations should create the Profile(s) they require. This should be done by adopting either the CORE or STANDARD base profiles and then adding in the set of options required.</p>
</div>
<div class="sect2">
<h3 id="_default_profiles"><a class="anchor" href="#_default_profiles"></a>16.1. Default Profiles</h3>
<div class="paragraph">
<p>The profiles used below are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>CORE</strong>: a minimal functional openEHR platform implementation that enables the storage and retrieval of openEHR EHR data;</p>
</li>
<li>
<p><strong>STANDARD</strong>: a 'standard' configuration of capabilities that adds AQL querying and logging to the CORE;</p>
</li>
<li>
<p><strong>OPTIONS</strong>: components that are considered optional for non-specialised solutions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In order to obtain <code>CORE</code> or <code>STANDARD</code> conformance, all mentioned capabilities must be met in testing. The <code>OPTIONS</code> profile is a catch-all pseudo-profile that covers all testable capabilities not included in <code>CORE</code> or <code>STANDARD</code>; <code>OPTIONS</code> is obtained if any optional capability is passed in testing.</p>
</div>
<div class="sect3">
<h4 id="_functional"><a class="anchor" href="#_functional"></a>16.1.1. Functional</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Product Component</th>
<th class="tableblock halign-left valign-top">Capability</th>
<th class="tableblock halign-center valign-top">CORE</th>
<th class="tableblock halign-center valign-top">STANDARD</th>
<th class="tableblock halign-center valign-top">OPTIONS</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" rowspan="5"><p class="tableblock"><strong>Definitions</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADL 1.4 Archetype<br>
                     provisioning</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADL 1.4 OPT<br>
                     provisioning</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADL 2 Archetype<br>
                     provisioning</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADL 2 OPT<br>
                     provisioning</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Query<br>
                     provisioning</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="7"><p class="tableblock"><strong>EHR<br>
 Persistence</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EHR Operations</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EHR Status</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Composition<br>
                     Operations</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directory<br>
                     Operations</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Change sets</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Versioning</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Archetype<br>
                     Validation</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock"><strong>Demographic<br>
 Persistence</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Party Operations</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Party<br>
                     Relationship<br>
                     Operations</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Archetype<br>
                     validation</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock"><strong>Querying</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AQL basic</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AQL advanced</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AQL &amp; terminology</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="6"><p class="tableblock"><strong>Admin</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Activity Report</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Physical Deletion</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EHR Dump/Load</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bulk EHR load</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EHR Archive</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demographic Archive</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock"><strong>Messaging</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EHR Extract</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TDS</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="7"><p class="tableblock"><strong>REST APIs</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEFINITION API</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EHR API</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEMOGRAPHIC API</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">QUERY API</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADMIN API</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MESSAGE API</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_non_functional"><a class="anchor" href="#_non_functional"></a>16.1.2. Non-Functional</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Product Attribute</th>
<th class="tableblock halign-left valign-top">Capability</th>
<th class="tableblock halign-center valign-top">CORE</th>
<th class="tableblock halign-center valign-top">STANDARD</th>
<th class="tableblock halign-center valign-top">OPTIONS</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock"><strong>Security &amp;<br>
 Privacy</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Signing</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Anonymous EHRs</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_other_non_functional"><a class="anchor" href="#_other_non_functional"></a>16.1.3. Other Non-Functional</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Product Attribute</th>
<th class="tableblock halign-left valign-top">Values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>External Data Format</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XML, JSON</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-01-03 20:14:13 UTC
</div>
</div>
</body>
</html>